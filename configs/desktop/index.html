<!DOCTYPE html>
<html lang=""><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Desktop</title>
    <meta name="description" content="Freedom is a state of mind">
    <meta name="author" content='SqrtMinusOne'>

    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous">

    
    <link rel="stylesheet" href="/sass/researcher.min.css">

    
        <link rel="icon" type="image/ico" href="https://sqrtminusone.xyz/favicon.ico">
    

    
        
    
</head>

    <body><div class="container mt-5">
    <nav class="navbar navbar-expand-sm flex-column flex-sm-row text-nowrap p-0">
        <a class="navbar-brand mx-0 mr-sm-auto" href="https://sqrtminusone.xyz/" title="SqrtMinusOne">
          
          SqrtMinusOne
        </a>
        <div class="navbar-nav flex-row flex-wrap justify-content-center">
            
                
                
                    <a class="nav-item nav-link" href="/" title="Index">
                        Index
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/posts/" title="Posts">
                        Posts
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/configs/readme" title="Configs">
                        Configs
                    </a>
                    
                
            
        </div>
    </nav>
</div>
<hr>
<div id="content">
<script defer language="javascript" type="text/javascript"  src="/js/dynamic-toc.js"></script>
<div class="root">
    <h1 id="title-small-screen">
        Desktop
        <iframe src="https://ghbtns.com/github-btn.html?user=SqrtMinusOne&repo=dotfiles&type=star&count=true" frameborder="0" scrolling="0" width="150" height="20" title="GitHub"></iframe>
    </h1>
    <div class="container" id="actual-content">
        <h1 id="title-large-screen" class="dotfiles-title">
            Desktop
            <iframe src="https://ghbtns.com/github-btn.html?user=SqrtMinusOne&repo=dotfiles&type=star&count=true" frameborder="0" scrolling="0" width="150" height="20" title="GitHub"></iframe>
        </h1>
        <p>My general desktop environment configuration.</p>
<p>Parts prefixed with (OFF) are not used, but kept for historic purposes. For some reason GitHub&rsquo;s org renderer ignores TODO status, hence such a prefix. Round brackets instead of square ones to prevent GitHub&rsquo;s org renderer from screwing up.</p>
<p>References:</p>
<ul>
<li><a href="https://sqrtminusone.xyz/posts/2022-02-12-literate/">A few cases of literate configuration</a>. My blog post that explains some of techniques from this file.</li>
</ul>
<h2 id="global-customization">Global customization</h2>
<h3 id="colors">Colors</h3>
<p>My favorite color theme is Palenight (<a href="https://github.com/JonathanSpeek/palenight-iterm2">color codes</a>), and I want to have one source of truth for these colors. Except for Emacs itself, which has <a href="https://github.com/doomemacs/themes#theme-list">doom-palenight</a> (and in which I occasionally switch to <code>doom-one-light</code>, e.g. when reading a long text), it can be done rather nicely with Org Mode.</p>
<p>First, let&rsquo;s define a table with all the color codes:</p>
<p><a id="table--colors"></a></p>
<table>
<thead>
<tr>
<th>color</th>
<th>key</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>black</td>
<td>color0</td>
<td>#292d3e</td>
</tr>
<tr>
<td>red</td>
<td>color1</td>
<td>#f07178</td>
</tr>
<tr>
<td>green</td>
<td>color2</td>
<td>#c3e88d</td>
</tr>
<tr>
<td>yellow</td>
<td>color3</td>
<td>#ffcb6b</td>
</tr>
<tr>
<td>blue</td>
<td>color4</td>
<td>#82aaff</td>
</tr>
<tr>
<td>magenta</td>
<td>color5</td>
<td>#c792ea</td>
</tr>
<tr>
<td>cyan</td>
<td>color6</td>
<td>#89ddff</td>
</tr>
<tr>
<td>white</td>
<td>color7</td>
<td>#d0d0d0</td>
</tr>
<tr>
<td>light-black</td>
<td>color8</td>
<td>#434758</td>
</tr>
<tr>
<td>light-red</td>
<td>color9</td>
<td>#ff8b92</td>
</tr>
<tr>
<td>light-green</td>
<td>color10</td>
<td>#ddffa7</td>
</tr>
<tr>
<td>light-yellow</td>
<td>color11</td>
<td>#ffe585</td>
</tr>
<tr>
<td>light-blue</td>
<td>color12</td>
<td>#9cc4ff</td>
</tr>
<tr>
<td>light-magenta</td>
<td>color13</td>
<td>#e1acff</td>
</tr>
<tr>
<td>light-cyan</td>
<td>color14</td>
<td>#a3f7ff</td>
</tr>
<tr>
<td>light-white</td>
<td>color15</td>
<td>#ffffff</td>
</tr>
<tr>
<td>color-fg</td>
<td></td>
<td>#000000</td>
</tr>
</tbody>
</table>
<p>The table above is the only source of truth for colors in this config.</p>
<p>Contents of this table can then be <a href="https://orgmode.org/manual/Environment-of-a-Code-Block.html">accessed from a code block</a>. Let&rsquo;s define one to return the color code based on its name:</p>
<p><a id="code-snippet--get-color"></a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">let</span> ((<span style="color:#19177c">color</span> (<span style="color:#19177c">seq-some</span> (<span style="color:#008000">lambda</span> (<span style="color:#19177c">e</span>) (<span style="color:#008000">and</span> (<span style="color:#19177c">string=</span> <span style="color:#19177c">name</span> (<span style="color:#00f">car</span> <span style="color:#19177c">e</span>)) (<span style="color:#00f">nth</span> <span style="color:#666">2</span> <span style="color:#19177c">e</span>))) <span style="color:#19177c">table</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">if</span> (<span style="color:#00f">&gt;</span> <span style="color:#008000">quote</span> <span style="color:#666">0</span>)
</span></span><span style="display:flex;"><span>      (<span style="color:#00f">concat</span> <span style="color:#ba2121">&#34;\&#34;&#34;</span> <span style="color:#19177c">color</span> <span style="color:#ba2121">&#34;\&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">color</span>))
</span></span></code></pre></div><p>Test:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#19177c">&lt;&lt;get-color</span>(<span style="color:#19177c">name=</span><span style="color:#ba2121">&#34;red&#34;</span><span style="color:#666">,</span> <span style="color:#19177c">quote=1</span>)<span style="color:#19177c">&gt;&gt;</span>
</span></span></code></pre></div><h3 id="xresources">Xresources</h3>
<h4 id="colors-in-xresources">Colors in Xresources</h4>
<p>However, I&rsquo;d rather use the <code>Xresources</code> file wherever possible. Here is the code to generate an Xresources file from this table:</p>
<p><a id="code-snippet--get-xresources"></a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#00f">mapconcat</span>
</span></span><span style="display:flex;"><span> (<span style="color:#008000">lambda</span> (<span style="color:#19177c">elem</span>)
</span></span><span style="display:flex;"><span>   (<span style="color:#00f">concat</span> <span style="color:#ba2121">&#34;*&#34;</span> (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">elem</span>) <span style="color:#ba2121">&#34;: &#34;</span> (<span style="color:#00f">nth</span> <span style="color:#666">2</span> <span style="color:#19177c">elem</span>)))
</span></span><span style="display:flex;"><span> (<span style="color:#19177c">seq-filter</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">lambda</span> (<span style="color:#19177c">elem</span>) (<span style="color:#008000">and</span> (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">elem</span>)
</span></span><span style="display:flex;"><span>		      (<span style="color:#19177c">not</span> (<span style="color:#19177c">string-empty-p</span> (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">elem</span>)))))
</span></span><span style="display:flex;"><span>  <span style="color:#19177c">table</span>)
</span></span><span style="display:flex;"><span> <span style="color:#ba2121">&#34;\n&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>&lt;&lt;get-xresources()&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>*background: &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;black&#34;</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>*foreground: &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;white&#34;</span>)&gt;&gt;<span style="">
</span></span></span></code></pre></div><p>So, whenever a program is capable of reading <code>.Xresources</code>, it will get colors from there, otherwise, it will get colors from noweb expressions in the literate config. Thus, in both cases, the color is set in a single Org Mode table.</p>
<h4 id="fonts">Fonts</h4>
<p>Also, Xresources are used to set <code>Xft</code> settings. Unfortunately, the DPI setting has to be unique for each machine, which means I cannot commit <code>Xresources</code> to the repo.</p>
<p><a id="code-snippet--get-dpi"></a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">let</span> ((<span style="color:#19177c">hostname</span> (<span style="color:#00f">system-name</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">cond</span> ((<span style="color:#00f">string-equal</span> <span style="color:#19177c">hostname</span> <span style="color:#ba2121">&#34;azure&#34;</span>) <span style="color:#666">120</span>)
</span></span><span style="display:flex;"><span>	((<span style="color:#00f">string-equal</span> <span style="color:#19177c">hostname</span> <span style="color:#ba2121">&#34;eminence&#34;</span>) <span style="color:#666">120</span>)
</span></span><span style="display:flex;"><span>	((<span style="color:#00f">string-equal</span> <span style="color:#19177c">hostname</span> <span style="color:#ba2121">&#34;indigo&#34;</span>) <span style="color:#666">120</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#800">t</span> <span style="color:#666">96</span>)))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>Xft.dpi: &lt;&lt;get-dpi()&gt;&gt;<span style="">
</span></span></span></code></pre></div><h3 id="themes">Themes</h3>
<p>A few programs I use to customize the apperance are listed below.</p>
<table>
<thead>
<tr>
<th>Guix dependency</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>matcha-theme</td>
<td>My preferred GTK theme</td>
</tr>
<tr>
<td>papirus-icon-theme</td>
<td>My preferred Icon theme</td>
</tr>
<tr>
<td>gnome-themes-standard</td>
<td></td>
</tr>
<tr>
<td>xsettingsd</td>
<td>X11 settings daemon</td>
</tr>
<tr>
<td>gnome-themes-extra</td>
<td></td>
</tr>
</tbody>
</table>
<p><a href="https://github.com/derat/xsettingsd">xsettingsd</a> is a lightweight daemon which configures X11 applications. It is launched with shepherd in the <a href="#services">Services</a> section.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>Net/ThemeName <span style="color:#ba2121">&#34;Matcha-dark-azul&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Net/IconThemeName <span style="color:#ba2121">&#34;Papirus-Dark&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Gtk/DecorationLayout <span style="color:#ba2121">&#34;menu:minimize,maximize,close&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Gtk/FontName <span style="color:#ba2121">&#34;Sans 10&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Gtk/MonospaceFontName <span style="color:#ba2121">&#34;JetBrainsMono Nerd Mono 12&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Gtk/CursorThemeName <span style="color:#ba2121">&#34;Adwaita&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Xft/Antialias <span style="color:#666">1</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Xft/Hinting <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Xft/HintStyle <span style="color:#ba2121">&#34;hintnone&#34;</span><span style="">
</span></span></span></code></pre></div><h3 id="mime">MIME</h3>
<p>Setting the default MIME types</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[Default Applications]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">text/html</span><span style="color:#666">=</span><span style="color:#ba2121">firefox.desktop</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">x-scheme-handler/http</span><span style="color:#666">=</span><span style="color:#ba2121">firefox.desktop</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">x-scheme-handler/https</span><span style="color:#666">=</span><span style="color:#ba2121">firefox.desktop</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">x-scheme-handler/about</span><span style="color:#666">=</span><span style="color:#ba2121">firefox.desktop</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">x-scheme-handler/unknown</span><span style="color:#666">=</span><span style="color:#ba2121">firefox.desktop</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">x-scheme-handler/tg</span><span style="color:#666">=</span><span style="color:#ba2121">userapp-Telegram Desktop-7PVWF1.desktop</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">image/png</span><span style="color:#666">=</span><span style="color:#ba2121">feh.desktop</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">image/jpg</span><span style="color:#666">=</span><span style="color:#ba2121">feh.desktop</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">image/jpeg</span><span style="color:#666">=</span><span style="color:#ba2121">feh.desktop</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">application/pdf</span><span style="color:#666">=</span><span style="color:#ba2121">org.pwmt.zathura.desktop</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[Added Associations]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">x-scheme-handler/tg</span><span style="color:#666">=</span><span style="color:#ba2121">userapp-Telegram Desktop-7PVWF1.desktop;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">application/pdf</span><span style="color:#666">=</span><span style="color:#ba2121">org.pwmt.zathura.desktop</span>
</span></span></code></pre></div><h3 id="device-specific-settings">Device-specific settings</h3>
<table>
<thead>
<tr>
<th>Guix dependency</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>xrandr</td>
<td>X11 CLI to RandR</td>
</tr>
<tr>
<td>xgamma</td>
<td>A tool to alter monitor&rsquo;s gamma correction</td>
</tr>
<tr>
<td>xinput</td>
<td>Configure input devices</td>
</tr>
</tbody>
</table>
<p>Set screen layout &amp; other params depending on hostname</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#19177c">hostname</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>hostname<span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$hostname</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34;indigo&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    xrandr --output DisplayPort-0 --off --output HDMI-A-0 --mode 1920x1080 --pos 0x0 --rotate normal --output DVI-D-0 --mode 1920x1080 --pos 1920x0 --rotate normal
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">elif</span> <span style="color:#666">[</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$hostname</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34;eminence&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    xgamma -gamma 1.25
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><h2 id="exwm">EXWM</h2>
<p>Settings for <a href="https://github.com/ch11ng/exwm">Emacs X Window Manager</a>, a tiling WM implemented in Emacs Lisp. This part has a few bits copied from my blog post.</p>
<p>References:</p>
<ul>
<li><a href="https://github.com/ch11ng/exwm/wiki">EXWM Wiki</a></li>
<li><a href="https://github.com/daviwil/emacs-from-scratch/blob/master/Desktop.org">Emacs From Scratch config</a></li>
<li><a href="https://sqrtminusone.xyz/posts/2022-01-03-exwm/">Using EXWM and perspective.el on a multi-monitor setup</a></li>
</ul>
<h3 id="startup-and-ui">Startup &amp; UI</h3>
<h4 id="xsession">Xsession</h4>
<p>First things first, Emacs has to be launched as a window manager. On a more conventional system I&rsquo;d create a .desktop file in some system folder that can be seen by a login manager, but in the case of Guix it&rsquo;s a bit more complicated, because all such folders are not meant to be changed manually.</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>desktop-misc</td>
<td>xinit</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>xss-lock</td>
</tr>
</tbody>
</table>
<p>However, GDM, the login manager that seems to be the default on Guix, launches <code>~/.xsession</code> on the startup if it&rsquo;s present, which is just fine for my purposes.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Source .profile</span>
</span></span><span style="display:flex;"><span>. ~/.profile
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Disable access control for the current user</span>
</span></span><span style="display:flex;"><span>xhost +SI:localuser:<span style="color:#19177c">$USER</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Fix for Java applications</span>
</span></span><span style="display:flex;"><span><span style="color:#008000">export</span> <span style="color:#19177c">_JAVA_AWT_WM_NONREPARENTING</span><span style="color:#666">=</span><span style="color:#666">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Apply XResourses</span>
</span></span><span style="display:flex;"><span>xrdb -merge ~/.Xresources
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Turn off the system bell</span>
</span></span><span style="display:flex;"><span>xset -b
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Use i3lock as a screen locker</span>
</span></span><span style="display:flex;"><span>xss-lock -- i3lock -f -i /home/pavel/Pictures/lock-wallpaper.png &amp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Some apps that have to be launched only once.</span>
</span></span><span style="display:flex;"><span>picom &amp;
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># nm-applet &amp;</span>
</span></span><span style="display:flex;"><span>dunst &amp;
</span></span><span style="display:flex;"><span>copyq &amp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Run the Emacs startup script as a session.</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># exec dbus-launch --exit-with-session ~/.emacs.d/run-exwm.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#008000">exec</span> dbus-launch --exit-with-session emacs -mm --debug-init -l ~/.emacs.d/desktop.el
</span></span></code></pre></div><h4 id="startup-apps">Startup apps</h4>
<p>Now that Emacs is launched, it is necessary to set up the EXWM-specific parts of config.</p>
<p>I want to launch some apps from EXWM instead of the Xsession file for two purposes:</p>
<ul>
<li>the app may need to have the entire desktop environment set up</li>
<li>or it may need to be restarted if Emacs is killed.</li>
</ul>
<p>As of now, these are polybar, feh and, shepherd:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-run-polybar</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">call-process</span> <span style="color:#ba2121">&#34;~/bin/polybar.sh&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-set-wallpaper</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">call-process-shell-command</span> <span style="color:#ba2121">&#34;feh --bg-fill ~/Pictures/wallpaper.jpg&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-run-shepherd</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">when</span> (<span style="color:#19177c">string-empty-p</span> (<span style="color:#19177c">shell-command-to-string</span> <span style="color:#ba2121">&#34;pgrep -u pavel shepherd&#34;</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#00f">call-process</span> <span style="color:#ba2121">&#34;shepherd&#34;</span>)))
</span></span></code></pre></div><h4 id="pinentry">Pinentry</h4>
<p>The GUI pinentry doesn&rsquo;t work too well with EXWM because of issues with popup windows, so we will use the Emacs one.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">use-package</span> <span style="color:#19177c">pinentry</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:straight</span> <span style="color:#800">t</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:after</span> (<span style="color:#19177c">exwm</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:config</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">setenv</span> <span style="color:#ba2121">&#34;GPG_AGENT_INFO&#34;</span> <span style="color:#800">nil</span>) <span style="color:#408080;font-style:italic">;; use emacs pinentry</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">auth-source-debug</span> <span style="color:#800">t</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">epg-gpg-program</span> <span style="color:#ba2121">&#34;gpg2&#34;</span>) <span style="color:#408080;font-style:italic">;; not necessary</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">require</span> <span style="color:#19177c">&#39;epa-file</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">epa-file-enable</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">epa-pinentry-mode</span> <span style="color:#19177c">&#39;loopback</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">epg-pinentry-mode</span> <span style="color:#19177c">&#39;loopback</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">pinentry-start</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>default-cache-ttl <span style="color:#666">3600</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>max-cache-ttl <span style="color:#666">3600</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>allow-emacs-pinentry<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>allow-loopback-pinentry<span style="">
</span></span></span></code></pre></div><h4 id="modeline">Modeline</h4>
<p>Show the current workspace in the modeline.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">use-package</span> <span style="color:#19177c">exwm-modeline</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:straight</span> (<span style="color:#008000">:host</span> <span style="color:#19177c">github</span> <span style="color:#008000">:repo</span> <span style="color:#ba2121">&#34;SqrtMinusOne/exwm-modeline&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:config</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">add-hook</span> <span style="color:#19177c">&#39;exwm-init-hook</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">exwm-modeline-mode</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">my/use-doom-colors</span>
</span></span><span style="display:flex;"><span>   (<span style="color:#19177c">exwm-modeline-current-workspace</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">:foreground</span> (<span style="color:#19177c">doom-color</span> <span style="color:#19177c">&#39;yellow</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#008000">:weight</span> <span style="color:#19177c">&#39;bold</span>)))
</span></span></code></pre></div><h3 id="windows">Windows</h3>
<p>A bunch of functions related to managing windows in EXWM.</p>
<h4 id="moving-windows">Moving windows</h4>
<p>As I wrote in my <a href="https://sqrtminusone.xyz/posts/2021-10-04-emacs-i3/">Emacs and i3</a> post, I want to have a rather specific behavior when moving windows (which does resemble i3 in some way):</p>
<ul>
<li>if there is space in the required direction, move the Emacs window there;</li>
<li>if there is no space in the required direction, but space in two orthogonal directions, move the Emacs window so that there is no more space in the orthogonal directions;</li>
</ul>
<p>I can&rsquo;t say it&rsquo;s better or worse than the built-in functionality or one provided by evil, but I&rsquo;m used to it and I think it fits better for managing a lot of windows.</p>
<p>So, first, we need a predicate that checks whether there is space in the given direction:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-direction-exists-p</span> (<span style="color:#19177c">dir</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Check if there is space in the direction DIR.
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">Does not take the minibuffer into account.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">cl-some</span> (<span style="color:#008000">lambda</span> (<span style="color:#19177c">dir</span>)
</span></span><span style="display:flex;"><span>	     (<span style="color:#008000">let</span> ((<span style="color:#19177c">win</span> (<span style="color:#19177c">windmove-find-other-window</span> <span style="color:#19177c">dir</span>)))
</span></span><span style="display:flex;"><span>	       (<span style="color:#008000">and</span> <span style="color:#19177c">win</span> (<span style="color:#19177c">not</span> (<span style="color:#00f">window-minibuffer-p</span> <span style="color:#19177c">win</span>)))))
</span></span><span style="display:flex;"><span>	   (<span style="color:#008000">pcase</span> <span style="color:#19177c">dir</span>
</span></span><span style="display:flex;"><span>	     (<span style="color:#19177c">&#39;width</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">left</span> <span style="color:#19177c">right</span>))
</span></span><span style="display:flex;"><span>	     (<span style="color:#19177c">&#39;height</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">up</span> <span style="color:#19177c">down</span>)))))
</span></span></code></pre></div><p>And a function to implement that:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-move-window</span> (<span style="color:#19177c">dir</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Move the current window in the direction DIR.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">let</span> ((<span style="color:#19177c">other-window</span> (<span style="color:#19177c">windmove-find-other-window</span> <span style="color:#19177c">dir</span>))
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">other-direction</span> (<span style="color:#19177c">my/exwm-direction-exists-p</span>
</span></span><span style="display:flex;"><span>			  (<span style="color:#008000">pcase</span> <span style="color:#19177c">dir</span>
</span></span><span style="display:flex;"><span>			    (<span style="color:#19177c">&#39;up</span> <span style="color:#19177c">&#39;width</span>)
</span></span><span style="display:flex;"><span>			    (<span style="color:#19177c">&#39;down</span> <span style="color:#19177c">&#39;width</span>)
</span></span><span style="display:flex;"><span>			    (<span style="color:#19177c">&#39;left</span> <span style="color:#19177c">&#39;height</span>)
</span></span><span style="display:flex;"><span>			    (<span style="color:#19177c">&#39;right</span> <span style="color:#19177c">&#39;height</span>)))))
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">cond</span>
</span></span><span style="display:flex;"><span>     ((<span style="color:#008000">and</span> <span style="color:#19177c">other-window</span> (<span style="color:#19177c">not</span> (<span style="color:#00f">window-minibuffer-p</span> <span style="color:#19177c">other-window</span>)))
</span></span><span style="display:flex;"><span>      (<span style="color:#19177c">window-swap-states</span> (<span style="color:#00f">selected-window</span>) <span style="color:#19177c">other-window</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#19177c">other-direction</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#19177c">evil-move-window</span> <span style="color:#19177c">dir</span>)))))
</span></span></code></pre></div><p>My preferred keybindings for this part are, of course, <code>s-&lt;H|J|K|L&gt;</code>.</p>
<h4 id="resizing-windows">Resizing windows</h4>
<p>I find this odd that there are different commands to resize tiling and floating windows. So let&rsquo;s define one command to perform both resizes depending on the context:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">setq</span> <span style="color:#19177c">my/exwm-resize-value</span> <span style="color:#666">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-resize-window</span> (<span style="color:#19177c">dir</span> <span style="color:#19177c">kind</span> <span style="color:#008000">&amp;optional</span> <span style="color:#19177c">value</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Resize the current window in the direction DIR.
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">DIR is either &#39;height or &#39;width, KIND is either &#39;shrink or
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121"> &#39;grow.  VALUE is </span><span style="color:#19177c">`my/exwm-resize-value&#39;</span><span style="color:#ba2121"> by default.
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">If the window is an EXWM floating window, execute the
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">corresponding command from the exwm-layout group, execute the
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">command from the evil-window group.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">unless</span> <span style="color:#19177c">value</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">setq</span> <span style="color:#19177c">value</span> <span style="color:#19177c">my/exwm-resize-value</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">let*</span> ((<span style="color:#19177c">is-exwm-floating</span>
</span></span><span style="display:flex;"><span>	  (<span style="color:#008000">and</span> (<span style="color:#19177c">derived-mode-p</span> <span style="color:#19177c">&#39;exwm-mode</span>)
</span></span><span style="display:flex;"><span>	       <span style="color:#19177c">exwm--floating-frame</span>))
</span></span><span style="display:flex;"><span>	 (<span style="color:#19177c">func</span> (<span style="color:#008000">if</span> <span style="color:#19177c">is-exwm-floating</span>
</span></span><span style="display:flex;"><span>		   (<span style="color:#00f">intern</span>
</span></span><span style="display:flex;"><span>		    (<span style="color:#00f">concat</span>
</span></span><span style="display:flex;"><span>		     <span style="color:#ba2121">&#34;exwm-layout-&#34;</span>
</span></span><span style="display:flex;"><span>		     (<span style="color:#008000">pcase</span> <span style="color:#19177c">kind</span> (<span style="color:#19177c">&#39;shrink</span> <span style="color:#ba2121">&#34;shrink&#34;</span>) (<span style="color:#19177c">&#39;grow</span> <span style="color:#ba2121">&#34;enlarge&#34;</span>))
</span></span><span style="display:flex;"><span>		     <span style="color:#ba2121">&#34;-window&#34;</span>
</span></span><span style="display:flex;"><span>		     (<span style="color:#008000">pcase</span> <span style="color:#19177c">dir</span> (<span style="color:#19177c">&#39;height</span> <span style="color:#ba2121">&#34;&#34;</span>) (<span style="color:#19177c">&#39;width</span> <span style="color:#ba2121">&#34;-horizontally&#34;</span>))))
</span></span><span style="display:flex;"><span>		 (<span style="color:#00f">intern</span>
</span></span><span style="display:flex;"><span>		  (<span style="color:#00f">concat</span>
</span></span><span style="display:flex;"><span>		   <span style="color:#ba2121">&#34;evil-window&#34;</span>
</span></span><span style="display:flex;"><span>		   (<span style="color:#008000">pcase</span> <span style="color:#19177c">kind</span> (<span style="color:#19177c">&#39;shrink</span> <span style="color:#ba2121">&#34;-decrease-&#34;</span>) (<span style="color:#19177c">&#39;grow</span> <span style="color:#ba2121">&#34;-increase-&#34;</span>))
</span></span><span style="display:flex;"><span>		   (<span style="color:#00f">symbol-name</span> <span style="color:#19177c">dir</span>))))))
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">when</span> <span style="color:#19177c">is-exwm-floating</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#008000">setq</span> <span style="color:#19177c">value</span> (<span style="color:#00f">*</span> <span style="color:#666">5</span> <span style="color:#19177c">value</span>)))
</span></span><span style="display:flex;"><span>    (<span style="color:#00f">funcall</span> <span style="color:#19177c">func</span> <span style="color:#19177c">value</span>)))
</span></span></code></pre></div><p>This function will call <code>exwm-layout-&lt;shrink|grow&gt;[-horizontally]</code> for EXWM floating window and <code>evil-window-&lt;decrease|increase&gt;-&lt;width|height&gt;</code> otherwise.</p>
<p>This function can be bound to the required keybindings directly, but I prefer a hydra to emulate the i3 submode:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#19177c">defhydra</span> <span style="color:#19177c">my/exwm-resize-hydra</span> (<span style="color:#008000">:color</span> <span style="color:#19177c">pink</span> <span style="color:#008000">:hint</span> <span style="color:#800">nil</span> <span style="color:#008000">:foreign-keys</span> <span style="color:#19177c">run</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">^Resize^
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">_l_: Increase width   _h_: Decrease width   _j_: Increase height   _k_: Decrease height
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">_=_: Balance          &#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;h&#34;</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-resize-window</span> <span style="color:#19177c">&#39;width</span> <span style="color:#19177c">&#39;shrink</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;j&#34;</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-resize-window</span> <span style="color:#19177c">&#39;height</span> <span style="color:#19177c">&#39;grow</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;k&#34;</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-resize-window</span> <span style="color:#19177c">&#39;height</span> <span style="color:#19177c">&#39;shrink</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;l&#34;</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-resize-window</span> <span style="color:#19177c">&#39;width</span> <span style="color:#19177c">&#39;grow</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;=&#34;</span> <span style="color:#19177c">balance-windows</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;q&#34;</span> <span style="color:#800">nil</span> <span style="color:#ba2121">&#34;quit&#34;</span> <span style="color:#008000">:color</span> <span style="color:#19177c">blue</span>))
</span></span></code></pre></div><h4 id="improving-splitting-windows">Improving splitting windows</h4>
<p><code>M-x evil-window-[v]split</code> (bound to <code>C-w v</code> and <code>C-w s</code> by default) are the default evil command to do splits.</p>
<p>One EXWM-related issue though is that by default doing such a split &ldquo;copies&rdquo; the current buffer to the new window. But as EXWM buffer cannot be &ldquo;copied&rdquo; like that, some other buffer is displayed in the split, and generally, that&rsquo;s not a buffer I want.</p>
<p>For instance, I prefer to have Chrome DevTools as a separate window. When I click &ldquo;Inspect&rdquo; on something, the DevTools window replaces my Ungoogled Chromium window. I press <code>C-w v</code>, and most often I have something like <code>*scratch*</code> buffer in the opened split instead of the previous Chromium window.</p>
<p>To implement better behavior, I define the following advice:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-fill-other-window</span> (<span style="color:#008000">&amp;rest</span> <span style="color:#19177c">_</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Open the most recently used buffer in the next window.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">when</span> (<span style="color:#008000">and</span> (<span style="color:#00f">eq</span> <span style="color:#19177c">major-mode</span> <span style="color:#19177c">&#39;exwm-mode</span>) (<span style="color:#19177c">not</span> (<span style="color:#00f">eq</span> (<span style="color:#00f">next-window</span>) (<span style="color:#00f">get-buffer-window</span>))))
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">let</span> ((<span style="color:#19177c">other-exwm-buffer</span>
</span></span><span style="display:flex;"><span>	   (<span style="color:#008000">cl-loop</span> <span style="color:#19177c">with</span> <span style="color:#00f">other-buffer</span> <span style="color:#00f">=</span> (<span style="color:#19177c">persp-other-buffer</span>)
</span></span><span style="display:flex;"><span>		    <span style="color:#19177c">for</span> <span style="color:#19177c">buf</span> <span style="color:#19177c">in</span> (<span style="color:#00f">sort</span> (<span style="color:#19177c">persp-current-buffers</span>) (<span style="color:#008000">lambda</span> (<span style="color:#19177c">a</span> <span style="color:#19177c">_</span>) (<span style="color:#00f">eq</span> <span style="color:#19177c">a</span> <span style="color:#00f">other-buffer</span>)))
</span></span><span style="display:flex;"><span>		    <span style="color:#19177c">with</span> <span style="color:#00f">current-buffer</span> <span style="color:#00f">=</span> (<span style="color:#00f">current-buffer</span>)
</span></span><span style="display:flex;"><span>		    <span style="color:#008000">when</span> (<span style="color:#008000">and</span> (<span style="color:#19177c">not</span> (<span style="color:#00f">eq</span> <span style="color:#00f">current-buffer</span> <span style="color:#19177c">buf</span>))
</span></span><span style="display:flex;"><span>			      (<span style="color:#00f">buffer-live-p</span> <span style="color:#19177c">buf</span>)
</span></span><span style="display:flex;"><span>			      (<span style="color:#19177c">not</span> (<span style="color:#19177c">string-match-p</span> (<span style="color:#19177c">persp--make-ignore-buffer-rx</span>) (<span style="color:#00f">buffer-name</span> <span style="color:#19177c">buf</span>)))
</span></span><span style="display:flex;"><span>			      (<span style="color:#19177c">not</span> (<span style="color:#00f">get-buffer-window</span> <span style="color:#19177c">buf</span>)))
</span></span><span style="display:flex;"><span>		    <span style="color:#008000">return</span> <span style="color:#19177c">buf</span>)))
</span></span><span style="display:flex;"><span>      (<span style="color:#008000">when</span> <span style="color:#19177c">other-exwm-buffer</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#008000">with-selected-window</span> (<span style="color:#00f">next-window</span>)
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">switch-to-buffer</span> <span style="color:#19177c">other-exwm-buffer</span>))))))
</span></span></code></pre></div><p>This is meant to be called after doing an either vertical or horizontal split, so it&rsquo;s advised like that:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#19177c">advice-add</span> <span style="color:#19177c">&#39;evil-window-split</span> <span style="color:#008000">:after</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/exwm-fill-other-window</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#19177c">advice-add</span> <span style="color:#19177c">&#39;evil-window-vsplit</span> <span style="color:#008000">:after</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/exwm-fill-other-window</span>)
</span></span></code></pre></div><p>This works as follows. If the current buffer is an EXWM buffer and there are other windows open (that is, <code>(next-window)</code> is not the current window), the function tries to find another suitable buffer to be opened in the split. And that also takes the perspectives into account, so buffers are searched only within the current perspective, and the buffer returned by <code>persp-other-buffer</code> will be the top candidate.</p>
<h3 id="perspectives">Perspectives</h3>
<p><a href="https://github.com/nex3/perspective-el">perspective.el</a> is one package I like that provides workspaces for Emacs, called &ldquo;perspectives&rdquo;. Each perspective has a separate buffer list, window layout, and a few other things that make it easier to separate things within Emacs.</p>
<p>One feature I&rsquo;d like to highlight is integration between perspective.el and <a href="https://github.com/Alexander-Miller/treemacs">treemacs</a>, where one perspective can have a separate treemacs tree. Although now tab-bar.el seems to be getting into shape to compete with perspective.el, as of the time of this writing, there&rsquo;s no such integration, at least not out of the box.</p>
<p>perspective.el works with EXWM more or less as one would expect - each EXWM workspace has its own set of perspectives. That way it feels somewhat like having multiple Emacs frames in a tiling window manager, although, of course, much more integrated with Emacs.</p>
<p>However, there are still some issues. For instance, I was having strange behaviors with floating windows, EXWM buffers in perspectives, etc. So I&rsquo;ve made a package called <a href="https://github.com/SqrtMinusOne/perspective-exwm.el">perspective-exwm.el</a> that does two things:</p>
<ul>
<li>Fixes issues I found with some advises and hooks. Take a look at the package homepage for more detail on that.</li>
<li>Provides some additional functionality that makes use of both perspective.el and EXWM.</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/SqrtMinusOne/perspective-exwm.el">perspective-exwm.el repo</a></li>
</ul>
<!--listend-->
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">use-package</span> <span style="color:#19177c">perspective-exwm</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:straight</span> <span style="color:#800">t</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:config</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">perspective-exwm-override-initial-name</span>
</span></span><span style="display:flex;"><span>	<span style="color:#666">&#39;</span>((<span style="color:#666">0</span> <span style="color:#666">.</span> <span style="color:#ba2121">&#34;misc&#34;</span>)
</span></span><span style="display:flex;"><span>	  (<span style="color:#666">1</span> <span style="color:#666">.</span> <span style="color:#ba2121">&#34;core&#34;</span>)
</span></span><span style="display:flex;"><span>	  (<span style="color:#666">2</span> <span style="color:#666">.</span> <span style="color:#ba2121">&#34;browser&#34;</span>)
</span></span><span style="display:flex;"><span>	  (<span style="color:#666">3</span> <span style="color:#666">.</span> <span style="color:#ba2121">&#34;comms&#34;</span>)
</span></span><span style="display:flex;"><span>	  (<span style="color:#666">4</span> <span style="color:#666">.</span> <span style="color:#ba2121">&#34;dev&#34;</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">general-define-key</span>
</span></span><span style="display:flex;"><span>   <span style="color:#008000">:keymaps</span> <span style="color:#19177c">&#39;perspective-map</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ba2121">&#34;e&#34;</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">perspective-exwm-move-to-workspace</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ba2121">&#34;E&#34;</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">perspective-exwm-copy-to-workspace</span>))
</span></span></code></pre></div><p>By default, a new Emacs buffer opens in the current perspective in the current workspace, but sure enough, it&rsquo;s possible to change that.</p>
<p>For EXWM windows, the <code>perspective-exwm</code> package provides a function called <code>perspective-exwm-assign-window</code>, which is intended to be used in <code>exwm-manage-finish-hook</code>, for instance:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-configure-window</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">pcase</span> <span style="color:#19177c">exwm-class-name</span>
</span></span><span style="display:flex;"><span>    ((<span style="color:#008000">or</span> <span style="color:#ba2121">&#34;Firefox&#34;</span> <span style="color:#ba2121">&#34;Nightly&#34;</span>)
</span></span><span style="display:flex;"><span>     (<span style="color:#19177c">perspective-exwm-assign-window</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000">:workspace-index</span> <span style="color:#666">2</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000">:persp-name</span> <span style="color:#ba2121">&#34;browser&#34;</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ba2121">&#34;Alacritty&#34;</span>
</span></span><span style="display:flex;"><span>     (<span style="color:#19177c">perspective-exwm-assign-window</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000">:persp-name</span> <span style="color:#ba2121">&#34;term&#34;</span>))
</span></span><span style="display:flex;"><span>    ((<span style="color:#008000">or</span> <span style="color:#ba2121">&#34;VK&#34;</span> <span style="color:#ba2121">&#34;Slack&#34;</span> <span style="color:#ba2121">&#34;discord&#34;</span> <span style="color:#ba2121">&#34;TelegramDesktop&#34;</span>)
</span></span><span style="display:flex;"><span>     (<span style="color:#19177c">perspective-exwm-assign-window</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000">:workspace-index</span> <span style="color:#666">3</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000">:persp-name</span> <span style="color:#ba2121">&#34;comms&#34;</span>))
</span></span><span style="display:flex;"><span>    ((<span style="color:#008000">or</span> <span style="color:#ba2121">&#34;Chromium-browser&#34;</span> <span style="color:#ba2121">&#34;jetbrains-datagrip&#34;</span>)
</span></span><span style="display:flex;"><span>     (<span style="color:#19177c">perspective-exwm-assign-window</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000">:workspace-index</span> <span style="color:#666">4</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000">:persp-name</span> <span style="color:#ba2121">&#34;dev&#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#19177c">add-hook</span> <span style="color:#19177c">&#39;exwm-manage-finish-hook</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/exwm-configure-window</span>)
</span></span></code></pre></div><h3 id="workspaces-and-multi-monitor-setup">Workspaces and multi-monitor setup</h3>
<p>A section about improving management of EXWM workspaces.</p>
<p>Some features, common in other tiling WMs, are missing in EXWM out of the box, namely:</p>
<ul>
<li>a command to <a href="https://i3wm.org/docs/userguide.html#_focusing_moving_containers">switch to another monitor</a>;</li>
<li>a command to <a href="https://i3wm.org/docs/userguide.html#move_to_outputs">move the current workspace to another monitor</a>;</li>
<li>using the same commands to switch between windows and monitors.</li>
</ul>
<p>Here&rsquo;s my take on implementing them.</p>
<h4 id="tracking-recently-used-workspaces">Tracking recently used workspaces</h4>
<p>First up though, we need to track the workspaces in the usage order. I&rsquo;m not sure if there&rsquo;s some built-in functionality in EXWM for that, but it seems simple enough to implement.</p>
<p>Here is a snippet of code that does it:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">setq</span> <span style="color:#19177c">my/exwm-last-workspaces</span> <span style="color:#666">&#39;</span>(<span style="color:#666">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-store-last-workspace</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Save the last workspace to </span><span style="color:#19177c">`my/exwm-last-workspaces&#39;</span><span style="color:#ba2121">.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">my/exwm-last-workspaces</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">seq-uniq</span> (<span style="color:#00f">cons</span> <span style="color:#19177c">exwm-workspace-current-index</span>
</span></span><span style="display:flex;"><span>			<span style="color:#19177c">my/exwm-last-workspaces</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#19177c">add-hook</span> <span style="color:#19177c">&#39;exwm-workspace-switch-hook</span>
</span></span><span style="display:flex;"><span>	  <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/exwm-store-last-workspace</span>)
</span></span></code></pre></div><p>The variable <code>my/exwm-last-workspaces</code> stores the workspace indices; the first item is the index of the current workspace, the second item is the index of the previous workspace, and so on.</p>
<p>One note here is that workspaces may also disappear (e.g. after <code>M-x exwm-workspace-delete</code>), so we also need a function to clean the list:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-last-workspaces-clear</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Clean </span><span style="color:#19177c">`my/exwm-last-workspaces&#39;</span><span style="color:#ba2121"> from deleted workspaces.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">my/exwm-last-workspaces</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">seq-filter</span>
</span></span><span style="display:flex;"><span>	 (<span style="color:#008000">lambda</span> (<span style="color:#19177c">i</span>) (<span style="color:#00f">nth</span> <span style="color:#19177c">i</span> <span style="color:#19177c">exwm-workspace--list</span>))
</span></span><span style="display:flex;"><span>	 <span style="color:#19177c">my/exwm-last-workspaces</span>)))
</span></span></code></pre></div><h4 id="the-monitor-list">The monitor list</h4>
<p>The second piece of the puzzle is getting the monitor list in the right order.</p>
<p>While it is possible to retrieve the monitor list from <code>exwm-randr-workspace-output-plist</code>, this won&rsquo;t scale well beyond two monitors, mainly because changing this variable may screw up the order.</p>
<p>So the easiest way is to just define the variable like that:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">setq</span> <span style="color:#19177c">my/exwm-monitor-list</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#008000">pcase</span> (<span style="color:#00f">system-name</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#ba2121">&#34;indigo&#34;</span> <span style="color:#666">&#39;</span>(<span style="color:#800">nil</span> <span style="color:#ba2121">&#34;DVI-D-0&#34;</span>))
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">_</span> <span style="color:#666">&#39;</span>(<span style="color:#800">nil</span>))))
</span></span></code></pre></div><p>If you are changing the RandR configuration on the fly, this variable will also need to be changed, but for now, I don&rsquo;t have such a necessity.</p>
<p>A function to get the current monitor:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-get-current-monitor</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Return the current monitor name or nil.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">plist-get</span> <span style="color:#19177c">exwm-randr-workspace-output-plist</span>
</span></span><span style="display:flex;"><span>	     (<span style="color:#19177c">cl-position</span> (<span style="color:#00f">selected-frame</span>)
</span></span><span style="display:flex;"><span>			  <span style="color:#19177c">exwm-workspace--list</span>)))
</span></span></code></pre></div><p>And a function to cycle the monitor list in either direction:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-get-other-monitor</span> (<span style="color:#19177c">dir</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Cycle the monitor list in the direction DIR.
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">DIR is either &#39;left or &#39;right.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">nth</span>
</span></span><span style="display:flex;"><span>   (<span style="color:#00f">%</span> (<span style="color:#00f">+</span> (<span style="color:#19177c">cl-position</span>
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">my/exwm-get-current-monitor</span>)
</span></span><span style="display:flex;"><span>	  <span style="color:#19177c">my/exwm-monitor-list</span>
</span></span><span style="display:flex;"><span>	  <span style="color:#008000">:test</span> <span style="color:#00f">#&#39;string-equal</span>)
</span></span><span style="display:flex;"><span>	 (<span style="color:#00f">length</span> <span style="color:#19177c">my/exwm-monitor-list</span>)
</span></span><span style="display:flex;"><span>	 (<span style="color:#008000">pcase</span> <span style="color:#19177c">dir</span>
</span></span><span style="display:flex;"><span>	   (<span style="color:#19177c">&#39;right</span> <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span>	   (<span style="color:#19177c">&#39;left</span> <span style="color:#666">-1</span>)))
</span></span><span style="display:flex;"><span>      (<span style="color:#00f">length</span> <span style="color:#19177c">my/exwm-monitor-list</span>))
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">my/exwm-monitor-list</span>))
</span></span></code></pre></div><h4 id="switch-to-another-monitor">Switch to another monitor</h4>
<p>With the functions from the previous two sections, we can implement switching to another monitor by switching to the most recently used workspace on that monitor.</p>
<p>One caveat here is that on the startup the <code>my/exwm-last-workspaces</code> variable won&rsquo;t have any values from other monitor(s), so this list is concatenated with the list of available workspace indices.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-switch-to-other-monitor</span> (<span style="color:#008000">&amp;optional</span> <span style="color:#19177c">dir</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Switch to another monitor.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">my/exwm-last-workspaces-clear</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">let</span> ((<span style="color:#19177c">mouse-autoselect-window</span> <span style="color:#800">nil</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#19177c">exwm-workspace-switch</span>
</span></span><span style="display:flex;"><span>     (<span style="color:#008000">cl-loop</span> <span style="color:#19177c">with</span> <span style="color:#19177c">other-monitor</span> <span style="color:#00f">=</span> (<span style="color:#19177c">my/exwm-get-other-monitor</span> (<span style="color:#008000">or</span> <span style="color:#19177c">dir</span> <span style="color:#19177c">&#39;right</span>))
</span></span><span style="display:flex;"><span>	      <span style="color:#19177c">for</span> <span style="color:#19177c">i</span> <span style="color:#19177c">in</span> (<span style="color:#00f">append</span> <span style="color:#19177c">my/exwm-last-workspaces</span>
</span></span><span style="display:flex;"><span>			       (<span style="color:#008000">cl-loop</span> <span style="color:#19177c">for</span> <span style="color:#19177c">i</span> <span style="color:#19177c">from</span> <span style="color:#666">0</span>
</span></span><span style="display:flex;"><span>					<span style="color:#19177c">for</span> <span style="color:#19177c">_</span> <span style="color:#19177c">in</span> <span style="color:#19177c">exwm-workspace--list</span>
</span></span><span style="display:flex;"><span>					<span style="color:#19177c">collect</span> <span style="color:#19177c">i</span>))
</span></span><span style="display:flex;"><span>	      <span style="color:#008000">if</span> (<span style="color:#008000">if</span> <span style="color:#19177c">other-monitor</span>
</span></span><span style="display:flex;"><span>		     (<span style="color:#00f">string-equal</span> (<span style="color:#00f">plist-get</span> <span style="color:#19177c">exwm-randr-workspace-output-plist</span> <span style="color:#19177c">i</span>)
</span></span><span style="display:flex;"><span>				   <span style="color:#19177c">other-monitor</span>)
</span></span><span style="display:flex;"><span>		   (<span style="color:#19177c">not</span> (<span style="color:#00f">plist-get</span> <span style="color:#19177c">exwm-randr-workspace-output-plist</span> <span style="color:#19177c">i</span>)))
</span></span><span style="display:flex;"><span>	      <span style="color:#008000">return</span> <span style="color:#19177c">i</span>))))
</span></span></code></pre></div><p>I bind this function to <code>s-q</code>, as I&rsquo;m used from i3.</p>
<h4 id="move-the-workspace-to-another-monitor">Move the workspace to another monitor</h4>
<p>Now, moving the workspace to another monitor.</p>
<p>This is actually quite easy to pull off - one just has to update <code>exwm-randr-workspace-monitor-plist</code> accordingly and run <code>exwm-randr-refresh</code>. I just add another check there because I don&rsquo;t want some monitor to remain without workspaces at all.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-workspace-switch-monitor</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Move the current workspace to another monitor.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">let</span> ((<span style="color:#19177c">new-monitor</span> (<span style="color:#19177c">my/exwm-get-other-monitor</span> <span style="color:#19177c">&#39;right</span>))
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">current-monitor</span> (<span style="color:#19177c">my/exwm-get-current-monitor</span>)))
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">when</span> (<span style="color:#008000">and</span> <span style="color:#19177c">current-monitor</span>
</span></span><span style="display:flex;"><span>	       (<span style="color:#00f">&gt;=</span> <span style="color:#666">1</span>
</span></span><span style="display:flex;"><span>		   (<span style="color:#008000">cl-loop</span> <span style="color:#19177c">for</span> (<span style="color:#19177c">key</span> <span style="color:#19177c">value</span>) <span style="color:#19177c">on</span> <span style="color:#19177c">exwm-randr-workspace-monitor-plist</span>
</span></span><span style="display:flex;"><span>			    <span style="color:#19177c">by</span> <span style="color:#19177c">&#39;cddr</span>
</span></span><span style="display:flex;"><span>			    <span style="color:#008000">if</span> (<span style="color:#00f">string-equal</span> <span style="color:#19177c">value</span> <span style="color:#19177c">current-monitor</span>) <span style="color:#19177c">sum</span> <span style="color:#666">1</span>)))
</span></span><span style="display:flex;"><span>      (<span style="color:#d2413a;font-weight:bold">error</span> <span style="color:#ba2121">&#34;Can&#39;t remove the last workspace on the monitor!&#34;</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">setq</span> <span style="color:#19177c">exwm-randr-workspace-monitor-plist</span>
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">map-delete</span> <span style="color:#19177c">exwm-randr-workspace-monitor-plist</span> <span style="color:#19177c">exwm-workspace-current-index</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">when</span> <span style="color:#19177c">new-monitor</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#008000">setq</span> <span style="color:#19177c">exwm-randr-workspace-monitor-plist</span>
</span></span><span style="display:flex;"><span>	    (<span style="color:#00f">plist-put</span> <span style="color:#19177c">exwm-randr-workspace-monitor-plist</span>
</span></span><span style="display:flex;"><span>		       <span style="color:#19177c">exwm-workspace-current-index</span>
</span></span><span style="display:flex;"><span>		       <span style="color:#19177c">new-monitor</span>))))
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">exwm-randr-refresh</span>))
</span></span></code></pre></div><p>In my configuration this is bound to <code>s-&lt;tab&gt;</code>.</p>
<h4 id="windmove-between-monitors">Windmove between monitors</h4>
<p>And the final (for now) piece of the puzzle is using the same command to switch between windows and monitors. E.g. when the focus is on the right-most window on one monitor, I want the command to switch to the left-most window on the monitor to the right instead of saying &ldquo;No window right from the selected window&rdquo;, as <code>windmove-right</code> does.</p>
<p>So here is my implementation of that. It always does <code>windmove-do-select-window</code> for <code>'down</code> and <code>'up</code>. For <code>'right</code> and <code>'left</code> though, the function calls the previously defined function to switch to other monitor if <code>windmove-find-other-window</code> doesn&rsquo;t return anything.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-windmove</span> (<span style="color:#19177c">dir</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Move to window or monitor in the direction DIR.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">if</span> (<span style="color:#008000">or</span> (<span style="color:#00f">eq</span> <span style="color:#19177c">dir</span> <span style="color:#19177c">&#39;down</span>) (<span style="color:#00f">eq</span> <span style="color:#19177c">dir</span> <span style="color:#19177c">&#39;up</span>))
</span></span><span style="display:flex;"><span>      (<span style="color:#19177c">windmove-do-window-select</span> <span style="color:#19177c">dir</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">let</span> ((<span style="color:#19177c">other-window</span> (<span style="color:#19177c">windmove-find-other-window</span> <span style="color:#19177c">dir</span>))
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">other-monitor</span> (<span style="color:#19177c">my/exwm-get-other-monitor</span> <span style="color:#19177c">dir</span>))
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">opposite-dir</span> (<span style="color:#008000">pcase</span> <span style="color:#19177c">dir</span>
</span></span><span style="display:flex;"><span>			  (<span style="color:#19177c">&#39;left</span> <span style="color:#19177c">&#39;right</span>)
</span></span><span style="display:flex;"><span>			  (<span style="color:#19177c">&#39;right</span> <span style="color:#19177c">&#39;left</span>))))
</span></span><span style="display:flex;"><span>      (<span style="color:#008000">if</span> <span style="color:#19177c">other-window</span>
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">windmove-do-window-select</span> <span style="color:#19177c">dir</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#008000">let</span> ((<span style="color:#19177c">mouse-autoselect-window</span> <span style="color:#800">nil</span>))
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">my/exwm-switch-to-other-monitor</span> <span style="color:#19177c">dir</span>))
</span></span><span style="display:flex;"><span>	(<span style="color:#008000">cl-loop</span> <span style="color:#008000">while</span> (<span style="color:#19177c">windmove-find-other-window</span> <span style="color:#19177c">opposite-dir</span>)
</span></span><span style="display:flex;"><span>		 <span style="color:#008000">do</span> (<span style="color:#19177c">windmove-do-window-select</span> <span style="color:#19177c">opposite-dir</span>))))))
</span></span></code></pre></div><h3 id="completions">Completions</h3>
<p>Setting up some completion interfaces that fit particularly well to use with EXWM. While rofi also works, I want to use Emacs functionality wherever possible to have one completion interface everywhere.</p>
<h4 id="ivy-posframe">ivy-posframe</h4>
<p><a href="https://github.com/tumashu/ivy-posframe">ivy-posframe</a> is an extension to show ivy candidates in a posframe.</p>
<p>Take a look at <a href="https://github.com/ch11ng/exwm/issues/550">this issue</a> in the EXWM repo about setting it up.</p>
<p>Edit <span class="timestamp-wrapper"><span class="timestamp">&lt;2022-04-09 Sat&gt;</span></span>: This looks nice, but unfortunately too unstable. Disabling it.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">use-package</span> <span style="color:#19177c">ivy-posframe</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:straight</span> <span style="color:#800">t</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:disabled</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:config</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">ivy-posframe-parameters</span> <span style="color:#666">&#39;</span>((<span style="color:#19177c">left-fringe</span> <span style="color:#666">.</span> <span style="color:#666">10</span>)
</span></span><span style="display:flex;"><span>				  (<span style="color:#19177c">right-fringe</span> <span style="color:#666">.</span> <span style="color:#666">10</span>)
</span></span><span style="display:flex;"><span>				  (<span style="color:#19177c">parent-frame</span> <span style="color:#666">.</span> <span style="color:#800">nil</span>)
</span></span><span style="display:flex;"><span>				  (<span style="color:#19177c">max-width</span> <span style="color:#666">.</span> <span style="color:#666">80</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">ivy-posframe-height-alist</span> <span style="color:#666">&#39;</span>((<span style="color:#800">t</span> <span style="color:#666">.</span> <span style="color:#666">20</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">ivy-posframe-width</span> <span style="color:#666">180</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">ivy-posframe-min-height</span> <span style="color:#666">5</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">ivy-posframe-display-functions-alist</span>
</span></span><span style="display:flex;"><span>	<span style="color:#666">&#39;</span>((<span style="color:#19177c">swiper</span> <span style="color:#666">.</span> <span style="color:#19177c">ivy-display-function-fallback</span>)
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">swiper-isearch</span> <span style="color:#666">.</span> <span style="color:#19177c">ivy-display-function-fallback</span>)
</span></span><span style="display:flex;"><span>	  (<span style="color:#800">t</span> <span style="color:#666">.</span> <span style="color:#19177c">ivy-posframe-display</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">ivy-posframe-mode</span> <span style="color:#666">1</span>))
</span></span></code></pre></div><h5 id="disable-mouse-movement">Disable mouse movement</h5>
<p><strong>SOURCE</strong>: <a href="https://github.com/ch11ng/exwm/issues/550#issuecomment-744784838">https://github.com/ch11ng/exwm/issues/550#issuecomment-744784838</a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/advise-fn-suspend-follow-mouse</span> (<span style="color:#19177c">fn</span> <span style="color:#008000">&amp;rest</span> <span style="color:#19177c">args</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">let</span> ((<span style="color:#19177c">focus-follows-mouse</span> <span style="color:#800">nil</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">mouse-autoselect-window</span> <span style="color:#800">nil</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">pos</span> (<span style="color:#19177c">x-mouse-absolute-pixel-position</span>)))
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">unwind-protect</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#00f">apply</span> <span style="color:#19177c">fn</span> <span style="color:#19177c">args</span>)
</span></span><span style="display:flex;"><span>      (<span style="color:#19177c">x-set-mouse-absolute-pixel-position</span> (<span style="color:#00f">car</span> <span style="color:#19177c">pos</span>)
</span></span><span style="display:flex;"><span>					   (<span style="color:#00f">cdr</span> <span style="color:#19177c">pos</span>)))))
</span></span><span style="display:flex;"><span>(<span style="color:#008000">with-eval-after-load</span> <span style="color:#19177c">&#39;ivy-posframe</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">advice-add</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">ivy-posframe--read</span> <span style="color:#008000">:around</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/advise-fn-suspend-follow-mouse</span>))
</span></span></code></pre></div><h5 id="disable-changing-focus">Disable changing focus</h5>
<p>Not sure about that. The cursor occasionally changes focus when I&rsquo;m exiting posframe, and this doesn&rsquo;t catch all the cases.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/setup-posframe</span> (<span style="color:#008000">&amp;rest</span> <span style="color:#19177c">args</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">mapc</span>
</span></span><span style="display:flex;"><span>   (<span style="color:#008000">lambda</span> (<span style="color:#19177c">var</span>)
</span></span><span style="display:flex;"><span>     (<span style="color:#00f">kill-local-variable</span> <span style="color:#19177c">var</span>)
</span></span><span style="display:flex;"><span>     (<span style="color:#008000">setf</span> (<span style="color:#00f">symbol-value</span> <span style="color:#19177c">var</span>) <span style="color:#800">nil</span>))
</span></span><span style="display:flex;"><span>   <span style="color:#666">&#39;</span>(<span style="color:#19177c">exwm-workspace-warp-cursor</span>
</span></span><span style="display:flex;"><span>     <span style="color:#19177c">mouse-autoselect-window</span>
</span></span><span style="display:flex;"><span>     <span style="color:#19177c">focus-follows-mouse</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/restore-posframe</span> (<span style="color:#008000">&amp;rest</span> <span style="color:#19177c">args</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">run-with-timer</span>
</span></span><span style="display:flex;"><span>   <span style="color:#666">0.25</span>
</span></span><span style="display:flex;"><span>   (<span style="color:#008000">lambda</span> ()
</span></span><span style="display:flex;"><span>     (<span style="color:#00f">mapc</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#008000">lambda</span> (<span style="color:#19177c">var</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#00f">kill-local-variable</span> <span style="color:#19177c">var</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#008000">setf</span> (<span style="color:#00f">symbol-value</span> <span style="color:#19177c">var</span>) <span style="color:#800">t</span>))
</span></span><span style="display:flex;"><span>      <span style="color:#666">&#39;</span>(<span style="color:#19177c">exwm-workspace-warp-cursor</span>
</span></span><span style="display:flex;"><span>	<span style="color:#19177c">mouse-autoselect-window</span>
</span></span><span style="display:flex;"><span>	<span style="color:#19177c">focus-follows-mouse</span>)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#008000">with-eval-after-load</span> <span style="color:#19177c">&#39;ivy-posframe</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">advice-add</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">posframe--create-posframe</span> <span style="color:#008000">:after</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/setup-posframe</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">advice-add</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">ivy-posframe-cleanup</span> <span style="color:#008000">:after</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/restore-posframe</span>))
</span></span></code></pre></div><h4 id="linux-app">Linux app</h4>
<p><code>counsel-linux-app</code> is a counsel interface to select a Linux desktop application.</p>
<p>By default, it also shows paths from <code>/gnu/store</code>, so there is a custom formatter function.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/counsel-linux-app-format-function</span> (<span style="color:#19177c">name</span> <span style="color:#19177c">comment</span> <span style="color:#19177c">_exec</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">format</span> <span style="color:#ba2121">&#34;% -45s%s&#34;</span>
</span></span><span style="display:flex;"><span>	  (<span style="color:#00f">propertize</span>
</span></span><span style="display:flex;"><span>	   (<span style="color:#19177c">ivy--truncate-string</span> <span style="color:#19177c">name</span> <span style="color:#666">45</span>)
</span></span><span style="display:flex;"><span>	   <span style="color:#19177c">&#39;face</span> <span style="color:#19177c">&#39;counsel-application-name</span>)
</span></span><span style="display:flex;"><span>	  (<span style="color:#008000">if</span> <span style="color:#19177c">comment</span>
</span></span><span style="display:flex;"><span>	      (<span style="color:#00f">concat</span> <span style="color:#ba2121">&#34;: &#34;</span> (<span style="color:#19177c">ivy--truncate-string</span> <span style="color:#19177c">comment</span> <span style="color:#666">100</span>))
</span></span><span style="display:flex;"><span>	    <span style="color:#ba2121">&#34;&#34;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#008000">setq</span> <span style="color:#19177c">counsel-linux-app-format-function</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/counsel-linux-app-format-function</span>)
</span></span></code></pre></div><p>Also, by default it tries to launch stuff with <code>gtk-launch</code>, which is in the <code>gtk+</code> package.</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>desktop-misc</td>
<td>gtk+:bin</td>
</tr>
</tbody>
</table>
<h4 id="password-store-ivy">password-store-ivy</h4>
<p><a href="https://github.com/SqrtMinusOne/password-store-ivy">password-store-ivy</a> is another package of mine, inspired by <a href="https://github.com/carnager/rofi-pass">rofi-pass</a>.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">use-package</span> <span style="color:#19177c">password-store-ivy</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:straight</span> (<span style="color:#008000">:host</span> <span style="color:#19177c">github</span> <span style="color:#008000">:repo</span> <span style="color:#ba2121">&#34;SqrtMinusOne/password-store-ivy&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:after</span> (<span style="color:#19177c">exwm</span>))
</span></span></code></pre></div><h4 id="emojis">emojis</h4>
<p><a href="https://github.com/iqbalansari/emacs-emojify">emojify</a> is an Emacs package that adds emoji display to Emacs. While its primary capacity is no longer necessary in Emacs 28, it a few functions to insert emojis are still handy.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">use-package</span> <span style="color:#19177c">emojify</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:straight</span> <span style="color:#800">t</span>)
</span></span></code></pre></div><p>Because I occasionally want to type emojis to other programs, I reuse a function from <code>password-store-ivy</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/emojify-type</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Type an emoji.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">let</span> ((<span style="color:#19177c">emoji</span> (<span style="color:#19177c">emojify-completing-read</span> <span style="color:#ba2121">&#34;Type emoji: &#34;</span>)))
</span></span><span style="display:flex;"><span>    (<span style="color:#19177c">kill-new</span> <span style="color:#19177c">emoji</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#19177c">password-store-ivy--async-commands</span>
</span></span><span style="display:flex;"><span>     (<span style="color:#00f">list</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#19177c">password-store-ivy--get-wait-command</span> <span style="color:#666">10</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#ba2121">&#34;xdotool key Shift+Insert&#34;</span>))))
</span></span></code></pre></div><h3 id="keybindings">Keybindings</h3>
<h4 id="exwm-keybindings">EXWM keybindings</h4>
<p>Setting keybindings for EXWM. This actually has to be in the <code>:config</code> block of the <code>use-package</code> form, that is it has to be run after EXWM is loaded, so I use noweb to put this block in the correct place.</p>
<p>First, some prefixes for keybindings that are always passed to EXWM instead of the X application in <code>line-mode</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">setq</span> <span style="color:#19177c">exwm-input-prefix-keys</span>
</span></span><span style="display:flex;"><span>      <span style="color:#666">`</span>(<span style="color:#ba2121">?\C</span><span style="color:#19177c">-x</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ba2121">?\C</span><span style="color:#19177c">-w</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ba2121">?\M</span><span style="color:#19177c">-x</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ba2121">?\M</span><span style="color:#19177c">-u</span>))
</span></span></code></pre></div><p>Also other local keybindings, that are also available only in <code>line-mode</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defmacro</span> <span style="color:#19177c">my/app-command</span> (<span style="color:#19177c">command</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#666">`</span>(<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/run-in-background</span> <span style="color:#666">,</span><span style="color:#19177c">command</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#19177c">general-define-key</span>
</span></span><span style="display:flex;"><span> <span style="color:#008000">:keymaps</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">exwm-mode-map</span>)
</span></span><span style="display:flex;"><span> <span style="color:#ba2121">&#34;C-q&#34;</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">exwm-input-send-next-key</span>
</span></span><span style="display:flex;"><span> <span style="color:#ba2121">&#34;&lt;print&gt;&#34;</span> (<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;flameshot gui&#34;</span>)
</span></span><span style="display:flex;"><span> <span style="color:#ba2121">&#34;&lt;mode-line&gt; s-&lt;mouse-4&gt;&#34;</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">perspective-exwm-cycle-exwm-buffers-backward</span>
</span></span><span style="display:flex;"><span> <span style="color:#ba2121">&#34;&lt;mode-line&gt; s-&lt;mouse-5&gt;&#34;</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">perspective-exwm-cycle-exwm-buffers-forward</span>
</span></span><span style="display:flex;"><span> <span style="color:#ba2121">&#34;M-x&#34;</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">counsel-M-x</span>
</span></span><span style="display:flex;"><span> <span style="color:#ba2121">&#34;M-SPC&#34;</span> (<span style="color:#19177c">general-key</span> <span style="color:#ba2121">&#34;SPC&#34;</span>))
</span></span></code></pre></div><p>Simulation keys.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">setq</span> <span style="color:#19177c">exwm-input-simulation-keys</span> <span style="color:#666">`</span>((<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;M-w&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;C-w&#34;</span>))
</span></span><span style="display:flex;"><span>				   (<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;M-c&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;C-c&#34;</span>))))
</span></span></code></pre></div><p>A quit function with a confirmation.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-quit</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">when</span> (<span style="color:#008000">or</span> (<span style="color:#19177c">not</span> (<span style="color:#00f">eq</span> (<span style="color:#00f">selected-window</span>) (<span style="color:#00f">next-window</span>)))
</span></span><span style="display:flex;"><span>	    (<span style="color:#19177c">y-or-n-p</span> <span style="color:#ba2121">&#34;This is the last window. Are you sure?&#34;</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#19177c">evil-quit</span>)))
</span></span></code></pre></div><p>And keybindings that are available in both <code>char-mode</code> and <code>line-mode</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">setq</span> <span style="color:#19177c">exwm-input-global-keys</span>
</span></span><span style="display:flex;"><span>      <span style="color:#666">`</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Reset to line-mode</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-R&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">exwm-reset</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Switch windows</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-&lt;left&gt;&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-windmove</span> <span style="color:#19177c">&#39;left</span>)))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-&lt;right&gt;&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-windmove</span> <span style="color:#19177c">&#39;right</span>)))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-&lt;up&gt;&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-windmove</span> <span style="color:#19177c">&#39;up</span>)))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-&lt;down&gt;&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-windmove</span> <span style="color:#19177c">&#39;down</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-h&#34;</span>)<span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-windmove</span> <span style="color:#19177c">&#39;left</span>)))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-l&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-windmove</span> <span style="color:#19177c">&#39;right</span>)))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-k&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-windmove</span> <span style="color:#19177c">&#39;up</span>)))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-j&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-windmove</span> <span style="color:#19177c">&#39;down</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Moving windows</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-H&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-move-window</span> <span style="color:#19177c">&#39;left</span>)))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-L&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-move-window</span> <span style="color:#19177c">&#39;right</span>)))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-K&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-move-window</span> <span style="color:#19177c">&#39;up</span>)))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-J&#34;</span>) <span style="color:#666">.</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/exwm-move-window</span> <span style="color:#19177c">&#39;down</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Fullscreen</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-f&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">exwm-layout-toggle-fullscreen</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-F&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">exwm-floating-toggle-floating</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Quit</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-Q&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">my/exwm-quit</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Split windows</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-s&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">evil-window-vsplit</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-v&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">evil-window-hsplit</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Switch perspectives</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-,&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">persp-prev</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-.&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">persp-next</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Switch buffers</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-e&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">persp-ivy-switch-buffer</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-E&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">my/persp-ivy-switch-buffer-other-window</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Resize windows</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-r&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">my/exwm-resize-hydra/body</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Apps &amp; stuff</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-p&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">counsel-linux-app</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-P&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">async-shell-command</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-;&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">my/exwm-apps-hydra/body</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s--&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">password-store-ivy</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-=&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">my/emojify-type</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-i&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;copyq menu&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Basic controls</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;&lt;XF86AudioRaiseVolume&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;ponymix increase 5 --max-volume 150&#34;</span>))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;&lt;XF86AudioLowerVolume&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;ponymix decrease 5 --max-volume 150&#34;</span>))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;&lt;XF86MonBrightnessUp&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;light -A 5&#34;</span>))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;&lt;XF86MonBrightnessDown&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;light -U 5&#34;</span>))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;&lt;XF86AudioMute&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;ponymix toggle&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;&lt;XF86AudioPlay&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;mpc toggle&#34;</span>))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;&lt;XF86AudioPause&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;mpc pause&#34;</span>))
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;&lt;print&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;flameshot gui&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Switch workspace</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-q&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">my/exwm-switch-to-other-monitor</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-w&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">exwm-workspace-switch</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-W&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">exwm-workspace-move-window</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-&lt;tab&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">my/exwm-workspace-switch-monitor</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; Perspectives</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-[&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">perspective-exwm-cycle-exwm-buffers-backward</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-]&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">perspective-exwm-cycle-exwm-buffers-forward</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-&lt;mouse-4&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">perspective-exwm-cycle-exwm-buffers-backward</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-&lt;mouse-5&gt;&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">perspective-exwm-cycle-exwm-buffers-forward</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-`&#34;</span>) <span style="color:#666">.</span> <span style="color:#19177c">perspective-exwm-switch-perspective</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> <span style="color:#ba2121">&#34;s-o&#34;</span>) <span style="color:#666">.</span> <span style="color:#666">,</span>(<span style="color:#19177c">my/app-command</span> <span style="color:#ba2121">&#34;rofi -show window&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#408080;font-style:italic">;; &#39;s-N&#39;: Switch to certain workspace with Super (Win) plus a number key (0 - 9)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#666">,@</span>(<span style="color:#00f">mapcar</span> (<span style="color:#008000">lambda</span> (<span style="color:#19177c">i</span>)
</span></span><span style="display:flex;"><span>		    <span style="color:#666">`</span>(<span style="color:#666">,</span>(<span style="color:#19177c">kbd</span> (<span style="color:#00f">format</span> <span style="color:#ba2121">&#34;s-%d&#34;</span> <span style="color:#19177c">i</span>)) <span style="color:#666">.</span>
</span></span><span style="display:flex;"><span>		      (<span style="color:#008000">lambda</span> ()
</span></span><span style="display:flex;"><span>			(<span style="color:#008000">interactive</span>)
</span></span><span style="display:flex;"><span>			(<span style="color:#008000">when</span> (<span style="color:#008000">or</span> (<span style="color:#00f">&lt;</span> <span style="color:#666">,</span><span style="color:#19177c">i</span> (<span style="color:#19177c">exwm-workspace--count</span>))
</span></span><span style="display:flex;"><span>				  (<span style="color:#19177c">y-or-n-p</span> (<span style="color:#00f">format</span> <span style="color:#ba2121">&#34;Create workspace %d&#34;</span> <span style="color:#666">,</span><span style="color:#19177c">i</span>)))
</span></span><span style="display:flex;"><span>			  (<span style="color:#19177c">exwm-workspace-switch-create</span> <span style="color:#666">,</span><span style="color:#19177c">i</span>) ))))
</span></span><span style="display:flex;"><span>		  (<span style="color:#19177c">number-sequence</span> <span style="color:#666">0</span> <span style="color:#666">9</span>))))
</span></span></code></pre></div><p>A function to apply changes to <code>exwm-input-global-keys</code>.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-update-global-keys</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">exwm-input--global-keys</span> <span style="color:#800">nil</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">dolist</span> (<span style="color:#19177c">i</span> <span style="color:#19177c">exwm-input-global-keys</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#19177c">exwm-input--set-key</span> (<span style="color:#00f">car</span> <span style="color:#19177c">i</span>) (<span style="color:#00f">cdr</span> <span style="color:#19177c">i</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">when</span> <span style="color:#19177c">exwm--connection</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#19177c">exwm-input--update-global-prefix-keys</span>)))
</span></span></code></pre></div><h4 id="app-shortcuts">App shortcuts</h4>
<p>A <del>transient</del> hydra for shortcuts for the most frequent apps.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/run-in-background</span> (<span style="color:#19177c">command</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">let</span> ((<span style="color:#19177c">command-parts</span> (<span style="color:#19177c">split-string</span> <span style="color:#19177c">command</span> <span style="color:#ba2121">&#34;[ ]+&#34;</span>)))
</span></span><span style="display:flex;"><span>    (<span style="color:#00f">apply</span> <span style="color:#00f">#&#39;call-process</span> <span style="color:#666">`</span>(<span style="color:#666">,</span>(<span style="color:#00f">car</span> <span style="color:#19177c">command-parts</span>) <span style="color:#800">nil</span> <span style="color:#666">0</span> <span style="color:#800">nil</span> <span style="color:#666">,@</span>(<span style="color:#00f">cdr</span> <span style="color:#19177c">command-parts</span>)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#19177c">defhydra</span> <span style="color:#19177c">my/exwm-apps-hydra</span> (<span style="color:#008000">:color</span> <span style="color:#19177c">blue</span> <span style="color:#008000">:hint</span> <span style="color:#800">nil</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">^Apps^
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">_t_: Terminal (Alacritty)
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">_b_: Browser (Firefox)
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">_v_: VK
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">_s_: Slack
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">_e_: Telegram
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">_d_: Discord
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;t&#34;</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/run-in-background</span> <span style="color:#ba2121">&#34;alacritty&#34;</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;b&#34;</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/run-in-background</span> <span style="color:#ba2121">&#34;firefox&#34;</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;v&#34;</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/run-in-background</span> <span style="color:#ba2121">&#34;vk&#34;</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;s&#34;</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/run-in-background</span> <span style="color:#ba2121">&#34;slack-wrapper&#34;</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;e&#34;</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/run-in-background</span> <span style="color:#ba2121">&#34;flatpak run org.telegram.desktop&#34;</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#ba2121">&#34;d&#34;</span> (<span style="color:#008000">lambda</span> () (<span style="color:#008000">interactive</span>) (<span style="color:#19177c">my/run-in-background</span> <span style="color:#ba2121">&#34;flatpak run com.discordapp.Discord&#34;</span>))))
</span></span></code></pre></div><h4 id="locking-up">Locking up</h4>
<p>Run i3lock.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-lock</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">my/run-in-background</span> <span style="color:#ba2121">&#34;i3lock -f -i /home/pavel/Pictures/lock-wallpaper.png&#34;</span>))
</span></span></code></pre></div><h3 id="fixes">Fixes</h3>
<h4 id="catch-and-report-all-errors-raised-when-invoking-command-hooks">Catch and report all errors raised when invoking command hooks</h4>
<ul>
<li><strong>CREDIT</strong>: Thanks David! <a href="https://github.com/daviwil/exwm/commit/7b1be884124711af0a02eac740bdb69446bc54cc">https://github.com/daviwil/exwm/commit/7b1be884124711af0a02eac740bdb69446bc54cc</a></li>
</ul>
<!--listend-->
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">exwm-input--fake-last-command</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#ba2121">&#34;Fool some packages into thinking there is a change in the buffer.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">last-command</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">exwm-input--noop</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">condition-case</span> <span style="color:#19177c">hook-error</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#008000">progn</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#00f">run-hooks</span> <span style="color:#19177c">&#39;pre-command-hook</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#00f">run-hooks</span> <span style="color:#19177c">&#39;post-command-hook</span>))
</span></span><span style="display:flex;"><span>    ((<span style="color:#d2413a;font-weight:bold">error</span>)
</span></span><span style="display:flex;"><span>     (<span style="color:#19177c">exwm--log</span> <span style="color:#ba2121">&#34;Error occurred while running command hooks: %s\n\nBacktrace:\n\n%s&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#19177c">hook-error</span>
</span></span><span style="display:flex;"><span>		(<span style="color:#008000">with-temp-buffer</span>
</span></span><span style="display:flex;"><span>		  (<span style="color:#008000">setq-local</span> <span style="color:#19177c">standard-output</span> (<span style="color:#00f">current-buffer</span>))
</span></span><span style="display:flex;"><span>		  (<span style="color:#00f">backtrace</span>)
</span></span><span style="display:flex;"><span>		  (<span style="color:#00f">buffer-string</span>))))))
</span></span></code></pre></div><h4 id="improve-floating-windows-behavior">Improve floating windows behavior</h4>
<p>These 3 settings seem to cause particular trouble with floating windows. Setting them to <code>nil</code> improves the stability greatly.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/fix-exwm-floating-windows</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq-local</span> <span style="color:#19177c">exwm-workspace-warp-cursor</span> <span style="color:#800">nil</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq-local</span> <span style="color:#19177c">mouse-autoselect-window</span> <span style="color:#800">nil</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq-local</span> <span style="color:#19177c">focus-follows-mouse</span> <span style="color:#800">nil</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#19177c">add-hook</span> <span style="color:#19177c">&#39;exwm-floating-setup-hook</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/fix-exwm-floating-windows</span>)
</span></span></code></pre></div><h3 id="exwm-config">EXWM config</h3>
<p>And the EXWM config itself.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-init</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">exwm-workspace-switch</span> <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">my/exwm-run-polybar</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">my/exwm-set-wallpaper</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">my/exwm-run-shepherd</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">my/run-in-background</span> <span style="color:#ba2121">&#34;gpgconf --reload gpg-agent&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#008000">defun</span> <span style="color:#19177c">my/exwm-update-class</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">exwm-workspace-rename-buffer</span> (<span style="color:#00f">format</span> <span style="color:#ba2121">&#34;EXWM :: %s&#34;</span> <span style="color:#19177c">exwm-class-name</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#008000">use-package</span> <span style="color:#19177c">exwm</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:straight</span> <span style="color:#800">t</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000">:config</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">exwm-workspace-number</span> <span style="color:#666">5</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">add-hook</span> <span style="color:#19177c">&#39;exwm-init-hook</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/exwm-init</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">add-hook</span> <span style="color:#19177c">&#39;exwm-update-class-hook</span> <span style="color:#00f">#&#39;</span><span style="color:#19177c">my/exwm-update-class</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">require</span> <span style="color:#19177c">&#39;exwm-randr</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">exwm-randr-enable</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">start-process-shell-command</span> <span style="color:#ba2121">&#34;xrandr&#34;</span> <span style="color:#800">nil</span> <span style="color:#ba2121">&#34;~/bin/scripts/screen-layout&#34;</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">when</span> (<span style="color:#19177c">string=</span> (<span style="color:#00f">system-name</span>) <span style="color:#ba2121">&#34;indigo&#34;</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">setq</span> <span style="color:#19177c">my/exwm-another-monitor</span> <span style="color:#ba2121">&#34;DVI-D-0&#34;</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">setq</span> <span style="color:#19177c">exwm-randr-workspace-monitor-plist</span> <span style="color:#666">`</span>(<span style="color:#666">2</span> <span style="color:#666">,</span><span style="color:#19177c">my/exwm-another-monitor</span> <span style="color:#666">3</span> <span style="color:#666">,</span><span style="color:#19177c">my/exwm-another-monitor</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">exwm-workspace-warp-cursor</span> <span style="color:#800">t</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">mouse-autoselect-window</span> <span style="color:#800">t</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">setq</span> <span style="color:#19177c">focus-follows-mouse</span> <span style="color:#800">t</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#19177c">&lt;&lt;exwm-workspace-config&gt;&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#19177c">&lt;&lt;exwm-keybindings&gt;&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#19177c">&lt;&lt;exwm-mode-line-config&gt;&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#19177c">&lt;&lt;exwm-fixes&gt;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">set-frame-parameter</span> (<span style="color:#00f">selected-frame</span>) <span style="color:#19177c">&#39;alpha</span> <span style="color:#666">&#39;</span>(<span style="color:#666">90</span> <span style="color:#666">.</span> <span style="color:#666">90</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">add-to-list</span> <span style="color:#19177c">&#39;default-frame-alist</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">alpha</span> <span style="color:#666">.</span> (<span style="color:#666">90</span> <span style="color:#666">.</span> <span style="color:#666">90</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">perspective-exwm-mode</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">exwm-enable</span>))
</span></span></code></pre></div><h2 id="i3wm">i3wm</h2>
<table>
<thead>
<tr>
<th>Guix dependency</th>
<th>Disabled</th>
</tr>
</thead>
<tbody>
<tr>
<td>i3-gaps</td>
<td></td>
</tr>
<tr>
<td>i3lock</td>
<td>true</td>
</tr>
</tbody>
</table>
<p><code>i3lock</code> is disabled because the global one has to be used.</p>
<p><a href="https://i3wm.org/">i3wm</a> is a manual tiling window manager, which is currently my window manager of choice. I&rsquo;ve tried several alternatives, including <a href="https://xmonad.org/">xmonad</a> &amp; <a href="https://github.com/ch11ng/exwm">EXWM</a>, <del>but i3 seems to fit my workflow best</del> and decided to switch to EXWM. This section is kept for a few cases when I need to be extra sure that my WM doesn&rsquo;t fail.</p>
<p><a href="https://github.com/Airblader/i3">i3-gaps</a> is an i3 fork with a few features like window gaps. I like to enable inner gaps when there is at least one container in a workspace.</p>
<p>References:</p>
<ul>
<li><a href="https://i3wm.org/docs/">i3wm docs</a></li>
<li><a href="https://github.com/Airblader/i3/wiki">i3-gaps wiki</a></li>
</ul>
<h3 id="general-settings">General settings</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>set $mod Mod4<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>font pango:monospace <span style="color:#666">10</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Use Mouse+$mod to drag floating windows to their wanted position<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>floating_modifier $mod<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Move cursor between monitors<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>mouse_warping output<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Apply XFCE Settings<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># exec xfsettingsd<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># exec xiccd<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Set screen layout<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec ~<span style="color:#b68">/bin/</span>scripts/screen-layout<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Most needed keybindigs<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># reload the configuration file<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+c reload<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># restart i3 inplace (preserves your layout/session, can be used to upgrade i3)<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+r restart<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># exit i3 (logs you out of your X session)<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+e exec <span style="color:#ba2121">&#34;i3-nagbar -t warning -m &#39;You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.&#39; -b &#39;Yes, exit i3&#39; &#39;i3-msg exit&#39;&#34;</span><span style="">
</span></span></span></code></pre></div><h3 id="managing-windows">Managing windows</h3>
<table>
<thead>
<tr>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>rust-i3-switch-tabs</td>
</tr>
</tbody>
</table>
<p>Some keybindings for managing windows.</p>
<p><code>emacs-i3-integration</code> is a script to pass some command to Emacs to get a consistent set of keybindings in both i3 and Emacs. Check out <a href="/configs/emacs/#i3-integration">the section in Emacs.org</a> for details.</p>
<p>Kill focused windows</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+Shift+q exec emacs-i3-integration kill<span style="">
</span></span></span></code></pre></div><p>Change focus</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+h exec emacs-i3-integration focus left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+j exec emacs-i3-integration focus down<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+k exec emacs-i3-integration focus up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+l exec emacs-i3-integration focus right<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Left exec emacs-i3-integration focus left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Down exec emacs-i3-integration focus down<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Up exec emacs-i3-integration focus up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Right exec emacs-i3-integration focus right<span style="">
</span></span></span></code></pre></div><p>Move windows around</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+Shift+h exec emacs-i3-integration move left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+j exec emacs-i3-integration move down<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+k exec emacs-i3-integration move up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+l exec emacs-i3-integration move right<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+Left exec emacs-i3-integration move left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+Down exec emacs-i3-integration move down<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+Up exec emacs-i3-integration move up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+Right exec emacs-i3-integration move right<span style="">
</span></span></span></code></pre></div><p>Split windows</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+s exec emacs-i3-integration split h<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+v exec emacs-i3-integration split v<span style="">
</span></span></span></code></pre></div><p>Switch tabs</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+period exec i3-switch-tabs right<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+comma exec i3-switch-tabs left<span style="">
</span></span></span></code></pre></div><p>Enter fullscreen mode</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span># enter fullscreen mode for the focused container<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+f fullscreen toggle<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+c fullscreen toggle global<span style="">
</span></span></span></code></pre></div><p>Changing layout</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+w layout stacking<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+t layout tabbed<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+e exec emacs-i3-integration layout toggle split<span style="">
</span></span></span></code></pre></div><p>Toggle tiling/floating, switch between tiled and floating windows</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+Shift+f floating toggle<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+z focus mode_toggle<span style="">
</span></span></span></code></pre></div><p>Switching outputs</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+Tab move workspace to output right<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+q focus output right<span style="">
</span></span></span></code></pre></div><p>Focus parent and child container</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+a focus parent<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+A focus child<span style="">
</span></span></span></code></pre></div><p>Toggle sticky</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+Shift+i sticky toggle<span style="">
</span></span></span></code></pre></div><p>Set windows as floating and sticky, move to the top right.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+x floating enable; sticky enable; move position <span style="color:#666">1220</span> <span style="color:#666">0</span>; resize set width <span style="color:#666">700</span> px<span style="">
</span></span></span></code></pre></div><h3 id="workspaces">Workspaces</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>set $w1 <span style="color:#ba2121">&#34;1 🚀&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set $w2 <span style="color:#ba2121">&#34;2 🌍&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set $w3 <span style="color:#ba2121">&#34;3 💬&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set $w4 <span style="color:#ba2121">&#34;4 🛠️️&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set $w7 <span style="color:#ba2121">&#34;7 🛰️&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set $w8 <span style="color:#ba2121">&#34;8 📝&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set $w9 <span style="color:#ba2121">&#34;9 🎵&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set $w10 <span style="color:#ba2121">&#34;10 📦&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+<span style="color:#666">1</span> workspace $w1<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+<span style="color:#666">2</span> workspace $w2<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+<span style="color:#666">3</span> workspace $w3<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+<span style="color:#666">4</span> workspace $w4<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+<span style="color:#666">5</span> workspace <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+<span style="color:#666">6</span> workspace <span style="color:#666">6</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+<span style="color:#666">7</span> workspace $w7<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+<span style="color:#666">8</span> workspace $w8<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+<span style="color:#666">9</span> workspace $w9<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+<span style="color:#666">0</span> workspace $w10<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># move focused container to workspace<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+<span style="color:#666">1</span> move container to workspace $w1<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+<span style="color:#666">2</span> move container to workspace $w2<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+<span style="color:#666">3</span> move container to workspace $w3<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+<span style="color:#666">4</span> move container to workspace $w4<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+<span style="color:#666">5</span> move container to workspace <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+<span style="color:#666">6</span> move container to workspace <span style="color:#666">6</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+<span style="color:#666">7</span> move container to workspace $w7<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+<span style="color:#666">8</span> move container to workspace $w8<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+<span style="color:#666">9</span> move container to workspace $w9<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+<span style="color:#666">0</span> move container to workspace $w10<span style="">
</span></span></span></code></pre></div><h3 id="rules">Rules</h3>
<p>Rules to automatically assign applications to workspaces and do other stuff, like enable floating.</p>
<p>Most apps can be distinguished by a WM class (you can get one with <a href="https://www.x.org/releases/X11R7.5/doc/man/man1/xprop.1.html">xprop</a>), but in some cases it doesn&rsquo;t work, e.g. for terminal applications. In that case rules can be based on a window title, for instance.</p>
<p>However, watch out for the following: rule such as <code>for_window [title=&quot;ncmpcpp.*&quot;] move to workspace $w9</code> will move <strong>any</strong> window with a title starting with <code>ncmpcpp</code> to workspace <code>$w9</code>. For instance, it moves your browser when you google &ldquo;ncmpcpp&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>assign [class=<span style="color:#ba2121">&#34;Emacs&#34;</span>] $w1<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;qutebrowser&#34;</span>] $w2<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;firefox&#34;</span>] $w2<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;VK&#34;</span>] $w3<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;Slack&#34;</span>] $w3<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;discord&#34;</span>] $w3<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;TelegramDesktop&#34;</span>] $w3<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;Postman&#34;</span>] $w4<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;Chromium-browse&#34;</span>] $w4<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;chromium&#34;</span>] $w4<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;google-chrome&#34;</span>] $w4<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [title=<span style="color:#ba2121">&#34;Vue Developer Tools&#34;</span>] $w4<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;Google Play Music Desktop Player&#34;</span>] $w9<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;jetbrains-datagrip&#34;</span>] $w4<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;zoom&#34;</span>] $w7<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;skype&#34;</span>] $w7<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;Mailspring&#34;</span>] $w8<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;Thunderbird&#34;</span>] $w8<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;Joplin&#34;</span>] $w8<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>assign [class=<span style="color:#ba2121">&#34;keepassxc&#34;</span>] $w10<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [title=<span style="color:#ba2121">&#34;VirtScreen&#34;</span>] floating enable<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [title=<span style="color:#ba2121">&#34;ncmpcpp.*&#34;</span>] move to workspace $w9<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [title=<span style="color:#ba2121">&#34;newsboat.*&#34;</span>] move to workspace $w9<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [title=<span style="color:#ba2121">&#34;.*run_wego&#34;</span>] move to workspace $w9<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [class=<span style="color:#ba2121">&#34;cinnamon-settings*&#34;</span>] floating enable<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [title=<span style="color:#ba2121">&#34;Picture-in-Picture&#34;</span>] sticky enable<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [window_role=<span style="color:#ba2121">&#34;GtkFileChooserDialog&#34;</span>] resize set width <span style="color:#666">1000</span> px height <span style="color:#666">800</span> px<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [window_role=<span style="color:#ba2121">&#34;GtkFileChooserDialog&#34;</span>] move position center<span style="">
</span></span></span></code></pre></div><h3 id="scratchpad">Scratchpad</h3>
<p>Scratch terminal, inspired by <a href="https://www.youtube.com/watch?v=q-l7DnDbiiU">this Luke Smith&rsquo;s video</a>.</p>
<h4 id="launch-script">Launch script</h4>
<p>First of all, we have to distinguish a scratchpad terminal from a normal one. To do that, one can create st with a required classname.</p>
<p>Then, it would be cool not to duplicate scratchpads, so the following script first looks for a window with a created classname. If it exists, the script just toggles the scratchpad visibility. Otherwise, a new instance of a window is created.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#19177c">CLASSNAME</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;dropdown_tmux&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">COMMAND</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;alacritty --class </span><span style="color:#19177c">$CLASSNAME</span><span style="color:#ba2121"> -e tmux new-session -s </span><span style="color:#19177c">$CLASSNAME</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">pid</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>xdotool search --classname <span style="color:#ba2121">&#34;dropdown_tmux&#34;</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[[</span> ! -z <span style="color:#19177c">$pid</span>  <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    i3-msg scratchpad show
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    setsid -f <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">COMMAND</span><span style="color:#b68;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><h4 id="i3-config">i3 config</h4>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span># Scratchpad<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [instance=<span style="color:#ba2121">&#34;dropdown_*&#34;</span>] floating enable<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [instance=<span style="color:#ba2121">&#34;dropdown_*&#34;</span>] move scratchpad<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [instance=<span style="color:#ba2121">&#34;dropdown_*&#34;</span>] sticky enable<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [instance=<span style="color:#ba2121">&#34;dropdown_*&#34;</span>] scratchpad show<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>for_window [instance=<span style="color:#ba2121">&#34;dropdown_*&#34;</span>] move position center<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+u exec ~<span style="color:#b68">/bin/</span>scripts/dropdown<span style="">
</span></span></span></code></pre></div><h3 id="gaps-and-borders">Gaps &amp; borders</h3>
<p>The main reason to use i3-gaps</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span># Borders<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># for_window [class=<span style="color:#ba2121">&#34;.*&#34;</span>] border pixel <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>default_border pixel <span style="color:#666">3</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>hide_edge_borders both<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Gaps<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set $default_inner <span style="color:#666">10</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set $default_outer <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>gaps inner $default_inner<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>gaps outer $default_outer<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>smart_gaps on<span style="">
</span></span></span></code></pre></div><h4 id="keybindings-1">Keybindings</h4>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>mode <span style="color:#ba2121">&#34;inner gaps&#34;</span> {<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym plus gaps inner current plus <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym minus gaps inner current minus <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+plus gaps inner all plus <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+minus gaps inner all minus <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym <span style="color:#666">0</span> gaps inner current set <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+<span style="color:#666">0</span> gaps inner all set <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym r gaps inner current set $default_inner<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+r gaps inner all set $default_inner<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Return mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Escape mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>}<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>mode <span style="color:#ba2121">&#34;outer gaps&#34;</span> {<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym plus gaps outer current plus <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym minus gaps outer current minus <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+plus gaps outer all plus <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+minus gaps outer all minus <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym <span style="color:#666">0</span> gaps outer current set <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+<span style="color:#666">0</span> gaps outer all set <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym r gaps outer current set $default_outer<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+r gaps outer all set $default_outer<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Return mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Escape mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>}<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+g mode <span style="color:#ba2121">&#34;inner gaps&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+g mode <span style="color:#ba2121">&#34;outer gaps&#34;</span><span style="">
</span></span></span></code></pre></div><h3 id="move-and-resize-windows">Move &amp; resize windows</h3>
<table>
<thead>
<tr>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>python-i3-balance-workspace</td>
</tr>
</tbody>
</table>
<p>A more or less standard set of keybindings to move &amp; resize floating windows. Just be careful to always make a way to return from these new modes, otherwise you&rsquo;d end up in a rather precarious situation.</p>
<p><a href="https://github.com/atreyasha/i3-balance-workspace">i3-balance-workspace</a> is a small Python package to balance the i3 windows, but for the Emacs integration I also want this button to balance the Emacs windows, so here is a small script to do just that.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[[</span> <span style="color:#008000;font-weight:bold">$(</span>xdotool getactivewindow getwindowname<span style="color:#008000;font-weight:bold">)</span> <span style="color:#666">=</span>~ ^emacs<span style="color:#666">(</span>:.*<span style="color:#666">)</span>?@.* <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    emacsclient -e <span style="color:#ba2121">&#34;(balance-windows)&#34;</span> &amp;
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>i3_balance_workspace
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>mode <span style="color:#ba2121">&#34;resize&#34;</span> {<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym h exec emacs-i3-integration resize shrink width <span style="color:#666">10</span> px or <span style="color:#666">10</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym j exec emacs-i3-integration resize grow height <span style="color:#666">10</span> px or <span style="color:#666">10</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym k exec emacs-i3-integration resize shrink height <span style="color:#666">10</span> px or <span style="color:#666">10</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym l exec emacs-i3-integration resize grow width <span style="color:#666">10</span> px or <span style="color:#666">10</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+h exec emacs-i3-integration resize shrink width <span style="color:#666">100</span> px or <span style="color:#666">100</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+j exec emacs-i3-integration resize grow height <span style="color:#666">100</span> px or <span style="color:#666">100</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+k exec emacs-i3-integration resize shrink height <span style="color:#666">100</span> px or <span style="color:#666">100</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+l exec emacs-i3-integration resize grow width <span style="color:#666">100</span> px or <span style="color:#666">100</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # same bindings, but for the arrow keys<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Left  exec emacs-i3-integration resize shrink width <span style="color:#666">10</span> px or <span style="color:#666">10</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Down  exec emacs-i3-integration resize grow height <span style="color:#666">10</span> px or <span style="color:#666">10</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Up    exec emacs-i3-integration resize shrink height <span style="color:#666">10</span> px or <span style="color:#666">10</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Right exec emacs-i3-integration resize grow width <span style="color:#666">10</span> px or <span style="color:#666">10</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+Left  exec emacs-i3-integration resize shrink width <span style="color:#666">100</span> px or <span style="color:#666">100</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+Down  exec emacs-i3-integration resize grow height <span style="color:#666">100</span> px or <span style="color:#666">100</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+Up    exec emacs-i3-integration resize shrink height <span style="color:#666">100</span> px or <span style="color:#666">100</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Shift+Right exec emacs-i3-integration resize grow width <span style="color:#666">100</span> px or <span style="color:#666">100</span> ppt<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym equal exec i3-emacs-balance-windows<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # back to normal: Enter or Escape<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Return mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Escape mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>}<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+r mode <span style="color:#ba2121">&#34;resize&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>mode <span style="color:#ba2121">&#34;move&#34;</span> {<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym $mod+Tab focus right<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Left  move left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Down  move down<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Up    move up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Right move right<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym h     move left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym j     move down<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym k     move up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym l     move right<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # back to normal: Enter or Escape<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Return mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Escape mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>}<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+m mode <span style="color:#ba2121">&#34;move&#34;</span> focus floating<span style="">
</span></span></span></code></pre></div><h3 id="off--intergration-with-dmenu"><span class="org-todo done OFF">OFF</span> (OFF) Intergration with dmenu</h3>
<p><a href="https://tools.suckless.org/dmenu/">dmenu</a> is a dynamic menu program for X. I&rsquo;ve opted out of using it in favour of rofi, but here is a relevant bit of config.</p>
<p>Scripts are located in the <code>bin/scripts</code> folder.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span># dmenu<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+d exec i3-dmenu-desktop --dmenu=<span style="color:#ba2121">&#34;dmenu -l 10&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+apostrophe mode <span style="color:#ba2121">&#34;dmenu&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>mode <span style="color:#ba2121">&#34;dmenu&#34;</span> {<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym d exec i3-dmenu-desktop --dmenu=<span style="color:#ba2121">&#34;dmenu -l 10&#34;</span>; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym p exec dmenu_run -l <span style="color:#666">10</span>; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym m exec dmenu-man; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym b exec dmenu-buku; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym f exec dmenu-explore; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym t exec dmenu-tmuxp; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Escape mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>}<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+b exec --no-startup-id dmenu-buku<span style="">
</span></span></span></code></pre></div><h3 id="integration-with-rofi">Integration with rofi</h3>
<p>Keybindings to launch <a href="https://github.com/davatorium/rofi">rofi</a>. For more detail, look the <a href="#rofi">Rofi</a> section.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bindsym $mod+p exec <span style="color:#ba2121">&#34;rofi -modi &#39;drun,run&#39; -show drun&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+b exec --no-startup-id rofi-buku-mine<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+minus exec rofi-pass<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+equal exec rofimoji<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+apostrophe mode <span style="color:#ba2121">&#34;rofi&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>mode <span style="color:#ba2121">&#34;rofi&#34;</span> {<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym d exec <span style="color:#ba2121">&#34;rofi -modi &#39;drun,run&#39; -show drun&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym m exec rofi-man; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym b exec rofi-buku-mine; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym k exec rofi-pass; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Escape mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>}<span style="">
</span></span></span></code></pre></div><h3 id="launching-apps-and-misc-keybindings">Launching apps &amp; misc keybindings</h3>
<p>I prefer to use a separate mode to launch most of my apps, with some exceptions.</p>
<h4 id="apps">Apps</h4>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span># Launch apps<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># start a terminal at workspace <span style="color:#666">1</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Return exec <span style="color:#ba2121">&#34;i3-msg &#39;workspace 1 🚀; exec alacritty&#39;&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+i exec <span style="color:#ba2121">&#34;copyq menu&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+Shift+x exec <span style="color:#ba2121">&#34;i3lock -f -i /home/pavel/Pictures/lock-wallpaper.png&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+semicolon mode <span style="color:#ba2121">&#34;apps&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>mode <span style="color:#ba2121">&#34;apps&#34;</span> {<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym Escape mode <span style="color:#ba2121">&#34;default&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym b exec firefox; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym v exec vk; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym s exec slack-wrapper; mode default;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym d exec <span style="color:#ba2121">&#34;flatpak run com.discordapp.Discord&#34;</span>; mode default;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym m exec <span style="color:#ba2121">&#34;alacritty -e ncmpcpp&#34;</span>; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym c exec <span style="color:#ba2121">&#34;copyq toggle&#34;</span>; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym k exec <span style="color:#ba2121">&#34;keepassxc&#34;</span>; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # bindsym e exec mailspring; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym a exec emacs; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym n exec <span style="color:#ba2121">&#34;alacritty -e newsboat&#34;</span>; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    bindsym w exec <span style="color:#ba2121">&#34;alacritty /home/pavel/bin/scripts/run_wego&#34;</span>; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # bindsym a exec emacsclient -c; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # bindsym Shift+a exec emacs; mode default<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>}<span style="">
</span></span></span></code></pre></div><h4 id="media-controls-and-brightness">Media controls &amp; brightness</h4>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span># Pulse Audio controls<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym XF86AudioRaiseVolume exec --no-startup-id <span style="color:#ba2121">&#34;ponymix increase 5 --max-volume 150&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym XF86AudioLowerVolume exec --no-startup-id <span style="color:#ba2121">&#34;ponymix decrease 5 --max-volume 150&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym XF86AudioMute exec --no-startup-id <span style="color:#ba2121">&#34;ponymix toggle&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec --no-startup-id xmodmap -e <span style="color:#ba2121">&#39;keycode 135 = Super_R&#39;</span> &amp;&amp; xset -r <span style="color:#666">135</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+F2 exec --no-startup-id <span style="color:#ba2121">&#34;ponymix increase 5&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+F3 exec --no-startup-id <span style="color:#ba2121">&#34;ponymix decrease 5&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Media player controls<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym XF86AudioPlay exec mpc toggle<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym XF86AudioPause exec mpc pause<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym XF86AudioNext exec mpc next<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym XF86AudioPrev exec mpc prev<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Screen brightness<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym XF86MonBrightnessUp exec <span style="color:#008000">light</span> -A <span style="color:#666">5</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym XF86MonBrightnessDown exec <span style="color:#008000">light</span> -U <span style="color:#666">5</span><span style="">
</span></span></span></code></pre></div><h4 id="screenshots">Screenshots</h4>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span># Screenshots<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym --release Print exec <span style="color:#ba2121">&#34;flameshot gui&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym --release Shift+Print exec <span style="color:#ba2121">&#34;xfce4-screenshooter&#34;</span><span style="">
</span></span></span></code></pre></div><h3 id="colors-1">Colors</h3>
<p>Application of the XResources theme to the WM.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>exec xrdb -merge $HOME/.Xresources<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Colors<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set_from_resource $bg-color            background<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set_from_resource $active-color        color4<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set_from_resource $inactive-bg-color   color8<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set_from_resource $text-color          foreground<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set_from_resource $inactive-text-color color7<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set_from_resource $urgent-bg-color     color1<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set_from_resource $urgent-text-color   color0<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># window colors<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>#                       border              background         text                 indicator       child border<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>client.focused          $active-color       $bg-color          $text-color          $bg-color       $active-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>client.unfocused        $bg-color           $inactive-bg-color $inactive-text-color $bg-color       $bg-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>client.focused_inactive $active-color       $inactive-bg-color $inactive-text-color $bg-color       $bg-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>client.urgent           $urgent-bg-color    $urgent-bg-color   $urgent-text-color   $bg-color       $urgent-bg-color<span style="">
</span></span></span></code></pre></div><h3 id="off--i3blocks"><span class="org-todo done OFF">OFF</span> (OFF) i3blocks</h3>
<p>I&rsquo;ve opted out of i3bar &amp; <a href="https://github.com/vivien/i3blocks">i3blocks</a> for <a href="https://github.com/polybar/polybar">polybar</a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>bar {<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    status_command i3blocks -c ~<span style="color:#b68">/.config/</span>i3/i3blocks.conf<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    i3bar_command i3bar<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    font pango:monospace <span style="color:#666">12</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    output HDMI-A<span style="color:#666">-0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    tray_output none<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    colors {<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	background $bg-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	separator <span style="color:#666">#757575</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	#                  border             background         text<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	focused_workspace  $bg-color          $bg-color          $text-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	inactive_workspace $inactive-bg-color $inactive-bg-color $inactive-text-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	urgent_workspace   $urgent-bg-color   $urgent-bg-color   $urgent-text-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    }<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>}<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bar {<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    status_command i3blocks -c ~<span style="color:#b68">/.config/</span>i3/i3blocks.conf<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    i3bar_command i3bar<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    font pango:monospace <span style="color:#666">10</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    output DVI-D<span style="color:#666">-0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    colors {<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	background $bg-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	separator <span style="color:#666">#757575</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	#                  border             background         text<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	focused_workspace  $bg-color          $bg-color          $text-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	inactive_workspace $inactive-bg-color $inactive-bg-color $inactive-text-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>	urgent_workspace   $urgent-bg-color   $urgent-bg-color   $urgent-text-color<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    }<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>}<span style="">
</span></span></span></code></pre></div><h3 id="keyboard-layout">Keyboard Layout</h3>
<p>A script to set Russian-English keyboard layout:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>setxkbmap -layout us,ru
</span></span><span style="display:flex;"><span>setxkbmap -model pc105 -option <span style="color:#ba2121">&#39;grp:win_space_toggle&#39;</span> -option <span style="color:#ba2121">&#39;grp:alt_shift_toggle&#39;</span>
</span></span></code></pre></div><p>A script to toggle the layout</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> setxkbmap -query | grep -q us,ru; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    setxkbmap -layout us
</span></span><span style="display:flex;"><span>    setxkbmap -option
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    setxkbmap -layout us,ru
</span></span><span style="display:flex;"><span>    setxkbmap -model pc105 -option <span style="color:#ba2121">&#39;grp:win_space_toggle&#39;</span> -option <span style="color:#ba2121">&#39;grp:alt_shift_toggle&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><p>And the relevant i3 settings:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span># Layout<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec_always --no-startup-id set_layout<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>bindsym $mod+slash exec toggle_layout<span style="">
</span></span></span></code></pre></div><h3 id="autostart">Autostart</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span># Polybar<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec_always --no-startup-id <span style="color:#ba2121">&#34;bash /home/pavel/bin/polybar.sh&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Wallpaper<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec_always <span style="color:#ba2121">&#34;feh --bg-fill ~/Pictures/wallpaper.jpg&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Picom<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec picom<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Keynav<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec keynav<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Applets<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec --no-startup-id nm-applet<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># exec --no-startup-id <span style="color:#b68">/usr/</span>bin/blueman-applet<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec shepherd<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec dunst<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec copyq<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>exec <span style="color:#ba2121">&#34;xmodmap ~/.Xmodmap&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># exec <span style="color:#ba2121">&#34;xrdb -merge ~/.Xresources&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># exec <span style="color:#ba2121">&#34;bash ~/bin/autostart.sh&#34;</span><span style="">
</span></span></span></code></pre></div><h2 id="polybar">Polybar</h2>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>desktop-polybar</td>
<td>polybar</td>
<td>statusbar</td>
</tr>
</tbody>
</table>
<p><a href="https://github.com/polybar/polybar">Polybar</a> is a nice-looking, WM-agnostic statusbar program.</p>
<p><del>I switched to polybar because I wanted to try out some WMs other than i3, but decided to stick with i3 for now.</del> Still using polybar with EXWM and pretty happy with it.</p>
<p>Don&rsquo;t forget to install the Google Noto Color Emoji font. Guix package with all Noto fonts is way too large.</p>
<p>References:</p>
<ul>
<li><a href="https://github.com/polybar/polybar/wiki">polybar docs</a></li>
</ul>
<h3 id="general-settings-1">General settings</h3>
<p>In relation to literate configuration, this is the most <del>crazy</del> advanced case of the former so far in my config.</p>
<p>My polybar has:</p>
<ul>
<li>colors from the general color theme;</li>
<li>powerline-ish decorations between modules.</li>
</ul>
<h4 id="colors-2">Colors</h4>
<p>The &ldquo;colors&rdquo; part is straightforward enough. Polybar can use <code>Xresources</code>, so we just need to generate the appropriate bindings of Xresources to the polybar variables:</p>
<p><a id="code-snippet--get-polybar-colors"></a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#00f">mapconcat</span>
</span></span><span style="display:flex;"><span> (<span style="color:#008000">lambda</span> (<span style="color:#19177c">elem</span>)
</span></span><span style="display:flex;"><span>   (<span style="color:#00f">format</span> <span style="color:#ba2121">&#34;%s = ${xrdb:%s}&#34;</span> (<span style="color:#00f">nth</span> <span style="color:#666">0</span> <span style="color:#19177c">elem</span>) (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">elem</span>)))
</span></span><span style="display:flex;"><span> (<span style="color:#19177c">seq-filter</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">lambda</span> (<span style="color:#19177c">elem</span>) (<span style="color:#19177c">when-let</span> (<span style="color:#19177c">name</span> (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">elem</span>))
</span></span><span style="display:flex;"><span>		   (<span style="color:#19177c">not</span> (<span style="color:#19177c">string-empty-p</span> <span style="color:#19177c">name</span>))))
</span></span><span style="display:flex;"><span>  <span style="color:#19177c">table</span>)
</span></span><span style="display:flex;"><span> <span style="color:#ba2121">&#34;\n&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[colors]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">&lt;&lt;get-polybar-colors()&gt;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">background</span> <span style="color:#666">=</span> <span style="color:#ba2121">${xrdb:background}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; foreground = ${xrdb:foreground}</span>
</span></span></code></pre></div><h4 id="glyph-settings">Glyph settings</h4>
<p>As for the module decorations though, I find it ironic that with all this fancy rendering around I have to resort to Unicode glyphs.</p>
<p>Anyhow, the approach is to put a glyph between two blocks like this:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>block1  block2
</span></span></code></pre></div><p>And set the foreground and background colors like that:</p>
<table>
<thead>
<tr>
<th></th>
<th>block1</th>
<th>glyph</th>
<th>block2</th>
</tr>
</thead>
<tbody>
<tr>
<td>foreground</td>
<td>F1</td>
<td>B2</td>
<td>F2</td>
</tr>
<tr>
<td>background</td>
<td>B1</td>
<td>B1</td>
<td>B2</td>
</tr>
</tbody>
</table>
<p>So, that&rsquo;s a start. First, let&rsquo;s define the glyph symbols in the polybar config:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[glyph]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">gleft</span> <span style="color:#666">=</span> <span style="color:#ba2121"></span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">gright</span> <span style="color:#666">=</span> <span style="color:#ba2121"></span>
</span></span></code></pre></div><h4 id="defining-modules">Defining modules</h4>
<p>As we want to interweave polybar modules with these glyphs in the right order and with the right colors, it is reasonable to define a single source of truth:</p>
<p><a id="table--polybar-modules"></a></p>
<table>
<thead>
<tr>
<th>Index</th>
<th>Module</th>
<th>Color</th>
<th>Glyph</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>pulseaudio</td>
<td>light-magenta</td>
<td>+</td>
</tr>
<tr>
<td>2</td>
<td>mpd</td>
<td>magenta</td>
<td>+</td>
</tr>
<tr>
<td>9</td>
<td>battery</td>
<td>light-cyan</td>
<td>+</td>
</tr>
<tr>
<td>3</td>
<td>cpu</td>
<td>cyan</td>
<td>+</td>
</tr>
<tr>
<td>4</td>
<td>ram-memory</td>
<td>light-green</td>
<td>+</td>
</tr>
<tr>
<td>5</td>
<td>swap-memory</td>
<td>green</td>
<td>+</td>
</tr>
<tr>
<td>6</td>
<td>bandwidth</td>
<td>light-red</td>
<td>+</td>
</tr>
<tr>
<td>7</td>
<td>openvpn</td>
<td>light-red</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>xkeyboard</td>
<td>red</td>
<td>+</td>
</tr>
<tr>
<td>10</td>
<td>weather</td>
<td>light-yellow</td>
<td>+</td>
</tr>
<tr>
<td>12</td>
<td>sun</td>
<td>yellow</td>
<td>+</td>
</tr>
<tr>
<td>13</td>
<td>aw-afk</td>
<td>light-blue</td>
<td>+</td>
</tr>
<tr>
<td>14</td>
<td>date</td>
<td>blue</td>
<td>+</td>
</tr>
</tbody>
</table>
<p>Also excluding some modules from certain monitors, which for now is about excluding <code>battery</code> from the monitors of my desktop PC:</p>
<p><a id="table--polybar-modules-exclude"></a></p>
<table>
<thead>
<tr>
<th>Monitor</th>
<th>Exclude</th>
</tr>
</thead>
<tbody>
<tr>
<td>DVI-D-0</td>
<td>battery</td>
</tr>
<tr>
<td>HDMI-A-0</td>
<td>battery</td>
</tr>
</tbody>
</table>
<p>Another thing we need to do is to set the color of modules in accordance with the <code>polybar_modules</code> table. The background can be determined from the <code>Color</code> column with the following code block:</p>
<p><a id="code-snippet--get-polybar-bg"></a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#00f">format</span>
</span></span><span style="display:flex;"><span> <span style="color:#ba2121">&#34;${colors.%s}&#34;</span>
</span></span><span style="display:flex;"><span> (<span style="color:#00f">nth</span>
</span></span><span style="display:flex;"><span>  <span style="color:#666">2</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#19177c">seq-find</span>
</span></span><span style="display:flex;"><span>   (<span style="color:#008000">lambda</span> (<span style="color:#19177c">el</span>) (<span style="color:#00f">string-equal</span> (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">el</span>) <span style="color:#19177c">module</span>))
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">table</span>)))
</span></span></code></pre></div><p>That block is meant to be invoked in each module definition.</p>
<h4 id="generating-glyphs">Generating glyphs</h4>
<p>To generate the required set of glyphs, we need a glyph for every possible combination of adjacent colors that can occur in polybar.</p>
<p>Most of these combinations can be inferred from the <code>polybar_modules</code> table, the rest are defined in another table:</p>
<p><a id="table--polybar-extra-colors"></a></p>
<table>
<thead>
<tr>
<th>Color 1</th>
<th>Color 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>background</td>
<td>white</td>
</tr>
<tr>
<td>background</td>
<td>light-magenta</td>
</tr>
<tr>
<td>blue</td>
<td>background</td>
</tr>
</tbody>
</table>
<p><a id="code-snippet--polybar-generate-glyphs"></a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">let*</span> ((<span style="color:#19177c">monitors</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">thread-last</span>
</span></span><span style="display:flex;"><span>	  <span style="color:#19177c">exclude-table</span>
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">seq-map</span> (<span style="color:#008000">lambda</span> (<span style="color:#19177c">el</span>) (<span style="color:#00f">nth</span> <span style="color:#666">0</span> <span style="color:#19177c">el</span>)))
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">seq-uniq</span>)))
</span></span><span style="display:flex;"><span>       (<span style="color:#19177c">exclude-combinations</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">seq-map</span>
</span></span><span style="display:flex;"><span>	 (<span style="color:#008000">lambda</span> (<span style="color:#19177c">monitor</span>)
</span></span><span style="display:flex;"><span>	   (<span style="color:#19177c">seq-map</span>
</span></span><span style="display:flex;"><span>	    (<span style="color:#008000">lambda</span> (<span style="color:#19177c">el</span>) (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">el</span>))
</span></span><span style="display:flex;"><span>	    (<span style="color:#19177c">seq-filter</span>
</span></span><span style="display:flex;"><span>	     (<span style="color:#008000">lambda</span> (<span style="color:#19177c">el</span>) (<span style="color:#008000">and</span> (<span style="color:#00f">string-equal</span> (<span style="color:#00f">nth</span> <span style="color:#666">0</span> <span style="color:#19177c">el</span>) <span style="color:#19177c">monitor</span>)
</span></span><span style="display:flex;"><span>			       (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">el</span>)))
</span></span><span style="display:flex;"><span>	     <span style="color:#19177c">exclude-table</span>)))
</span></span><span style="display:flex;"><span>	 <span style="color:#666">`</span>(<span style="color:#666">,@</span><span style="color:#19177c">monitors</span> <span style="color:#ba2121">&#34;&#34;</span>)))
</span></span><span style="display:flex;"><span>       (<span style="color:#19177c">module-glyph-combinations</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">thread-last</span>
</span></span><span style="display:flex;"><span>	  <span style="color:#19177c">exclude-combinations</span>
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">seq-map</span>
</span></span><span style="display:flex;"><span>	   (<span style="color:#008000">lambda</span> (<span style="color:#19177c">exclude</span>)
</span></span><span style="display:flex;"><span>	     (<span style="color:#19177c">thread-last</span>
</span></span><span style="display:flex;"><span>	       <span style="color:#19177c">table</span>
</span></span><span style="display:flex;"><span>	       (<span style="color:#19177c">seq-filter</span>
</span></span><span style="display:flex;"><span>		(<span style="color:#008000">lambda</span> (<span style="color:#00f">elt</span>)
</span></span><span style="display:flex;"><span>		  (<span style="color:#19177c">not</span> (<span style="color:#008000">or</span>
</span></span><span style="display:flex;"><span>			(<span style="color:#00f">member</span> (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#00f">elt</span>) <span style="color:#19177c">exclude</span>)
</span></span><span style="display:flex;"><span>			(<span style="color:#19177c">not</span> (<span style="color:#00f">string-equal</span> (<span style="color:#00f">nth</span> <span style="color:#666">3</span> <span style="color:#00f">elt</span>) <span style="color:#ba2121">&#34;+&#34;</span>)))))))))
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">seq-uniq</span>)))
</span></span><span style="display:flex;"><span>       (<span style="color:#19177c">color-changes</span> <span style="color:#800">nil</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">dolist</span> (<span style="color:#19177c">e</span> <span style="color:#19177c">extra</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#19177c">add-to-list</span>
</span></span><span style="display:flex;"><span>     <span style="color:#19177c">&#39;color-changes</span>
</span></span><span style="display:flex;"><span>     (<span style="color:#00f">concat</span> (<span style="color:#00f">nth</span> <span style="color:#666">0</span> <span style="color:#19177c">e</span>) <span style="color:#ba2121">&#34;--&#34;</span> (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">e</span>))))
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">dolist</span> (<span style="color:#19177c">comb</span> <span style="color:#19177c">module-glyph-combinations</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">dotimes</span> (<span style="color:#19177c">i</span> (<span style="color:#00f">1-</span> (<span style="color:#00f">length</span> <span style="color:#19177c">comb</span>)))
</span></span><span style="display:flex;"><span>      (<span style="color:#19177c">add-to-list</span>
</span></span><span style="display:flex;"><span>       <span style="color:#19177c">&#39;color-changes</span>
</span></span><span style="display:flex;"><span>       (<span style="color:#00f">concat</span> (<span style="color:#00f">nth</span> <span style="color:#666">2</span> (<span style="color:#00f">nth</span> <span style="color:#19177c">i</span> <span style="color:#19177c">comb</span>))
</span></span><span style="display:flex;"><span>	       <span style="color:#ba2121">&#34;--&#34;</span>
</span></span><span style="display:flex;"><span>	       (<span style="color:#00f">nth</span> <span style="color:#666">2</span> (<span style="color:#00f">nth</span> (<span style="color:#00f">1+</span> <span style="color:#19177c">i</span>) <span style="color:#19177c">comb</span>))))))
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">mapconcat</span>
</span></span><span style="display:flex;"><span>   (<span style="color:#008000">lambda</span> (<span style="color:#19177c">el</span>)
</span></span><span style="display:flex;"><span>     (<span style="color:#008000">let</span> ((<span style="color:#19177c">colors</span> (<span style="color:#19177c">split-string</span> <span style="color:#19177c">el</span> <span style="color:#ba2121">&#34;--&#34;</span>)))
</span></span><span style="display:flex;"><span>       (<span style="color:#00f">format</span> <span style="color:#ba2121">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">[module/glyph-%s--%s]
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">type = custom/text
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">content-background = ${colors.%s}
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">content-foreground = ${colors.%s}
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">content = ${glyph.gright}
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">content-font = 5&#34;</span>
</span></span><span style="display:flex;"><span>	       (<span style="color:#00f">nth</span> <span style="color:#666">0</span> <span style="color:#19177c">colors</span>)
</span></span><span style="display:flex;"><span>	       (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">colors</span>)
</span></span><span style="display:flex;"><span>	       (<span style="color:#00f">nth</span> <span style="color:#666">0</span> <span style="color:#19177c">colors</span>)
</span></span><span style="display:flex;"><span>	       (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">colors</span>))))
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">color-changes</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ba2121">&#34;\n&#34;</span>))
</span></span></code></pre></div><p>Here&rsquo;s a rough outline of how the code works:</p>
<ul>
<li><code>monitors</code> is a list of unique monitors in <code>exclude-table</code></li>
<li><code>exclude-combilnations</code> is a list of lists of module names to be excluded for each monitor</li>
<li><code>module-glyphs-combinations</code> is a list of lists of actual modules for each monitor</li>
<li><code>color-changes</code> is a list of unique adjacent colors across modules in all monitors</li>
</ul>
<p>Finally, <code>color-changes</code> is used to generate glyph modules that look like this:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/glyph-light-cyan--cyan]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">custom/text</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">content-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.light-cyan}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">content-foreground</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.cyan}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">content</span> <span style="color:#666">=</span> <span style="color:#ba2121">${glyph.gright}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">content-font</span> <span style="color:#666">=</span> <span style="color:#ba2121">5</span>
</span></span></code></pre></div><p>As of now, 15 of such modules is generated.</p>
<p>Include this to the polybar config itself:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#7d9029">&lt;&lt;polybar-generate-glyphs()&gt;&gt;</span>
</span></span></code></pre></div><h4 id="generating-set-of-modules">Generating set of modules</h4>
<p>To configure polybar itself, we need to generate a set of modules for each monitor.</p>
<p>The parameters here, excluding the two required tables, are:</p>
<ul>
<li><code>monitor</code> - the current monitor on which to filter out the blocks by the <code>polybar_modules_exclude</code> table,</li>
<li><code>first-color</code> - the first color of the first glyph,</li>
<li><code>last-color</code> - the second color of the last glyph.</li>
</ul>
<!--listend-->
<p><a id="code-snippet--polybar-generate-modules"></a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#008000">let*</span> ((<span style="color:#19177c">exclude-modules</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">thread-last</span>
</span></span><span style="display:flex;"><span>	  <span style="color:#19177c">exclude-table</span>
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">seq-filter</span> (<span style="color:#008000">lambda</span> (<span style="color:#19177c">el</span>) (<span style="color:#00f">string-equal</span> (<span style="color:#00f">nth</span> <span style="color:#666">0</span> <span style="color:#19177c">el</span>) <span style="color:#19177c">monitor</span>)))
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">seq-map</span> (<span style="color:#008000">lambda</span> (<span style="color:#19177c">el</span>) (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">el</span>)))))
</span></span><span style="display:flex;"><span>       (<span style="color:#19177c">modules</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#19177c">thread-last</span>
</span></span><span style="display:flex;"><span>	  <span style="color:#19177c">table</span>
</span></span><span style="display:flex;"><span>	  (<span style="color:#19177c">seq-filter</span> (<span style="color:#008000">lambda</span> (<span style="color:#19177c">el</span>) (<span style="color:#19177c">not</span> (<span style="color:#00f">member</span> (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">el</span>) <span style="color:#19177c">exclude-modules</span>))))))
</span></span><span style="display:flex;"><span>       (<span style="color:#19177c">prev-color</span> <span style="color:#19177c">first-color</span>)
</span></span><span style="display:flex;"><span>       (<span style="color:#19177c">ret</span> <span style="color:#800">nil</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">concat</span>
</span></span><span style="display:flex;"><span>   (<span style="color:#00f">mapconcat</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#008000">lambda</span> (<span style="color:#19177c">el</span>)
</span></span><span style="display:flex;"><span>      (<span style="color:#00f">apply</span>
</span></span><span style="display:flex;"><span>       <span style="color:#00f">#&#39;concat</span>
</span></span><span style="display:flex;"><span>       (<span style="color:#00f">list</span>
</span></span><span style="display:flex;"><span>	(<span style="color:#008000">when</span> (<span style="color:#00f">string-equal</span> (<span style="color:#00f">nth</span> <span style="color:#666">3</span> <span style="color:#19177c">el</span>) <span style="color:#ba2121">&#34;+&#34;</span>)
</span></span><span style="display:flex;"><span>	  (<span style="color:#008000">setq</span> <span style="color:#19177c">ret</span> (<span style="color:#00f">format</span> <span style="color:#ba2121">&#34;glyph-%s--%s &#34;</span> <span style="color:#19177c">prev-color</span> (<span style="color:#00f">nth</span> <span style="color:#666">2</span> <span style="color:#19177c">el</span>)))
</span></span><span style="display:flex;"><span>	  (<span style="color:#008000">setq</span> <span style="color:#19177c">prev-color</span> (<span style="color:#00f">nth</span> <span style="color:#666">2</span> <span style="color:#19177c">el</span>))
</span></span><span style="display:flex;"><span>	  <span style="color:#19177c">ret</span>)
</span></span><span style="display:flex;"><span>	(<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">el</span>))))
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">modules</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ba2121">&#34; &#34;</span>)
</span></span><span style="display:flex;"><span>   (<span style="color:#008000">unless</span> (<span style="color:#19177c">string-empty-p</span> <span style="color:#19177c">last-color</span>) (<span style="color:#00f">format</span> <span style="color:#ba2121">&#34; glyph-%s--%s &#34;</span> <span style="color:#19177c">prev-color</span> <span style="color:#19177c">last-color</span>))))
</span></span></code></pre></div><p>The polybar config doesn&rsquo;t support conditional statements, but it does support environment variables, so I pass the parameters from in the launch script.</p>
<h4 id="global-bar-config">Global bar config</h4>
<p>Global bar configuration.</p>
<p>Monitor config and base colors.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[bar/mybar]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">monitor</span> <span style="color:#666">=</span> <span style="color:#ba2121">${env:MONITOR:}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">width</span> <span style="color:#666">=</span> <span style="color:#ba2121">100%</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">height</span> <span style="color:#666">=</span> <span style="color:#ba2121">${env:HEIGHT:27}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">fixed-center</span> <span style="color:#666">=</span> <span style="color:#ba2121">false</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">bottom</span><span style="color:#666">=</span><span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">background</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.background}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">foreground</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.black}</span>
</span></span></code></pre></div><p>Some geometry settings. These are set this way to make glyphs look the way they should</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; line-size = 3</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">line-color</span> <span style="color:#666">=</span> <span style="color:#ba2121">#f00</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">padding</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">module-margin-left</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">module-margin-right</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">margin-bottom</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">margin-top</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; underline-size = 0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">border-size</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">offset-x</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">offset-y</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">radius</span> <span style="color:#666">=</span> <span style="color:#ba2121">0.0</span>
</span></span></code></pre></div><p>Fonts</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; font-0 = ${env:FONT0:pango:monospace:size=10;1}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; font-1 = ${env:FONT1:NotoEmoji:scale=10:antialias=false;0}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; font-2 = ${env:FONT2:fontawesome:pixelsize=10;1}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; font-3 = ${env:FONT3:JetBrains Mono Nerd Font:monospace:size=10;1}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">font-0</span> <span style="color:#666">=</span> <span style="color:#ba2121">pango:monospace:size=13;2</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">font-1</span> <span style="color:#666">=</span> <span style="color:#ba2121">NotoEmoji:scale=10:antialias=false;1</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">font-2</span> <span style="color:#666">=</span> <span style="color:#ba2121">fontawesome:pixelsize=13;3</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">font-3</span> <span style="color:#666">=</span> <span style="color:#ba2121">JetBrains Mono Nerd Font:monospace:size=13;4</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">font-4</span> <span style="color:#666">=</span> <span style="color:#ba2121">JetBrains Mono Nerd Font:monospace:size=17;4</span>
</span></span></code></pre></div><p>Modules. Because I sometimes set up different blocks on different monitors, they are set via environment variables.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#7d9029">modules-left</span> <span style="color:#666">=</span> <span style="color:#ba2121">i3</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; modules-center = test</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">modules-right</span> <span style="color:#666">=</span> <span style="color:#ba2121">${env:RIGHT_BLOCKS}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">tray-position</span> <span style="color:#666">=</span> <span style="color:#ba2121">${env:TRAY:right}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">tray-padding</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">tray-maxsize</span> <span style="color:#666">=</span> <span style="color:#ba2121">16</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">tray-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.background}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">wm-restack</span> <span style="color:#666">=</span> <span style="color:#ba2121">i3</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; override-redirect = true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">scroll-up</span> <span style="color:#666">=</span> <span style="color:#ba2121">i3wm-wsnext</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">scroll-down</span> <span style="color:#666">=</span> <span style="color:#ba2121">i3wm-wsprev</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; cursor-click = pointer</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; cursor-scroll = ns-resize</span>
</span></span></code></pre></div><p>Misc settings.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[settings]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">screenchange-reload</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">compositing-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">source</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">compositing-foreground</span> <span style="color:#666">=</span> <span style="color:#ba2121">over</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">compositing-overline</span> <span style="color:#666">=</span> <span style="color:#ba2121">over</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">compositing-underline</span> <span style="color:#666">=</span> <span style="color:#ba2121">over</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">compositing-border</span> <span style="color:#666">=</span> <span style="color:#ba2121">over</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[global/wm]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">margin-top</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">margin-bottom</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span></code></pre></div><h4 id="launch-script-1">Launch script</h4>
<p>The script below allows me to:</p>
<ul>
<li>have different blocks on my two different-sized monitors and my laptop;</li>
<li>have different settings on my desktop PC and laptop;</li>
</ul>
<!--listend-->
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#19177c">hostname</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>hostname<span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Settings varying on the hostname</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$hostname</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34;azure&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">TRAY_MONITOR</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;eDP-1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">elif</span> <span style="color:#666">[</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$hostname</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34;eminence&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">TRAY_MONITOR</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;eDP&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">TRAY_MONITOR</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;HDMI-A-0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Setting varying on the monitor</span>
</span></span><span style="display:flex;"><span><span style="color:#008000">declare</span> -A <span style="color:#19177c">FONT_SIZES</span><span style="color:#666">=(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;eDP&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;13&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;eDP-1&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;13&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;DVI-D-0&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;13&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;HDMI-A-0&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;13&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#666">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000">declare</span> -A <span style="color:#19177c">EMOJI_SCALE</span><span style="color:#666">=(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;eDP&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;9&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;eDP-1&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;9&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;DVI-D-0&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;10&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;HDMI-A-0&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;10&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#666">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000">declare</span> -A <span style="color:#19177c">BAR_HEIGHT</span><span style="color:#666">=(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;eDP&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;29&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;eDP-1&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;29&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;DVI-D-0&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;29&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;HDMI-A-0&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;29&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#666">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000">declare</span> -A <span style="color:#19177c">BLOCKS</span><span style="color:#666">=(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;eDP&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;&lt;&lt;polybar-generate-modules(monitor=&#34;</span>eDP<span style="color:#ba2121">&#34;)&gt;&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;eDP-1&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;&lt;&lt;polybar-generate-modules(monitor=&#34;</span>eDP-1<span style="color:#ba2121">&#34;)&gt;&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;DVI-D-0&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;&lt;&lt;polybar-generate-modules(monitor=&#34;</span>DVI-D-0<span style="color:#ba2121">&#34;)&gt;&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;HDMI-A-0&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;&lt;&lt;polybar-generate-modules(monitor=&#34;</span>HDMI-A-0<span style="color:#ba2121">&#34;)&gt;&gt;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#666">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Geolocation for some modules</span>
</span></span><span style="display:flex;"><span><span style="color:#008000">export</span> <span style="color:#19177c">LOC</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;SPB&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># export IPSTACK_API_KEY=$(pass show My_Online/APIs/ipstack | head -n 1)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pkill polybar
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">for</span> m in <span style="color:#008000;font-weight:bold">$(</span>xrandr --query | grep <span style="color:#ba2121">&#34; connected&#34;</span> | cut -d<span style="color:#ba2121">&#34; &#34;</span> -f1<span style="color:#008000;font-weight:bold">)</span>; <span style="color:#008000;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">export</span> <span style="color:#19177c">MONITOR</span><span style="color:#666">=</span><span style="color:#19177c">$m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$MONITOR</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$TRAY_MONITOR</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>	<span style="color:#008000">export</span> <span style="color:#19177c">TRAY</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;right&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>	<span style="color:#008000">export</span> <span style="color:#19177c">TRAY</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;none&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">SIZE</span><span style="color:#666">=</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">FONT_SIZES</span>[<span style="color:#19177c">$MONITOR</span>]<span style="color:#b68;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">SCALE</span><span style="color:#666">=</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">EMOJI_SCALE</span>[<span style="color:#19177c">$MONITOR</span>]<span style="color:#b68;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[[</span> -z <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$SCALE</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>	<span style="color:#008000;font-weight:bold">continue</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic"># export FONT0=&#34;pango:monospace:size=$SIZE;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic"># export FONT1=&#34;NotoEmoji:scale=$SCALE:antialias=false;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic"># export FONT2=&#34;fontawesome:pixelsize=$SIZE;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic"># export FONT3=&#34;JetBrains Mono Nerd Font:monospace:size=15;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">export</span> <span style="color:#19177c">HEIGHT</span><span style="color:#666">=</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">BAR_HEIGHT</span>[<span style="color:#19177c">$MONITOR</span>]<span style="color:#b68;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">export</span> <span style="color:#19177c">RIGHT_BLOCKS</span><span style="color:#666">=</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">BLOCKS</span>[<span style="color:#19177c">$MONITOR</span>]<span style="color:#b68;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    polybar mybar &amp;
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">done</span>
</span></span></code></pre></div><h3 id="individual-modules">Individual modules</h3>
<p>Some of the custom modules below use Org mode noweb to evaluate colors, because it&rsquo;s faster than querying <code>xrdb</code> at runtime. I wish I could reference polybar values there, but <a href="https://github.com/polybar/polybar/issues/615">it looks like this is impossible</a>.</p>
<p>If you want to copy something, you can go to the <a href="bin/polybar/">bin/polybar</a> folder.</p>
<h4 id="pulseaudio">pulseaudio</h4>
<p>PulseAudio status</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/pulseaudio]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">internal/pulseaudio</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">use-ui-max</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">bar-volume-width</span> <span style="color:#666">=</span> <span style="color:#ba2121">7</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; bar-volume-foreground-0 = ${colors.white}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; bar-volume-foreground-1 = ${colors.yellow}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; bar-volume-foreground-2 = ${colors.yellow}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; bar-volume-foreground-3 = ${colors.blue}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; bar-volume-foreground-4 = ${colors.blue}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; bar-volume-foreground-5 = ${colors.green}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; bar-volume-foreground-6 = ${colors.green}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">bar-volume-gradient</span> <span style="color:#666">=</span> <span style="color:#ba2121">false</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">bar-volume-indicator</span> <span style="color:#666">=</span> <span style="color:#ba2121">|</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">bar-volume-indicator-font</span> <span style="color:#666">=</span> <span style="color:#ba2121">2</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">bar-volume-fill</span> <span style="color:#666">=</span> <span style="color:#ba2121">─</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">bar-volume-fill-font</span> <span style="color:#666">=</span> <span style="color:#ba2121">2</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">bar-volume-empty</span> <span style="color:#666">=</span> <span style="color:#ba2121">─</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">bar-volume-empty-font</span> <span style="color:#666">=</span> <span style="color:#ba2121">2</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; bar-volume-empty-foreground = ${colors.light-white}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-volume</span> <span style="color:#666">=</span> <span style="color:#ba2121">♪ &lt;ramp-volume&gt; &lt;label-volume&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-volume</span> <span style="color:#666">=</span> <span style="color:#ba2121">%percentage%%</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-volume-0</span> <span style="color:#666">=</span> <span style="color:#ba2121">▁</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-volume-1</span> <span style="color:#666">=</span> <span style="color:#ba2121">▂</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-volume-2</span> <span style="color:#666">=</span> <span style="color:#ba2121">▃</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-volume-3</span> <span style="color:#666">=</span> <span style="color:#ba2121">▄</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-volume-4</span> <span style="color:#666">=</span> <span style="color:#ba2121">▅</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-volume-5</span> <span style="color:#666">=</span> <span style="color:#ba2121">▆</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-volume-6</span> <span style="color:#666">=</span> <span style="color:#ba2121">▇</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-volume-7</span> <span style="color:#666">=</span> <span style="color:#ba2121">█</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-muted</span> <span style="color:#666">=</span> <span style="color:#ba2121">♪ &lt;label-muted&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-muted</span> <span style="color:#666">=</span> <span style="color:#ba2121">MUTE</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-volume-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;pulseaudio&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-muted-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;pulseaudio&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-volume-underline = ${colors.white}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-muted-underline = ${colors.light-black}</span>
</span></span></code></pre></div><h4 id="mpd">mpd</h4>
<p><a href="https://www.musicpd.org/">Music Player Daemon</a> status</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/mpd]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">internal/mpd</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-playing</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;toggle&gt; &lt;label-time&gt; &lt;label-song&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-paused</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;toggle&gt; &lt;label-time&gt; &lt;label-song&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-stopped</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34; &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-song</span> <span style="color:#666">=</span> <span style="color:#ba2121">[%album-artist%] %title%</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-time</span> <span style="color:#666">=</span> <span style="color:#ba2121">%elapsed%/%total%</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-song-maxlen</span> <span style="color:#666">=</span> <span style="color:#ba2121">30</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-song-ellipsis</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-playing-underline = ${colors.yellow}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-paused-underline = ${colors.yellow}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-stopped-underline = ${colors.yellow}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-playing-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;mpd&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-paused-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;mpd&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-stopped-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;mpd&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-separator</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">separator-foreground</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.red}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">icon-pause</span> <span style="color:#666">=</span> <span style="color:#ba2121"></span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">icon-play</span> <span style="color:#666">=</span> <span style="color:#ba2121"></span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">icon-stop</span> <span style="color:#666">=</span> <span style="color:#ba2121"></span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">icon-prev</span> <span style="color:#666">=</span> <span style="color:#ba2121">1</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">icon-next</span> <span style="color:#666">=</span> <span style="color:#ba2121">2</span>
</span></span></code></pre></div><h4 id="cpu">cpu</h4>
<p>CPU usage</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/cpu]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">internal/cpu</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34; &lt;label&gt;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label</span> <span style="color:#666">=</span> <span style="color:#ba2121">%percentage%%</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;cpu&#34;)&gt;&gt;</span>
</span></span></code></pre></div><h4 id="ram-memory">ram-memory</h4>
<p>RAM usage</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/ram-memory]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">internal/memory</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-used-0</span> <span style="color:#666">=</span> <span style="color:#ba2121">▁</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-used-1</span> <span style="color:#666">=</span> <span style="color:#ba2121">▂</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-used-2</span> <span style="color:#666">=</span> <span style="color:#ba2121">▃</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-used-3</span> <span style="color:#666">=</span> <span style="color:#ba2121">▄</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-used-4</span> <span style="color:#666">=</span> <span style="color:#ba2121">▅</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-used-5</span> <span style="color:#666">=</span> <span style="color:#ba2121">▆</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-used-6</span> <span style="color:#666">=</span> <span style="color:#ba2121">▇</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-used-7</span> <span style="color:#666">=</span> <span style="color:#ba2121">█</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format</span> <span style="color:#666">=</span> <span style="color:#ba2121"> &lt;label&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label</span><span style="color:#666">=</span><span style="color:#ba2121">%gb_used:.1f%</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-underline = ${colors.blue}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;ram-memory&#34;)&gt;&gt;</span>
</span></span></code></pre></div><h4 id="swap-memory">swap-memory</h4>
<p>Swap usage</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/swap-memory]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">internal/memory</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label</span><span style="color:#666">=</span><span style="color:#ba2121"> %gb_swap_used:.1f%</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;swap-memory&#34;)&gt;&gt;</span>
</span></span></code></pre></div><h4 id="network">network</h4>
<p>Upload/download speed</p>
<p>UPD <span class="timestamp-wrapper"><span class="timestamp">&lt;2022-07-24 Sun&gt;</span></span>: Somehow it doesn&rsquo;t work with my current internet setup.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/network]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">internal/network</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interface</span> <span style="color:#666">=</span> <span style="color:#ba2121">${env:WLAN_INTERFACE}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-connected = [&lt;ramp-signal&gt;] &lt;label-connected&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-connected</span> <span style="color:#666">=</span> <span style="color:#ba2121">↓ %downspeed% ↑ %upspeed%</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-disconnected</span> <span style="color:#666">=</span> <span style="color:#ba2121">X</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-connected-underline = ${colors.green}</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-disconnected-underline = ${colors.red}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-connected-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;network&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-disconnected-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;network&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-signal-0</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-signal-1</span> <span style="color:#666">=</span> <span style="color:#ba2121">1</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-signal-2</span> <span style="color:#666">=</span> <span style="color:#ba2121">2</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-signal-3</span> <span style="color:#666">=</span> <span style="color:#ba2121">3</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-signal-4</span> <span style="color:#666">=</span> <span style="color:#ba2121">4</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-signal-5</span> <span style="color:#666">=</span> <span style="color:#ba2121">5</span>
</span></span></code></pre></div><h4 id="bandwidth">bandwidth</h4>
<p><a href="bin/polybar/bandwidth3.sh">My adaption</a> of an i3blocks script called &ldquo;<a href="https://github.com/vivien/i3blocks-contrib/tree/master/bandwidth3">bandwidth3</a>&rdquo;. I&rsquo;ve only changed some defaults that are awkward to set with polybar.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/bandwidth]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">custom/script</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">exec</span> <span style="color:#666">=</span> <span style="color:#ba2121">/home/pavel/bin/polybar/bandwidth3.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">tail</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;bandwidth&#34;)&gt;&gt;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Copyright (C) 2015 James Murphy</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Copyright (C) 2022 Pavel Korytov</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Licensed under the terms of the GNU GPL v2 only.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">iface</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">BLOCK_INSTANCE</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">iface</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">IFACE</span><span style="color:#008000;font-weight:bold">:-</span><span style="color:#19177c">$iface</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">dt</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">DT</span><span style="color:#008000;font-weight:bold">:-</span><span style="color:#19177c">1</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">unit</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">UNIT</span><span style="color:#008000;font-weight:bold">:-</span><span style="color:#19177c">Kb</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">printf_command</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">PRINTF_COMMAND</span><span style="color:#008000;font-weight:bold">:-</span><span style="color:#ba2121">&#34;printf \&#34;↓ %-2.1f ↑ %2.1f [%s/s]\\n\&#34;, rx, wx, unit;&#34;</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">function</span> default_interface <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    ip route | awk <span style="color:#ba2121">&#39;/^default via/ {print $5; exit}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">function</span> check_proc_net_dev <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> ! -f <span style="color:#ba2121">&#34;/proc/net/dev&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>	<span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;/proc/net/dev not found&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#008000">exit</span> <span style="color:#666">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">function</span> list_interfaces <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    check_proc_net_dev
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;Interfaces in /proc/net/dev:&#34;</span>
</span></span><span style="display:flex;"><span>    grep -o <span style="color:#ba2121">&#34;^[^:]\\+:&#34;</span> /proc/net/dev | tr -d <span style="color:#ba2121">&#34; :&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">while</span> <span style="color:#008000">getopts</span> i:t:u:p:lh opt; <span style="color:#008000;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">case</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$opt</span><span style="color:#ba2121">&#34;</span> in
</span></span><span style="display:flex;"><span>	i<span style="color:#666">)</span> <span style="color:#19177c">iface</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$OPTARG</span><span style="color:#ba2121">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	t<span style="color:#666">)</span> <span style="color:#19177c">dt</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$OPTARG</span><span style="color:#ba2121">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	u<span style="color:#666">)</span> <span style="color:#19177c">unit</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$OPTARG</span><span style="color:#ba2121">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	p<span style="color:#666">)</span> <span style="color:#19177c">printf_command</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$OPTARG</span><span style="color:#ba2121">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	l<span style="color:#666">)</span> list_interfaces <span style="color:#666">&amp;&amp;</span> <span style="color:#008000">exit</span> <span style="color:#666">0</span> ;;
</span></span><span style="display:flex;"><span>	h<span style="color:#666">)</span> <span style="color:#008000">printf</span> <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span><span style="color:#ba2121">&#34;Usage: bandwidth3 [-i interface] [-t time] [-u unit] [-p printf_command] [-l] [-h]
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">Options:
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">-i\tNetwork interface to measure. Default determined using \`ip route\`.
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">-t\tTime interval in seconds between measurements. Default: 3
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">-u\tUnits to measure bytes in. Default: Mb
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">\tAllowed units: Kb, KB, Mb, MB, Gb, GB, Tb, TB
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">\tUnits may have optional it/its/yte/ytes on the end, e.g. Mbits, KByte
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">-p\tAwk command to be called after a measurement is made.
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">\tDefault: printf \&#34;&lt;span font=&#39;FontAwesome&#39;&gt;  &lt;/span&gt;%%-5.1f/%%5.1f %%s/s\\\\n\&#34;, rx, wx, unit;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">\tExposed variables: rx, wx, tx, unit, iface
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">-l\tList available interfaces in /proc/net/dev
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">-h\tShow this help text
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">&#34;</span> <span style="color:#666">&amp;&amp;</span> <span style="color:#008000">exit</span> 0;;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">esac</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>check_proc_net_dev
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">iface</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">iface</span><span style="color:#008000;font-weight:bold">:-$(</span>default_interface<span style="color:#008000;font-weight:bold">)</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">while</span> <span style="color:#666">[</span> -z <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$iface</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> No default interface
</span></span><span style="display:flex;"><span>    sleep <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$dt</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">iface</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>default_interface<span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">case</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$unit</span><span style="color:#ba2121">&#34;</span> in
</span></span><span style="display:flex;"><span>    Kb|Kbit|Kbits<span style="color:#666">)</span>   <span style="color:#19177c">bytes_per_unit</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$((</span><span style="color:#666">1024</span> <span style="color:#666">/</span> <span style="color:#666">8</span><span style="color:#008000;font-weight:bold">))</span>;;
</span></span><span style="display:flex;"><span>    KB|KByte|KBytes<span style="color:#666">)</span> <span style="color:#19177c">bytes_per_unit</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$((</span><span style="color:#666">1024</span><span style="color:#008000;font-weight:bold">))</span>;;
</span></span><span style="display:flex;"><span>    Mb|Mbit|Mbits<span style="color:#666">)</span>   <span style="color:#19177c">bytes_per_unit</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$((</span><span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span> <span style="color:#666">/</span> <span style="color:#666">8</span><span style="color:#008000;font-weight:bold">))</span>;;
</span></span><span style="display:flex;"><span>    MB|MByte|MBytes<span style="color:#666">)</span> <span style="color:#19177c">bytes_per_unit</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$((</span><span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span><span style="color:#008000;font-weight:bold">))</span>;;
</span></span><span style="display:flex;"><span>    Gb|Gbit|Gbits<span style="color:#666">)</span>   <span style="color:#19177c">bytes_per_unit</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$((</span><span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span> <span style="color:#666">/</span> <span style="color:#666">8</span><span style="color:#008000;font-weight:bold">))</span>;;
</span></span><span style="display:flex;"><span>    GB|GByte|GBytes<span style="color:#666">)</span> <span style="color:#19177c">bytes_per_unit</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$((</span><span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span><span style="color:#008000;font-weight:bold">))</span>;;
</span></span><span style="display:flex;"><span>    Tb|Tbit|Tbits<span style="color:#666">)</span>   <span style="color:#19177c">bytes_per_unit</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$((</span><span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span> <span style="color:#666">/</span> <span style="color:#666">8</span><span style="color:#008000;font-weight:bold">))</span>;;
</span></span><span style="display:flex;"><span>    TB|TByte|TBytes<span style="color:#666">)</span> <span style="color:#19177c">bytes_per_unit</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$((</span><span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span> <span style="color:#666">*</span> <span style="color:#666">1024</span><span style="color:#008000;font-weight:bold">))</span>;;
</span></span><span style="display:flex;"><span>    *<span style="color:#666">)</span> <span style="color:#008000">echo</span> Bad unit <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$unit</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">&amp;&amp;</span> <span style="color:#008000">exit</span> 1;;
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">scalar</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$((</span>bytes_per_unit <span style="color:#666">*</span> dt<span style="color:#008000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">init_line</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>cat /proc/net/dev | grep <span style="color:#ba2121">&#34;^[ ]*</span><span style="color:#19177c">$iface</span><span style="color:#ba2121">:&#34;</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> -z <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$init_line</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> Interface not found in /proc/net/dev: <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$iface</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">exit</span> <span style="color:#666">1</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">init_received</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>awk <span style="color:#ba2121">&#39;{print $2}&#39;</span> <span style="color:#666">&lt;&lt;&lt;</span> <span style="color:#19177c">$init_line</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">init_sent</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>awk <span style="color:#ba2121">&#39;{print $10}&#39;</span> <span style="color:#666">&lt;&lt;&lt;</span> <span style="color:#19177c">$init_line</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#666">(</span><span style="color:#008000;font-weight:bold">while</span> true; <span style="color:#008000;font-weight:bold">do</span> cat /proc/net/dev; sleep <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$dt</span><span style="color:#ba2121">&#34;</span>; <span style="color:#008000;font-weight:bold">done</span><span style="color:#666">)</span> |<span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>    stdbuf -oL grep <span style="color:#ba2121">&#34;^[ ]*</span><span style="color:#19177c">$iface</span><span style="color:#ba2121">:&#34;</span>|<span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>    awk -v <span style="color:#19177c">scalar</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$scalar</span><span style="color:#ba2121">&#34;</span> -v <span style="color:#19177c">unit</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$unit</span><span style="color:#ba2121">&#34;</span> -v <span style="color:#19177c">iface</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$iface</span><span style="color:#ba2121">&#34;</span> <span style="color:#ba2121">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">BEGIN{old_received=&#39;</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$init_received</span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">&#39;;old_sent=&#39;</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$init_sent</span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">&#39;}
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">{
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    received=$2
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    sent=$10
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    rx=(received-old_received)/scalar;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    wx=(sent-old_sent)/scalar;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    tx=rx+wr;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    old_received=received;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    old_sent=sent;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    if(rx &gt;= 0 &amp;&amp; wx &gt;= 0){
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">	&#39;</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$printf_command</span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">	fflush(stdout);
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    }
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">}
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">&#39;</span>
</span></span></code></pre></div><h4 id="ipstack-vpn">ipstack-vpn</h4>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>desktop-polybar</td>
<td>bind:utils</td>
<td>Provides dig</td>
</tr>
<tr>
<td>desktop-polybar</td>
<td>curl</td>
<td></td>
</tr>
<tr>
<td>desktop-polybar</td>
<td>jq</td>
<td>util to work with JSONs</td>
</tr>
</tbody>
</table>
<p>A module to get a country of the current IP and openvpn status. Uses <a href="https://ipstack.com/">ipstack</a> API.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#19177c">ip</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>dig +short +timeout<span style="color:#666">=</span><span style="color:#666">1</span> myip.opendns.com @resolver1.opendns.com 2&gt; /dev/null<span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># API_KEY=&#34;$(pass show My_Online/APIs/ipstack | head -n 1)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">API_KEY</span><span style="color:#666">=</span><span style="color:#19177c">$IPSTACK_API_KEY</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[[</span> -z <span style="color:#19177c">$ip</span> <span style="color:#666">||</span> <span style="color:#19177c">$ip</span> <span style="color:#666">==</span> *<span style="color:#ba2121">&#34;timed out&#34;</span>* <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;%{u&lt;&lt;get-color(name=&#34;</span>red<span style="color:#ba2121">&#34;)&gt;&gt;}%{+u} ?? %{u-}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">exit</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">ip_info</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>curl -s http://api.ipstack.com/<span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">ip</span><span style="color:#b68;font-weight:bold">}</span>?access_key<span style="color:#666">=</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">API_KEY</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># emoji=$(echo $ip_info | jq -r &#39;.location.country_flag_emoji&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">code</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span><span style="color:#008000">echo</span> <span style="color:#19177c">$ip_info</span> | jq -r <span style="color:#ba2121">&#39;.country_code&#39;</span> 2&gt; /dev/null<span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">vpn</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>pgrep -a openvpn$ | head -n <span style="color:#666">1</span> | awk <span style="color:#ba2121">&#39;{print $NF }&#39;</span> | cut -d <span style="color:#ba2121">&#39;.&#39;</span> -f 1<span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[[</span> -z <span style="color:#19177c">$code</span> <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">code</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;??&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> -n <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$vpn</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;%{u&lt;&lt;get-color(name=&#34;</span>blue<span style="color:#ba2121">&#34;)&gt;&gt;}%{+u}  </span><span style="color:#19177c">$code</span><span style="color:#ba2121"> %{u-}&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;%{u&lt;&lt;get-color(name=&#34;</span>red<span style="color:#ba2121">&#34;)&gt;&gt;}%{+u}  </span><span style="color:#19177c">$code</span><span style="color:#ba2121"> %{u-}&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/ipstack-vpn]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">custom/script</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">exec</span> <span style="color:#666">=</span> <span style="color:#ba2121">/home/pavel/bin/polybar/ipstack-vpn.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">1200</span>
</span></span></code></pre></div><h4 id="openvpn">openvpn</h4>
<p>A module to check if openvpn is running.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#19177c">vpn</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>pgrep -a openvpn$ | head -n <span style="color:#666">1</span> | awk <span style="color:#ba2121">&#39;{print $NF }&#39;</span> | cut -d <span style="color:#ba2121">&#39;.&#39;</span> -f 1<span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> -n <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$vpn</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;  &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;  &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/openvpn]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">custom/script</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">exec</span> <span style="color:#666">=</span> <span style="color:#ba2121">/home/pavel/bin/polybar/openvpn.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;openvpn&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">1200</span>
</span></span></code></pre></div><h4 id="xkeyboard">xkeyboard</h4>
<p>Current keyboard layout</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/xkeyboard]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">internal/xkeyboard</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;label-layout&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-underline = ${colors.magenta}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;xkeyboard&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-layout</span> <span style="color:#666">=</span> <span style="color:#ba2121">%icon%</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">layout-icon-0</span> <span style="color:#666">=</span> <span style="color:#ba2121">ru;RU</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">layout-icon-1</span> <span style="color:#666">=</span> <span style="color:#ba2121">us;US</span>
</span></span></code></pre></div><h4 id="battery">battery</h4>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/battery]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">internal/battery</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">battery</span> <span style="color:#666">=</span> <span style="color:#ba2121">BAT0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">adapter</span> <span style="color:#666">=</span> <span style="color:#ba2121">ADP0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">time-format</span> <span style="color:#666">=</span> <span style="color:#ba2121">%H:%M</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-discharging</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;ramp-capacity&gt; &lt;label-discharging&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-discharging-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;battery&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-charging-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;battery&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-full-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;battery&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-discharging</span> <span style="color:#666">=</span> <span style="color:#ba2121">%percentage%% %time%</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-charging</span> <span style="color:#666">=</span> <span style="color:#ba2121"> %percentage%% %time%</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-capacity-0</span> <span style="color:#666">=</span> <span style="color:#ba2121"></span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-capacity-1</span> <span style="color:#666">=</span> <span style="color:#ba2121"></span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-capacity-2</span> <span style="color:#666">=</span> <span style="color:#ba2121"></span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-capacity-3</span> <span style="color:#666">=</span> <span style="color:#ba2121"></span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">ramp-capacity-4</span> <span style="color:#666">=</span> <span style="color:#ba2121"></span>
</span></span></code></pre></div><h4 id="weather">weather</h4>
<p>Gets current weather from <a href="http://wttr.in/">wttr.in</a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#19177c">bar_format</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">BAR_FORMAT</span><span style="color:#008000;font-weight:bold">:-</span><span style="color:#ba2121">&#34;%t&#34;</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">location</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">LOCATION</span><span style="color:#008000;font-weight:bold">:-</span><span style="color:#ba2121">&#34;Saint-Petersburg&#34;</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">format_1</span><span style="color:#666">=</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">FORMAT_1</span><span style="color:#008000;font-weight:bold">:-</span><span style="color:#ba2121">&#34;qF&#34;</span><span style="color:#b68;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">format_2</span><span style="color:#666">=</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">FORMAT_1</span><span style="color:#008000;font-weight:bold">:-</span><span style="color:#ba2121">&#34;format=v2n&#34;</span><span style="color:#b68;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">bar_weather</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>curl -s wttr.in/<span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">location</span><span style="color:#b68;font-weight:bold">}</span>?format<span style="color:#666">=</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">bar_format</span><span style="color:#b68;font-weight:bold">}</span> <span style="color:#666">||</span> <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;??&#34;</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> -z <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$bar_weather</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">exit</span> <span style="color:#666">1</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">elif</span> <span style="color:#666">[[</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$bar_weather</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">==</span> *<span style="color:#ba2121">&#34;Unknown&#34;</span>* <span style="color:#666">||</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$bar_weather</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">==</span> *<span style="color:#ba2121">&#34;Sorry&#34;</span>* <span style="color:#666">||</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$bar_weather</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">==</span> *<span style="color:#ba2121">&#34;Bad Gateway&#34;</span>* <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;??&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">exit</span> <span style="color:#666">1</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">bar_weather</span><span style="color:#b68;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/weather]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">custom/script</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">exec</span> <span style="color:#666">=</span> <span style="color:#ba2121">/home/pavel/bin/polybar/weather.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; format-underline = ${colors.red}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;weather&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">1200</span>
</span></span></code></pre></div><h4 id="sun">sun</h4>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>desktop-polybar</td>
<td>sunwait</td>
</tr>
</tbody>
</table>
<p>Prints out the time of sunrise/sunset. Uses <a href="https://github.com/risacher/sunwait">sunwait</a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#008000">declare</span> -A <span style="color:#19177c">LAT_DATA</span><span style="color:#666">=(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;TMN&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;57.15N&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;SPB&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;59.9375N&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#666">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000">declare</span> -A <span style="color:#19177c">LON_DATA</span><span style="color:#666">=(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;TMN&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;65.533333E&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">[</span><span style="color:#ba2121">&#34;SPB&#34;</span><span style="color:#666">]=</span><span style="color:#ba2121">&#34;30.308611E&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#666">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> -z <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$LOC</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;LOC?&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">exit</span> -1
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">LAT</span><span style="color:#666">=</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">LAT_DATA</span>[<span style="color:#19177c">$LOC</span>]<span style="color:#b68;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">LON</span><span style="color:#666">=</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">LON_DATA</span>[<span style="color:#19177c">$LOC</span>]<span style="color:#b68;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">time</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>sunwait poll daylight rise <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">LAT</span><span style="color:#b68;font-weight:bold">}</span> <span style="color:#19177c">$LON</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[[</span> <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">time</span><span style="color:#b68;font-weight:bold">}</span> <span style="color:#666">==</span> <span style="color:#ba2121">&#39;DAY&#39;</span> <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">sunset</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>sunwait list daylight <span style="color:#008000">set</span> <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">LAT</span><span style="color:#b68;font-weight:bold">}</span> <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">LON</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic"># echo &#34;%{u&lt;&lt;get-color(name=&#34;yellow&#34;)&gt;&gt;}%{+u} $sunset %{u-}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#19177c">$sunset</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">sunrise</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>sunwait list daylight rise <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">LAT</span><span style="color:#b68;font-weight:bold">}</span> <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">LON</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic"># echo &#34;%{u&lt;&lt;get-color(name=&#34;red&#34;)&gt;&gt;}%{+u} $sunrise %{u-}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#19177c">$sunrise</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/sun]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">custom/script</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">exec</span> <span style="color:#666">=</span> <span style="color:#ba2121">/home/pavel/bin/polybar/sun.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;sun&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">60</span>
</span></span></code></pre></div><h4 id="aw-afk">aw-afk</h4>
<p>Prints out a current uptime and non-AFK time from <a href="https://github.com/ActivityWatch">ActivityWatch</a> server</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>desktop-polybar</td>
<td>dateutils</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#19177c">afk_event</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>curl -s -X GET <span style="color:#ba2121">&#34;http://localhost:5600/api/0/buckets/aw-watcher-afk_</span><span style="color:#008000;font-weight:bold">$(</span>hostname<span style="color:#008000;font-weight:bold">)</span><span style="color:#ba2121">/events?limit=1&#34;</span> -H <span style="color:#ba2121">&#34;accept: application/json&#34;</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">status</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span><span style="color:#008000">echo</span> <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">afk_event</span><span style="color:#b68;font-weight:bold">}</span> | jq -r <span style="color:#ba2121">&#39;.[0].data.status&#39;</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">afk_time</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span><span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">afk_event</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span> | jq -r <span style="color:#ba2121">&#39;.[0].duration&#39;</span> | xargs -I !  date -u -d @! +<span style="color:#ba2121">&#34;%H:%M&#34;</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">uptime</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>uptime | awk <span style="color:#ba2121">&#39;{ print substr($3, 0, length($3) - 1) }&#39;</span> | xargs -I ! date -d ! +<span style="color:#ba2121">&#34;%H:%M&#34;</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">res</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">afk_time</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121"> / </span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">uptime</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[[</span> <span style="color:#19177c">$status</span> <span style="color:#666">==</span> <span style="color:#ba2121">&#39;afk&#39;</span> <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic"># echo &#34;%{u&lt;&lt;get-color(name=&#34;red&#34;)&gt;&gt;}%{+u} [AFK] $res %{u-}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;[AFK] </span><span style="color:#19177c">$res</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic"># echo &#34;%{u&lt;&lt;get-color(name=&#34;blue&#34;)&gt;&gt;}%{+u} $res %{u-}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$res</span><span style="color:#ba2121">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/aw-afk]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">custom/script</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">exec</span> <span style="color:#666">=</span> <span style="color:#ba2121">/home/pavel/bin/polybar/aw_afk.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">60</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;aw-afk&#34;)&gt;&gt;</span>
</span></span></code></pre></div><h4 id="date">date</h4>
<p>Current date</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/date]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">internal/date</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">date</span> <span style="color:#666">=</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">date-alt</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34;%Y-%m-%d&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">time</span> <span style="color:#666">=</span> <span style="color:#ba2121">%H:%M</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">time-alt</span> <span style="color:#666">=</span> <span style="color:#ba2121">%H:%M:%S</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;&lt;get-polybar-bg(module=&#34;date&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34;%date% %time%&#34;</span>
</span></span></code></pre></div><h4 id="pomm">pomm</h4>
<p>Pomodoro module.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> ps -e | grep emacs &gt;&gt; /dev/null; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    emacsclient --eval <span style="color:#ba2121">&#34;(if (boundp &#39;pomm-current-mode-line-string) pomm-current-mode-line-string \&#34;\&#34;) &#34;</span> | xargs <span style="color:#008000">echo</span> -e
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/pomm]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">custom/script</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">exec</span> <span style="color:#666">=</span> <span style="color:#ba2121">/home/pavel/bin/polybar/pomm.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">1</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-underline</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.light-green}</span>
</span></span></code></pre></div><h4 id="sep">SEP</h4>
<p>A simple separator</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/SEP]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">custom/text</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">content</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34;|&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">content-foreground</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.magenta}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">content-padding</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">content-margin</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">100000</span>
</span></span></code></pre></div><h4 id="tsep">TSEP</h4>
<p>A separator, which appears only if monitor is set to have a tray in the launch script</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> ! -z <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$TRAY</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">]</span> <span style="color:#666">&amp;&amp;</span> <span style="color:#666">[</span> <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$TRAY</span><span style="color:#ba2121">&#34;</span> !<span style="color:#666">=</span> <span style="color:#ba2121">&#34;none&#34;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#ba2121">&#34;| &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/TSEP]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">custom/script</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">exec</span> <span style="color:#666">=</span> <span style="color:#ba2121">/home/pavel/bin/polybar/tray-sep.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format-foreground</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.magenta}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">interval</span> <span style="color:#666">=</span> <span style="color:#ba2121">100000</span>
</span></span></code></pre></div><h4 id="i3">i3</h4>
<p>Show i3wm workspaces</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[module/i3]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">type</span> <span style="color:#666">=</span> <span style="color:#ba2121">internal/i3</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">format</span> <span style="color:#666">=</span> <span style="color:#ba2121">&lt;label-state&gt; &lt;label-mode&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">index-sort</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">wrapping-scroll</span> <span style="color:#666">=</span> <span style="color:#ba2121">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; Only show workspaces on the same output as the bar</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">pin-workspaces</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-mode-padding</span> <span style="color:#666">=</span> <span style="color:#ba2121">1</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-mode-foreground</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.white}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-mode-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.blue}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; focused = Active workspace on focused monitor</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-focused</span> <span style="color:#666">=</span> <span style="color:#ba2121">%</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-focused-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.blue}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-focused-underline</span><span style="color:#666">=</span> <span style="color:#ba2121">${colors.blue}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-focused-padding</span> <span style="color:#666">=</span> <span style="color:#ba2121">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; unfocused = Inactive workspace on any monitor</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-unfocused</span> <span style="color:#666">=</span> <span style="color:#ba2121">%</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-unfocused-padding</span> <span style="color:#666">=</span> <span style="color:#ba2121">1</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-unfocused-foreground</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.white}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; visible = Active workspace on unfocused monitor</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-visible</span> <span style="color:#666">=</span> <span style="color:#ba2121">%</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; label-visible-background = ${self.label-focused-background}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-visible-underline</span> <span style="color:#666">=</span> <span style="color:#ba2121">${self.label-focused-underline}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-visible-padding</span> <span style="color:#666">=</span> <span style="color:#ba2121">${self.label-focused-padding}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">; urgent = Workspace with urgency hint set</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-urgent</span> <span style="color:#666">=</span> <span style="color:#ba2121">%</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-urgent-background</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.red}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-urgent-foreground</span> <span style="color:#666">=</span> <span style="color:#ba2121">${colors.black}</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">label-urgent-padding</span> <span style="color:#666">=</span> <span style="color:#ba2121">1</span>
</span></span></code></pre></div><h2 id="rofi-1">Rofi</h2>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>desktop-rofi</td>
<td>rofi</td>
</tr>
</tbody>
</table>
<p><a href="https://github.com/davatorium/rofi">rofi</a> is another dynamic menu generator. It can act as dmenu replacement but offers a superset of dmenu&rsquo;s features.</p>
<h3 id="theme">Theme</h3>
<p>A theme, based on <a href="https://github.com/dracula/rofi">dracula theme</a> for rofi, but with palenight colorscheme.</p>
<p><a id="code-snippet--get-rofi-colors"></a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#00f">apply</span>
</span></span><span style="display:flex;"><span> <span style="color:#00f">#&#39;concat</span>
</span></span><span style="display:flex;"><span> (<span style="color:#00f">mapcar</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#008000">lambda</span> (<span style="color:#19177c">elem</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#00f">concat</span> (<span style="color:#00f">nth</span> <span style="color:#666">0</span> <span style="color:#19177c">elem</span>) <span style="color:#ba2121">&#34;: &#34;</span> (<span style="color:#00f">nth</span> <span style="color:#666">2</span> <span style="color:#19177c">elem</span>) <span style="color:#ba2121">&#34;;\n&#34;</span>))
</span></span><span style="display:flex;"><span>  <span style="color:#19177c">table</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span><span style="color:#408080;font-style:italic">/* Generated from [[file:../../Desktop.org::*Theme][Theme:1]] */</span>
</span></span><span style="display:flex;"><span> <span style="color:#666">*</span> {
</span></span><span style="display:flex;"><span>    <span style="">&lt;&lt;get-rofi-colors()&gt;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    foreground:                  <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">white</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background</span>:                  <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">black</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>:            <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">black</span>;
</span></span><span style="display:flex;"><span>    separatorcolor:              <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">blue</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border-color</span>:                <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">blue</span>;
</span></span><span style="display:flex;"><span>    selected-normal-foreground:  <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">black</span>;
</span></span><span style="display:flex;"><span>    selected-normal-background:  <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">blue</span>;
</span></span><span style="display:flex;"><span>    selected-active-foreground:  <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">black</span>;
</span></span><span style="display:flex;"><span>    selected-active-background:  <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">blue</span>;
</span></span><span style="display:flex;"><span>    selected-urgent-foreground:  <span style="color:#666">@</span>foreground;
</span></span><span style="display:flex;"><span>    selected-urgent-background:  <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">red</span>;
</span></span><span style="display:flex;"><span>    normal-foreground:           <span style="color:#666">@</span>foreground;
</span></span><span style="display:flex;"><span>    normal-background:           <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">background</span>;
</span></span><span style="display:flex;"><span>    active-foreground:           <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">blue</span>;
</span></span><span style="display:flex;"><span>    active-background:           <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">background</span>;
</span></span><span style="display:flex;"><span>    urgent-foreground:           <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">red</span>;
</span></span><span style="display:flex;"><span>    urgent-background:           <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">background</span>;
</span></span><span style="display:flex;"><span>    alternate-normal-foreground: <span style="color:#666">@</span>foreground;
</span></span><span style="display:flex;"><span>    alternate-normal-background: <span style="color:#666">@</span>light-black;
</span></span><span style="display:flex;"><span>    alternate-active-foreground: <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">blue</span>;
</span></span><span style="display:flex;"><span>    alternate-active-background: <span style="color:#666">@</span>light-black;
</span></span><span style="display:flex;"><span>    alternate-urgent-foreground: <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">red</span>;
</span></span><span style="display:flex;"><span>    alternate-urgent-background: <span style="color:#666">@</span>light-black;
</span></span><span style="display:flex;"><span>    spacing:                     <span style="color:#666">2</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">window</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">background</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border</span>:           <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">padding</span>:          <span style="color:#666">5</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">mainbox</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border</span>:           <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">padding</span>:          <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">message</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border</span>:           <span style="color:#666">1</span><span style="color:#b00040">px</span> dash <span style="color:#666">0</span><span style="color:#b00040">px</span> <span style="color:#666">0</span><span style="color:#b00040">px</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border-color</span>:     <span style="color:#666">@</span>separatorcolor;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">padding</span>:          <span style="color:#666">1</span><span style="color:#b00040">px</span> ;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">textbox</span> {
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span>foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">listview</span> {
</span></span><span style="display:flex;"><span>    fixed-height:     <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border</span>:           <span style="color:#666">2</span><span style="color:#b00040">px</span> dash <span style="color:#666">0</span><span style="color:#b00040">px</span> <span style="color:#666">0</span><span style="color:#b00040">px</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border-color</span>:     <span style="color:#666">@</span>separatorcolor;
</span></span><span style="display:flex;"><span>    spacing:          <span style="color:#666">2</span><span style="color:#b00040">px</span> ;
</span></span><span style="display:flex;"><span>    scrollbar:        true;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">padding</span>:          <span style="color:#666">2</span><span style="color:#b00040">px</span> <span style="color:#666">0</span><span style="color:#b00040">px</span> <span style="color:#666">0</span><span style="color:#b00040">px</span> ;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">element</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border</span>:           <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">padding</span>:          <span style="color:#666">1</span><span style="color:#b00040">px</span> ;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">element</span> <span style="color:#008000;font-weight:bold">normal</span>.<span style="color:#00f;font-weight:bold">normal</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">normal</span><span style="color:#666">-</span><span style="color:#008000;font-weight:bold">background</span>;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">normal</span><span style="color:#666">-</span>foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">element</span> <span style="color:#008000;font-weight:bold">normal</span>.<span style="color:#00f;font-weight:bold">urgent</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span>urgent-background;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span>urgent-foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">element</span> <span style="color:#008000;font-weight:bold">normal</span>.<span style="color:#00f;font-weight:bold">active</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span>active-background;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span>active-foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">element</span> <span style="color:#008000;font-weight:bold">selected</span>.<span style="color:#00f;font-weight:bold">normal</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span>selected-normal-background;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span>selected-normal-foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">element</span> <span style="color:#008000;font-weight:bold">selected</span>.<span style="color:#00f;font-weight:bold">urgent</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span>selected-urgent-background;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span>selected-urgent-foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">element</span> <span style="color:#008000;font-weight:bold">selected</span>.<span style="color:#00f;font-weight:bold">active</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span>selected-active-background;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span>selected-active-foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">element</span> <span style="color:#008000;font-weight:bold">alternate</span>.<span style="color:#00f;font-weight:bold">normal</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">alternate</span><span style="color:#666">-</span><span style="color:#008000;font-weight:bold">normal</span><span style="color:#666">-</span><span style="color:#008000;font-weight:bold">background</span>;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">alternate</span><span style="color:#666">-</span><span style="color:#008000;font-weight:bold">normal</span><span style="color:#666">-</span>foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">element</span> <span style="color:#008000;font-weight:bold">alternate</span>.<span style="color:#00f;font-weight:bold">urgent</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">alternate</span><span style="color:#666">-</span>urgent-background;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">alternate</span><span style="color:#666">-</span>urgent-foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">element</span> <span style="color:#008000;font-weight:bold">alternate</span>.<span style="color:#00f;font-weight:bold">active</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">alternate</span><span style="color:#666">-</span>active-background;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">alternate</span><span style="color:#666">-</span>active-foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">scrollbar</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">width</span>:            <span style="color:#666">4</span><span style="color:#b00040">px</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border</span>:           <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    handle-color:     <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">normal</span><span style="color:#666">-</span>foreground;
</span></span><span style="display:flex;"><span>    handle-width:     <span style="color:#666">8</span><span style="color:#b00040">px</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">padding</span>:          <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">sidebar</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border</span>:           <span style="color:#666">2</span><span style="color:#b00040">px</span> dash <span style="color:#666">0</span><span style="color:#b00040">px</span> <span style="color:#666">0</span><span style="color:#b00040">px</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">border-color</span>:     <span style="color:#666">@</span>separatorcolor;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">button</span> {
</span></span><span style="display:flex;"><span>    spacing:          <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">normal</span><span style="color:#666">-</span>foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">button</span> <span style="color:#008000;font-weight:bold">selected</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">background-color</span>: <span style="color:#666">@</span>selected-normal-background;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span>selected-normal-foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">inputbar</span> {
</span></span><span style="display:flex;"><span>    spacing:          <span style="color:#666">0</span><span style="color:#b00040">px</span>;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">normal</span><span style="color:#666">-</span>foreground;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">padding</span>:          <span style="color:#666">1</span><span style="color:#b00040">px</span> ;
</span></span><span style="display:flex;"><span>    children:         [ prompt,textbox-prompt-colon,entry,case-indicator ];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">case-indicator</span> {
</span></span><span style="display:flex;"><span>    spacing:          <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">normal</span><span style="color:#666">-</span>foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">entry</span> {
</span></span><span style="display:flex;"><span>    spacing:          <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">normal</span><span style="color:#666">-</span>foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">prompt</span> {
</span></span><span style="display:flex;"><span>    spacing:          <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#666">@</span><span style="color:#008000;font-weight:bold">normal</span><span style="color:#666">-</span>foreground;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">textbox-prompt-colon</span> {
</span></span><span style="display:flex;"><span>    expand:           false;
</span></span><span style="display:flex;"><span>    str:              <span style="color:#ba2121">&#34;:&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">margin</span>:           <span style="color:#666">0</span><span style="color:#b00040">px</span> <span style="color:#666">0.3000</span><span style="color:#b00040">em</span> <span style="color:#666">0.0000</span><span style="color:#b00040">em</span> <span style="color:#666">0.0000</span><span style="color:#b00040">em</span> ;
</span></span><span style="display:flex;"><span>    text-color:       <span style="color:#008000;font-weight:bold">inherit</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="scripts">Scripts</h3>
<h4 id="buku-bookmarks">Buku bookmarks</h4>
<p>Inspired by the <a href="https://github.com/knatsakis/rofi-buku">knatsakis/rofi-buku</a> script.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[</span> <span style="color:#008000;font-weight:bold">$(</span>hostname<span style="color:#008000;font-weight:bold">)</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#39;pdsk&#39;</span> <span style="color:#666">]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">BUKU</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;/home/pavel/.local/bin/buku&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">BUKU</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;/home/pavel/Programs/miniconda3/bin/buku&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># COMMAND=&#34;$BUKU -o %&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># COMMAND=&#34;qutebrowser $(buku -f 10 -p %)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">COMMAND</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;firefox %&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[[</span> <span style="color:#19177c">$1</span> <span style="color:#666">==</span> <span style="color:#ba2121">&#39;-e&#39;</span> <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">COMMAND</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#19177c">$BUKU</span><span style="color:#ba2121"> -w %&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">$BUKU</span> -f <span style="color:#666">4</span> -p | awk -F<span style="color:#ba2121">&#39;\t&#39;</span> -v <span style="color:#19177c">OFS</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;\t&#39;</span> <span style="color:#ba2121">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    split($4, tags, &#34;,&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    joined = sep = &#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    for (i = 1; i in tags; i++) {
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">	joined = joined sep &#34;[&#34; tags[i] &#34;]&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">	sep = &#34; &#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    }
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    url = substr($2, 1, 40)
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    if (length($2) &gt; 40) {
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">	url = url &#34;...&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    }
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    if ($1 != &#34;waiting for input&#34;) {
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">	printf &#34;%-5s %-60s %-45s %s\n&#34;, $1, $3, url, joined
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">    }
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">}&#39;</span> | sort -k <span style="color:#666">2</span> | rofi -dmenu -matching normal -sort -sorting-method fzf -width <span style="color:#666">80</span> -l <span style="color:#666">20</span> | cut -d <span style="color:#ba2121">&#39; &#39;</span> -f <span style="color:#666">1</span> | <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">read</span> index;
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[[</span> -z <span style="color:#ba2121">&#34;</span><span style="color:#19177c">$index</span><span style="color:#ba2121">&#34;</span> <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>	<span style="color:#008000">exit</span> <span style="color:#666">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#19177c">url</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span><span style="color:#19177c">$BUKU</span> -f <span style="color:#666">10</span> -p <span style="color:#19177c">$index</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000">echo</span> <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">url</span>#<span style="color:#ba2121">&#34;waiting for input&#34;</span><span style="color:#b68;font-weight:bold">}</span> | cut -d <span style="color:#ba2121">&#39; &#39;</span> -f <span style="color:#666">1</span> | xargs -I % <span style="color:#19177c">$COMMAND</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span></code></pre></div><h4 id="man-pages">Man pages</h4>
<p>Inspired by <a href="https://www.youtube.com/watch?v=8E8sUNHdzG8">this Luke Smith&rsquo;s video</a>.</p>
<p>A script to open a man page with zathura. There is no particular reason why one should look through man pages in pdf viewer rather than in console, but why not.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#19177c">SELECTED</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">$(</span>man -k . | rofi -dmenu -l <span style="color:#666">20</span> | awk <span style="color:#ba2121">&#39;{print $1}&#39;</span><span style="color:#008000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">[[</span> ! -z <span style="color:#19177c">$SELECTED</span> <span style="color:#666">]]</span>; <span style="color:#008000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    man -Tpdf <span style="color:#19177c">$SELECTED</span> | zathura -
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">fi</span>
</span></span></code></pre></div><h4 id="emojis-1">Emojis</h4>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>desktop-rofi</td>
<td>python-rofimoji</td>
</tr>
</tbody>
</table>
<h4 id="pass">pass</h4>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>desktop-rofi</td>
<td>rofi-pass</td>
</tr>
<tr>
<td>desktop-rofi</td>
<td>xset</td>
</tr>
</tbody>
</table>
<p>A nice <a href="https://github.com/carnager/rofi-pass">pass frontend for Rofi</a>, which is even packaged for Guix.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#19177c">USERNAME_field</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;username&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">EDITOR</span><span style="color:#666">=</span>vim
</span></span><span style="display:flex;"><span><span style="color:#19177c">default_autotype</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;username :tab pass&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#19177c">clip</span><span style="color:#666">=</span>both
</span></span></code></pre></div><h2 id="flameshot">Flameshot</h2>
<table>
<thead>
<tr>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>flameshot</td>
</tr>
</tbody>
</table>
<p><a href="https://github.com/flameshot-org/flameshot">flameshot</a> is my program of choice to make screenshots.</p>
<p>As it overwrites its own config all the time, I do not keep the file in VC.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[General]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">disabledTrayIcon</span><span style="color:#666">=</span><span style="color:#ba2121">false</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">drawColor</span><span style="color:#666">=</span><span style="color:#ba2121">#ff0000</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">drawThickness</span><span style="color:#666">=</span><span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">saveAfterCopyPath</span><span style="color:#666">=</span><span style="color:#ba2121">/home/pavel/Pictures</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">savePath</span><span style="color:#666">=</span><span style="color:#ba2121">/home/pavel/Pictures</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">savePathFixed</span><span style="color:#666">=</span><span style="color:#ba2121">false</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">showStartupLaunchMessage</span><span style="color:#666">=</span><span style="color:#ba2121">false</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">uiColor</span><span style="color:#666">=</span><span style="color:#ba2121">&lt;&lt;get-color(name=&#34;blue&#34;)&gt;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">[Shortcuts]</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_ARROW</span><span style="color:#666">=</span><span style="color:#ba2121">A</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_CIRCLE</span><span style="color:#666">=</span><span style="color:#ba2121">C</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_CIRCLECOUNT</span><span style="color:#666">=</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_COMMIT_CURRENT_TOOL</span><span style="color:#666">=</span><span style="color:#ba2121">Ctrl+Return</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_COPY</span><span style="color:#666">=</span><span style="color:#ba2121">Ctrl+C</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_DRAWER</span><span style="color:#666">=</span><span style="color:#ba2121">D</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_EXIT</span><span style="color:#666">=</span><span style="color:#ba2121">Ctrl+Q</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_IMAGEUPLOADER</span><span style="color:#666">=</span><span style="color:#ba2121">Return</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_MARKER</span><span style="color:#666">=</span><span style="color:#ba2121">M</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_MOVESELECTION</span><span style="color:#666">=</span><span style="color:#ba2121">Ctrl+M</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_MOVE_DOWN</span><span style="color:#666">=</span><span style="color:#ba2121">Down</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_MOVE_LEFT</span><span style="color:#666">=</span><span style="color:#ba2121">Left</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_MOVE_RIGHT</span><span style="color:#666">=</span><span style="color:#ba2121">Right</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_MOVE_UP</span><span style="color:#666">=</span><span style="color:#ba2121">Up</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_OPEN_APP</span><span style="color:#666">=</span><span style="color:#ba2121">Ctrl+O</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_PENCIL</span><span style="color:#666">=</span><span style="color:#ba2121">P</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_PIN</span><span style="color:#666">=</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_PIXELATE</span><span style="color:#666">=</span><span style="color:#ba2121">B</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_RECTANGLE</span><span style="color:#666">=</span><span style="color:#ba2121">R</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_REDO</span><span style="color:#666">=</span><span style="color:#ba2121">Ctrl+Shift+Z</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_RESIZE_DOWN</span><span style="color:#666">=</span><span style="color:#ba2121">Shift+Down</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_RESIZE_LEFT</span><span style="color:#666">=</span><span style="color:#ba2121">Shift+Left</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_RESIZE_RIGHT</span><span style="color:#666">=</span><span style="color:#ba2121">Shift+Right</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_RESIZE_UP</span><span style="color:#666">=</span><span style="color:#ba2121">Shift+Up</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_SAVE</span><span style="color:#666">=</span><span style="color:#ba2121">Ctrl+S</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_SELECTION</span><span style="color:#666">=</span><span style="color:#ba2121">S</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_SELECTIONINDICATOR</span><span style="color:#666">=</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_SELECT_ALL</span><span style="color:#666">=</span><span style="color:#ba2121">Ctrl+A</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_TEXT</span><span style="color:#666">=</span><span style="color:#ba2121">T</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_TOGGLE_PANEL</span><span style="color:#666">=</span><span style="color:#ba2121">Space</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">TYPE_UNDO</span><span style="color:#666">=</span><span style="color:#ba2121">Ctrl+Z</span>
</span></span></code></pre></div><h2 id="dunst">dunst</h2>
<table>
<thead>
<tr>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>dunst</td>
</tr>
<tr>
<td>libnotify</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Type</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>TODO</td>
<td>Cleanup default config comments</td>
</tr>
</tbody>
</table>
<p><a href="https://github.com/dunst-project/dunst">dunst</a> is a lightweight notification daemon.</p>
<p>My customizations of the original config consist mostly of changing colors.</p>
<p>References:</p>
<ul>
<li><a href="https://dunst-project.org/documentation/">dunst documentation</a></li>
</ul>
<!--listend-->
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>[global]<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    monitor = <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    follow = mouse<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # The geometry of the window:<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #   [{width}]x{height}[+<span style="color:#b68">/-{x}+/</span>-{y}]<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # The geometry of the message window.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # The height is measured in number of notifications everything <span style="color:#008000;font-weight:bold">else</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # in pixels.  If the width is omitted but the height is given<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # (<span style="color:#ba2121">&#34;-geometry x2&#34;</span>), the message window expands over the whole screen<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # (dmenu-like).  If width is <span style="color:#666">0</span>, the window expands to the longest<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # message displayed.  A positive x is measured from the left, a<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # negative from the right side of the screen.  Y is measured from<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # the top and down respectively.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # The width can be negative.  In this case the actual width is the<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # screen width minus the width defined in within the geometry option.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    geometry = <span style="color:#ba2121">&#34;300x5-30+20&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Show how many messages are currently hidden (because of geometry).<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    indicate_hidden = yes<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Shrink window <span style="color:#008000;font-weight:bold">if</span> its smaller than the width.  Will be ignored <span style="color:#008000;font-weight:bold">if</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # width is <span style="color:#666">0</span>.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    shrink = no<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # The transparency of the window.  Range: [<span style="color:#666">0</span>; <span style="color:#666">100</span>].<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # This option will only work <span style="color:#008000;font-weight:bold">if</span> a compositing window manager is<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # present (e.g. xcompmgr, compiz, etc.).<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    transparency = <span style="color:#666">15</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # The height of the entire notification.  If the height is smaller<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # than the font height and padding combined, it will be raised<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # to the font height and padding.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    notification_height = <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Draw a line of <span style="color:#ba2121">&#34;separator_height&#34;</span> pixel height between two<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # notifications.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Set to <span style="color:#666">0</span> to disable.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    separator_height = <span style="color:#666">2</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Padding between text and separator.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    padding = <span style="color:#666">8</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Horizontal padding.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    horizontal_padding = <span style="color:#666">8</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Defines width in pixels of frame around the notification window.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Set to <span style="color:#666">0</span> to disable.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    frame_width = <span style="color:#666">1</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Defines color of the frame around the notification window.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    frame_color = &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;white&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Define a color for the separator.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # possible values are:<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #  * auto: dunst tries to find a color fitting to the background;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #  * foreground: use the same color as the foreground;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #  * frame: use the same color as the frame;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #  * anything <span style="color:#008000;font-weight:bold">else</span> will be interpreted as a X color.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    separator_color = frame<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Sort messages by urgency.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    sort = yes<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Don&#39;t remove messages, <span style="color:#008000;font-weight:bold">if</span> the user is idle (no mouse or keyboard input)<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # for longer than idle_threshold seconds.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Set to <span style="color:#666">0</span> to disable.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # A client can set the <span style="color:#ba2121">&#39;transient&#39;</span> hint to bypass this. See the rules<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # section for how to disable this <span style="color:#008000;font-weight:bold">if</span> necessary<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    idle_threshold = <span style="color:#666">120</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    ### Text ###<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    font = DejaVu Sans <span style="color:#666">9</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # The spacing between lines.  If the height is smaller than the<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # font height, it will get raised to the font height.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    line_height = <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Possible values are:<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # full: Allow a small subset of html markup in notifications:<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        &lt;b&gt;<span style="color:#008000">bold</span>&lt;/b&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        &lt;i&gt;<span style="color:#008000">italic</span>&lt;/i&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        &lt;s&gt;strikethrough&lt;/s&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        &lt;u&gt;<span style="color:#008000">underline</span>&lt;/u&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        For a complete reference see<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        &lt;http:<span style="color:#b68">//</span>developer.gnome.org<span style="color:#b68">/pango/</span>stable/PangoMarkupFormat.html&gt;.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # strip: This setting is provided for compatibility with some broken<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        clients that send markup even though it&#39;s not enabled on the<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        server. Dunst will try to strip the markup but the parsing is<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        simplistic so using this option outside of matching rules for<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        specific applications *IS GREATLY DISCOURAGED*.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # no:    Disable markup parsing, incoming notifications will be treated as<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        plain text. Dunst will not advertise that it has the body-markup<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #        capability <span style="color:#008000;font-weight:bold">if</span> this is set as a global setting.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # It&#39;s important to note that markup inside the format option will be parsed<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # regardless of what this is set to.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    markup = full<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # The format of the message.  Possible variables are:<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #   %a  appname<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #   %s  summary<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #   %b  body<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #   %i  iconname (including its path)<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #   %I  iconname (without its path)<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #   %p  progress value <span style="color:#008000;font-weight:bold">if</span> set ([  <span style="color:#666">0</span>%] to [<span style="color:#666">100</span>%]) or nothing<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #   %n  progress value <span style="color:#008000;font-weight:bold">if</span> set without any extra characters<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #   %%  Literal %<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Markup is allowed<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    format = <span style="color:#ba2121">&#34;&lt;b&gt;%s&lt;/b&gt;\n%b&#34;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Alignment of message text.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Possible values are <span style="color:#ba2121">&#34;left&#34;</span>, <span style="color:#ba2121">&#34;center&#34;</span> and <span style="color:#ba2121">&#34;right&#34;</span>.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    alignment = left<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Show age of message <span style="color:#008000;font-weight:bold">if</span> message is older than show_age_threshold<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # seconds.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Set to <span style="color:#666">-1</span> to disable.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    show_age_threshold = <span style="color:#666">60</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Split notifications into multiple lines <span style="color:#008000;font-weight:bold">if</span> they don&#39;t fit into<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # geometry.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    word_wrap = yes<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # When word_wrap is set to no, specify where to make an ellipsis in long lines.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Possible values are <span style="color:#ba2121">&#34;start&#34;</span>, <span style="color:#ba2121">&#34;middle&#34;</span> and <span style="color:#ba2121">&#34;end&#34;</span>.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    ellipsize = middle<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Ignore newlines <span style="color:#ba2121">&#39;\n&#39;</span> in notifications.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    ignore_newline = no<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Stack together notifications with the same content<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    stack_duplicates = true<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Hide the count of stacked notifications with the same content<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    hide_duplicate_count = false<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Display indicators for URLs (U) and actions (A).<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    show_indicators = yes<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    ### Icons ###<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Align icons left<span style="color:#b68">/right/</span>off<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    icon_position = left<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Scale larger icons down to this size, set to <span style="color:#666">0</span> to disable<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    max_icon_size = <span style="color:#666">32</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Paths to default icons.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    icon_path = <span style="color:#b68">/usr/</span>share<span style="color:#b68">/icons/</span>Mint-Y<span style="color:#b68">/status/</span><span style="color:#666">32</span><span style="color:#b68">/;/</span>usr<span style="color:#b68">/share/</span>icons<span style="color:#b68">/Mint-Y/</span>devices/<span style="color:#666">32</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    ### History ###<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Should a notification popped up from history be sticky or timeout<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # as <span style="color:#008000;font-weight:bold">if</span> it would normally do.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    sticky_history = yes<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Maximum amount of notifications kept in history<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    history_length = <span style="color:#666">20</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    ### Misc/Advanced ###<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # dmenu path.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    dmenu = <span style="color:#b68">/usr/</span>bin/dmenu -p dunst:<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Browser for opening urls in context menu.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    browser = <span style="color:#b68">/usr/</span>bin/sensible-browser<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Always run rule-defined scripts, even <span style="color:#008000;font-weight:bold">if</span> the notification is suppressed<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    always_run_script = true<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Define the title of the windows spawned by dunst<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    title = Dunst<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Define the class of the windows spawned by dunst<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    class = Dunst<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Print a notification on startup.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # This is mainly for error detection, since dbus (re-)starts dunst<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # automatically after a crash.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    startup_notification = false<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Manage dunst&#39;s desire for talking<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Can be one of the following values:<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #  crit: Critical features. Dunst aborts<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #  warn: Only non-fatal warnings<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #  mesg: Important Messages<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #  info: all unimportant stuff<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # debug: all less than unimportant stuff<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    verbosity = mesg<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Define the corner radius of the notification window<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # in pixel size. If the radius is <span style="color:#666">0</span>, you have no rounded<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # corners.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # The radius will be automatically lowered <span style="color:#008000;font-weight:bold">if</span> it exceeds half of the<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # notification height to avoid clipping text and/or icons.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    corner_radius = <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    ### Legacy<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Use the Xinerama extension instead of RandR for multi-monitor support.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # This setting is provided for compatibility with older nVidia drivers that<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # do not support RandR and using it on systems that support RandR is highly<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # discouraged.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # By enabling this setting dunst will not be able to detect when a monitor<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # is connected or disconnected which might break follow mode <span style="color:#008000;font-weight:bold">if</span> the screen<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # layout changes.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    force_xinerama = false<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    ### mouse<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Defines action of mouse event<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Possible values are:<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # * none: Don&#39;t do anything.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # * do_action: If the notification has exactly one action, or one is marked as default,<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #              invoke it. If there are multiple and no default, open the context menu.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # * close_current: Close current notification.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # * close_all: Close all notifications.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    mouse_left_click = close_current<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    mouse_middle_click = do_action<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    mouse_right_click = close_all<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Experimental features that may or may not work correctly. Do not expect them<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># to have a consistent behaviour across releases.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>[experimental]<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Calculate the dpi to use on a per-monitor basis.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # If this setting is enabled the Xft.dpi value will be ignored and instead<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # dunst will attempt to calculate an appropriate dpi value for each monitor<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # using the resolution and physical size. This might be useful in setups<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # where there are multiple screens with very different dpi values.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    per_monitor_dpi = false<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>[shortcuts]<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Shortcuts are specified as [modifier+][modifier+]...key<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Available modifiers are <span style="color:#ba2121">&#34;ctrl&#34;</span>, <span style="color:#ba2121">&#34;mod1&#34;</span> (the alt-key), <span style="color:#ba2121">&#34;mod2&#34;</span>,<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # <span style="color:#ba2121">&#34;mod3&#34;</span> and <span style="color:#ba2121">&#34;mod4&#34;</span> (windows-key).<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Xev might be helpful to find names for keys.<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Close notification.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    close = ctrl+space<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Close all notifications.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    close_all = ctrl+shift+space<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Redisplay last message(s).<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # On the US keyboard layout <span style="color:#ba2121">&#34;grave&#34;</span> is normally above TAB and left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # of <span style="color:#ba2121">&#34;1&#34;</span>. Make sure this key actually exists on your keyboard layout,<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # e.g. check output of <span style="color:#ba2121">&#39;xmodmap -pke&#39;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    history = ctrl+grave<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Context menu.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    context = ctrl+shift+period<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>[urgency_low]<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # IMPORTANT: colors have to be defined in quotation marks.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Otherwise the <span style="color:#ba2121">&#34;#&#34;</span> and following would be interpreted as a comment.<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    background = &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;light-black&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    frame_color = &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;white&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    foreground = &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;light-white&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    timeout = <span style="color:#666">10</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Icon for notifications with low urgency, uncomment to enable<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #icon = <span style="color:#b68">/path/</span>to/icon<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>[urgency_normal]<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    background = &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;black&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    frame_color = &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;white&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    foreground = &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;light-white&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    timeout = <span style="color:#666">10</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Icon for notifications with normal urgency, uncomment to enable<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #icon = <span style="color:#b68">/path/</span>to/icon<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>[urgency_critical]<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    background = &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;red&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    foreground = &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;light-white&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    frame_color = &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;red&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    timeout = <span style="color:#666">0</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    # Icon for notifications with critical urgency, uncomment to enable<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>    #icon = <span style="color:#b68">/path/</span>to/icon<span style="">
</span></span></span></code></pre></div><h2 id="keynav">keynav</h2>
<table>
<thead>
<tr>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>keynav</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Type</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>SYMLINK</td>
<td>./config/keynavrc -&gt; .keynavrc</td>
</tr>
</tbody>
</table>
<p>How many times you have been working with keyboard-driven programs and had to use a mouse just to press some pesky little button in a modal window?</p>
<p><a href="https://github.com/jordansissel/keynav">keynav</a> is a program that allows you to control the mouse with the keyboard with the general idea of bisecting the screen to get to the required point. I&rsquo;m still not sure if there is any point in using it, but it&rsquo;s rather funny. Unfortunately, the colors seem to be hardcoded.</p>
<p>One of the usecases I found so far is to use the program to scroll webpages when tridactyl&rsquo;s scroll captures the wrong scroll area.</p>
<p>References:</p>
<ul>
<li><a href="https://github.com/jordansissel/keynav/blob/master/keynav.pod">keynav documentation</a></li>
</ul>
<h3 id="config">Config</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span># clear all previous keybindings<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>clear<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Start &amp; stop<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>ctrl+semicolon start<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Super_L+bracketright start<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Super_R+bracketright start<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Escape end<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>ctrl+bracketleft end<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Macros<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>q record ~/.keynav_macros<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>shift+at playback<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Bisecting<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>a history-back<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Left cut-left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Right cut-right<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Down cut-down<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Up cut-up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>h cut-left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>j cut-down<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>k cut-up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>l cut-right<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>t windowzoom                          # Zoom to the current window<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>c cursorzoom <span style="color:#666">300</span> <span style="color:#666">300</span>                  # Limit the bisection area by <span style="color:#666">300</span>x<span style="color:#666">300</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Move the bisecting area<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>shift+h move-left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>shift+j move-down<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>shift+k move-up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>shift+l move-right<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>shift+Left move-left<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>shift+Right move-right<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>shift+Up move-up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>shift+Down move-down<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span># Actions<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>space warp,click <span style="color:#666">3</span>,end                # Right click<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Return warp,click <span style="color:#666">1</span>,end               # Left click<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>Shift+Return warp,doubleclick <span style="color:#666">1</span>,end   # Double left click<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>semicolon warp,end                    # Move the cursor and exit<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>w warp                                # Just move the cursor<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>e end                                 # exit<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>u warp,click <span style="color:#666">4</span>                        # scroll up<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>d warp,click <span style="color:#666">5</span>                        # scroll down<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span><span style="color:#666">1</span> click <span style="color:#666">1</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span><span style="color:#666">2</span> click <span style="color:#666">2</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span><span style="color:#666">3</span> click <span style="color:#666">3</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span><span style="color:#666">4</span> click <span style="color:#666">4</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span><span style="color:#666">5</span> click <span style="color:#666">5</span><span style="">
</span></span></span></code></pre></div><h3 id="using-with-picom">Using with picom</h3>
<p>I&rsquo;ve noticed that the program does not play nice with picom&rsquo;s fade effect. To fix that, add the following to you config:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#7d9029">fade-exclude</span> <span style="color:#666">=</span> <span style="color:#ba2121">[
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;class_i = &#39;keynav&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;class_g = &#39;keynav&#39;&#34;,</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">]</span>
</span></span></code></pre></div><h2 id="picom">Picom</h2>
<table>
<thead>
<tr>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>picom</td>
</tr>
</tbody>
</table>
<p><a href="https://github.com/yshui/picom">picom</a> is a compositor for X11. It allows effects such as transparency, blurring, etc.</p>
<p>Sample configuration is a good resource for getting an overview of the available settings. I have only a bunch of necessary settings in mine.</p>
<p>There are a bunch of forks for picom (e.g. <a href="https://github.com/ibhagwan/picom">ibhagwan/picom</a> adds rounded corners) which seem to have some popularity, but I use the base one.</p>
<p>References:</p>
<ul>
<li><a href="https://github.com/yshui/picom/wiki">picom wiki</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Picom">Picom on ArchWiki</a></li>
<li><a href="https://github.com/yshui/picom/blob/next/picom.sample.conf">Sample configuration</a></li>
</ul>
<h3 id="shadows">Shadows</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#7d9029">shadow</span> <span style="color:#666">=</span> <span style="color:#ba2121">true;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">shadow-radius</span> <span style="color:#666">=</span> <span style="color:#ba2121">2;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">shadow-offset-x</span> <span style="color:#666">=</span> <span style="color:#ba2121">-2;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">shadow-offset-y</span> <span style="color:#666">=</span> <span style="color:#ba2121">-2;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">shadow-exclude</span> <span style="color:#666">=</span> <span style="color:#ba2121">[
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;name = &#39;Notification&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;class_g = &#39;Conky&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;name ?= &#39;cpt_frame_window&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;class_g ?= &#39;Notify-osd&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;class_g = &#39;Cairo-clock&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;_GTK_FRAME_EXTENTS@:c&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">];</span>
</span></span></code></pre></div><h3 id="fading">Fading</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#7d9029">fading</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">fade-in-step</span> <span style="color:#666">=</span> <span style="color:#ba2121">0.03;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">fade-out-step</span> <span style="color:#666">=</span> <span style="color:#ba2121">0.03;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">fade-delta</span> <span style="color:#666">=</span> <span style="color:#ba2121">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">fade-exclude</span> <span style="color:#666">=</span> <span style="color:#ba2121">[
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;class_i = &#39;keynav&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;class_g = &#39;keynav&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;class_i = &#39;emacs&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;class_g = &#39;emacs&#39;&#34;,</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">]</span>
</span></span></code></pre></div><h3 id="opacity">Opacity</h3>
<p>I don&rsquo;t use stuff like transparency for inactive windows.</p>
<p>The first 5 lines of <code>opacity-rule</code> make i3wm&rsquo;s hidden windows 100% transparent, so I see the background behind the semi-transparent windows in i3wm&rsquo;s stacked and tabbed layout. Here is <a href="https://unix.stackexchange.com/questions/281131/compton-i3-tabbed-stacked-transparency-background-image">StackExchange question</a> about that.</p>
<p>I also noticed that for some reason it doesn&rsquo;t play well with Emacs&rsquo;s built-in transparency, so the last line sets up Emacs transparency at 90%.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#7d9029">inactive-opacity</span> <span style="color:#666">=</span> <span style="color:#ba2121">1;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">frame-opacity</span> <span style="color:#666">=</span> <span style="color:#ba2121">1.0;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">inactive-opacity-override</span> <span style="color:#666">=</span> <span style="color:#ba2121">false;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">focus-exclude</span> <span style="color:#666">=</span> <span style="color:#ba2121">[ &#34;class_g = &#39;Cairo-clock&#39;&#34; ];</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">opacity-rule</span> <span style="color:#666">=</span> <span style="color:#ba2121">[
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;0:_NET_WM_STATE@[0]:32a = &#39;_NET_WM_STATE_HIDDEN&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;0:_NET_WM_STATE@[1]:32a = &#39;_NET_WM_STATE_HIDDEN&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;0:_NET_WM_STATE@[2]:32a = &#39;_NET_WM_STATE_HIDDEN&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;0:_NET_WM_STATE@[3]:32a = &#39;_NET_WM_STATE_HIDDEN&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;0:_NET_WM_STATE@[4]:32a = &#39;_NET_WM_STATE_HIDDEN&#39;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  &#34;90:class_g = &#39;Emacs&#39;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">];</span>
</span></span></code></pre></div><h3 id="general-settings-2">General settings</h3>
<p>Default general settings. Editing some of these may be neeeded in case of performance issues.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#7d9029">backend</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34;xrender&#34;;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">vsync</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">mark-wmwin-focused</span> <span style="color:#666">=</span> <span style="color:#ba2121">true;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">mark-ovredir-focused</span> <span style="color:#666">=</span> <span style="color:#ba2121">true;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">detect-rounded-corners</span> <span style="color:#666">=</span> <span style="color:#ba2121">true;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">detect-client-opacity</span> <span style="color:#666">=</span> <span style="color:#ba2121">true;</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">refresh-rate</span> <span style="color:#666">=</span> <span style="color:#ba2121">0</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">detect-transient</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">detect-client-leader</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">use-damage</span> <span style="color:#666">=</span> <span style="color:#ba2121">true</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">log-level</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#34;warn&#34;;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">wintypes:</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#7d9029">tooltip</span> <span style="color:#666">=</span> <span style="color:#ba2121">{ fade = true; shadow = true; opacity = 0.75; focus = true; full-shadow = false; };
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  dock = { shadow = false; }
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  dnd = { shadow = false; }
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  popup_menu = { opacity = 1; }
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">  dropdown_menu = { opacity = 1; }</span>
</span></span><span style="display:flex;"><span><span style="color:#7d9029">};</span>
</span></span></code></pre></div><h2 id="zathura">Zathura</h2>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>office</td>
<td>zathura</td>
</tr>
<tr>
<td>office</td>
<td>zathura-ps</td>
</tr>
<tr>
<td>office</td>
<td>zathura-pdf-mupdf</td>
</tr>
<tr>
<td>office</td>
<td>zathura-djvu</td>
</tr>
</tbody>
</table>
<p><a href="https://pwmt.org/projects/zathura/">Zathura</a> is a pdf viewer with vim-like keybindings. One of my favorite features is an ability to invert the document colors.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span>set abort-clear-search false<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set guioptions cs<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set selection-clipboard clipboard<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set recolor true<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>map &lt;C-r&gt; set recolor false<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>map &lt;C-R&gt; set recolor true<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set recolor-lightcolor &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;black&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set completion-bg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;black&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set completion-fg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;white&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set completion-group-bg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;light-black&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set completion-group-fg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;white&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set completion-highlight-bg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;magenta&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set completion-highlight-fg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;black&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set inputbar-bg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;black&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set inputbar-fg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;light-magenta&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set statusbar-bg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;black&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set statusbar-fg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;light-magenta&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set notification-error-bg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;red&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set notification-error-fg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;color-fg&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set notification-warning-bg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;yellow&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>set notification-warning-fg &lt;&lt;get-color(name=<span style="color:#ba2121">&#34;color-fg&#34;</span>, quote=<span style="color:#666">1</span>)&gt;&gt;<span style="">
</span></span></span></code></pre></div><h2 id="various-software">Various software</h2>
<p>This section generates manifests for various desktop software that I&rsquo;m using.</p>
<h3 id="browsers">Browsers</h3>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>browsers</td>
<td>ungoogled-chromium</td>
</tr>
<tr>
<td>browsers</td>
<td>firefox</td>
</tr>
</tbody>
</table>
<h3 id="office-and-multimedia">Office &amp; Multimedia</h3>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>office</td>
<td>libreoffice</td>
</tr>
<tr>
<td>office</td>
<td>gimp</td>
</tr>
<tr>
<td>office</td>
<td>krita</td>
</tr>
<tr>
<td>office</td>
<td>ffmpeg</td>
</tr>
<tr>
<td>office</td>
<td>kdenlive</td>
</tr>
<tr>
<td>office</td>
<td>inkscape</td>
</tr>
<tr>
<td>office</td>
<td>okular</td>
</tr>
</tbody>
</table>
<h3 id="latex">LaTeX</h3>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>latex</td>
<td>texlive</td>
</tr>
<tr>
<td>latex</td>
<td>texlab-bin</td>
</tr>
<tr>
<td>latex</td>
<td>biber</td>
</tr>
<tr>
<td>latex</td>
<td>python-pygments</td>
</tr>
<tr>
<td>latex</td>
<td>font-microsoft-web-core-fonts</td>
</tr>
</tbody>
</table>
<h3 id="dev">Dev</h3>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
<th>Disabled</th>
</tr>
</thead>
<tbody>
<tr>
<td>dev</td>
<td>conda</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>pandoc</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>docker-compose</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>postgresql</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>virt-manager</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>git-filter-repo</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>node</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>openjdk:jdk</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>go</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>gcc-toolchain</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>lua</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>libfaketime</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>hugo-extended</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>make</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>sbcl</td>
<td>t</td>
</tr>
<tr>
<td>dev</td>
<td>git-lfs</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>mysql</td>
<td>t</td>
</tr>
<tr>
<td>dev</td>
<td>gource</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>php</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>python</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>python-virtualenv</td>
<td></td>
</tr>
<tr>
<td>dev</td>
<td>leiningen</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="manifests">Manifests</h3>
<p><a id="code-snippet--packages"></a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#19177c">my/format-guix-dependencies</span> <span style="color:#19177c">category</span>)
</span></span></code></pre></div><p>Dev</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">specifications-&gt;manifest</span>
</span></span><span style="display:flex;"><span> <span style="color:#666">&#39;</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">&lt;&lt;packages</span>(<span style="color:#ba2121">&#34;dev&#34;</span>)<span style="color:#19177c">&gt;&gt;</span>))
</span></span></code></pre></div><p>Browsers</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">specifications-&gt;manifest</span>
</span></span><span style="display:flex;"><span> <span style="color:#666">&#39;</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">&lt;&lt;packages</span>(<span style="color:#ba2121">&#34;browsers&#34;</span>)<span style="color:#19177c">&gt;&gt;</span>))
</span></span></code></pre></div><p>Music</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">specifications-&gt;manifest</span>
</span></span><span style="display:flex;"><span> <span style="color:#666">&#39;</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">&lt;&lt;packages</span>(<span style="color:#ba2121">&#34;music&#34;</span>)<span style="color:#19177c">&gt;&gt;</span>))
</span></span></code></pre></div><p>Office</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">specifications-&gt;manifest</span>
</span></span><span style="display:flex;"><span> <span style="color:#666">&#39;</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">&lt;&lt;packages</span>(<span style="color:#ba2121">&#34;office&#34;</span>)<span style="color:#19177c">&gt;&gt;</span>))
</span></span></code></pre></div><p>LaTeX</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">specifications-&gt;manifest</span>
</span></span><span style="display:flex;"><span> <span style="color:#666">&#39;</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">&lt;&lt;packages</span>(<span style="color:#ba2121">&#34;latex&#34;</span>)<span style="color:#19177c">&gt;&gt;</span>))
</span></span></code></pre></div><p>Desktop Misc</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">specifications-&gt;manifest</span>
</span></span><span style="display:flex;"><span> <span style="color:#666">&#39;</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">&lt;&lt;packages</span>(<span style="color:#ba2121">&#34;desktop-misc&#34;</span>)<span style="color:#19177c">&gt;&gt;</span>))
</span></span></code></pre></div><p>Desktop polybar</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">specifications-&gt;manifest</span>
</span></span><span style="display:flex;"><span> <span style="color:#666">&#39;</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">&lt;&lt;packages</span>(<span style="color:#ba2121">&#34;desktop-polybar&#34;</span>)<span style="color:#19177c">&gt;&gt;</span>))
</span></span></code></pre></div><p>Desktop rofi</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">specifications-&gt;manifest</span>
</span></span><span style="display:flex;"><span> <span style="color:#666">&#39;</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">&lt;&lt;packages</span>(<span style="color:#ba2121">&#34;desktop-rofi&#34;</span>)<span style="color:#19177c">&gt;&gt;</span>))
</span></span></code></pre></div><h3 id="flatpak">Flatpak</h3>
<p>A lot of proprietary desktop applications can be installed most easily with flatpak &amp; flathub.</p>
<table>
<thead>
<tr>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>flatpak</td>
</tr>
<tr>
<td>xdg-desktop-portal</td>
</tr>
</tbody>
</table>
<p>After installation, add the following repositories:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>flatpak remote-add --user --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
</span></span><span style="display:flex;"><span>flatpak remote-add --user --if-not-exists flathub-beta https://flathub.org/beta-repo/flathub-beta.flatpakrepo
</span></span></code></pre></div><p>Installation syntax is as follows:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>flatpak install --user &lt;remote&gt; &lt;package&gt;
</span></span></code></pre></div><p>Packages to install:</p>
<p><a id="table--flatpak-deps"></a></p>
<table>
<thead>
<tr>
<th>Flatpak dependency</th>
<th>Channel</th>
</tr>
</thead>
<tbody>
<tr>
<td>com.github.wwmm.pulseeffects</td>
<td>flathub</td>
</tr>
<tr>
<td>com.discordapp.Discord</td>
<td>flathub</td>
</tr>
<tr>
<td>us.zoom.Zoom</td>
<td>flathub</td>
</tr>
<tr>
<td>com.slack.Slack</td>
<td>flathub</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#00f">mapconcat</span>
</span></span><span style="display:flex;"><span> (<span style="color:#008000">lambda</span> (<span style="color:#19177c">c</span>) (<span style="color:#00f">concat</span> <span style="color:#ba2121">&#34;flatpak install -y --user &#34;</span> (<span style="color:#00f">nth</span> <span style="color:#666">1</span> <span style="color:#19177c">c</span>) <span style="color:#ba2121">&#34; &#34;</span> (<span style="color:#00f">nth</span> <span style="color:#666">0</span> <span style="color:#19177c">c</span>)))
</span></span><span style="display:flex;"><span> <span style="color:#19177c">table</span>
</span></span><span style="display:flex;"><span> <span style="color:#ba2121">&#34;\n&#34;</span>)
</span></span></code></pre></div><h3 id="nix">Nix</h3>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>TODO</td>
<td>Make nix manifest?</td>
</tr>
</tbody>
</table>
<p>I probably should&rsquo;ve used nix, as almost every program I packaged so far exists in the Nix repo.</p>
<p>But it&rsquo;s easy enough to use Nix on Guix.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cfg" data-lang="cfg"><span style="display:flex;"><span><span style="color:#7d9029">https://nixos.org/channels/nixpkgs-unstable nixpkgs</span>
</span></span></code></pre></div><p>Don&rsquo;t forget to run the following after the first installation:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>nix-channel --update
</span></span></code></pre></div><p>Installing packages:</p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">nix-env -i vk-messenger slack
</code></pre><h2 id="services-1">Services</h2>
<p><a href="https://www.gnu.org/software/shepherd/manual/html_node/index.html">GNU Shepherd</a> is a service management system for GNU Guix.</p>
<p>I previously used supervisor, but shepherd also seems pretty capable.</p>
<h3 id="music">Music</h3>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>music</td>
<td>mpd</td>
</tr>
<tr>
<td>music</td>
<td>ncmpcpp</td>
</tr>
<tr>
<td>music</td>
<td>picard</td>
</tr>
<tr>
<td>music</td>
<td>mpd-watcher</td>
</tr>
<tr>
<td>music</td>
<td>mpd-mpc</td>
</tr>
<tr>
<td>music</td>
<td>shntool</td>
</tr>
<tr>
<td>music</td>
<td>cuetools</td>
</tr>
<tr>
<td>music</td>
<td>flac</td>
</tr>
</tbody>
</table>
<p>Music player daemon</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">mpd</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">mpd</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;mpd&#34;</span> <span style="color:#ba2121">&#34;--no-daemon&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><p>MPD watcher</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">mpd-watcher</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">mpd-watcher</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;mpd_watcher&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:requires</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">mpd</span>)))
</span></span></code></pre></div><h3 id="gnu-mcron">GNU Mcron</h3>
<p><a href="https://www.gnu.org/software/mcron/">GNU Mcron</a> is a replacement for cron, written in Scheme.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">mcron</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">mcron</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;mcron&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><h3 id="activitywatch">ActivityWatch</h3>
<p><a href="https://activitywatch.net/">ActivityWatch</a> is a FOSS time tracker. It tracks screen and application usage and has integrations with browsers, Emacs, etc.</p>
<table>
<thead>
<tr>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>activitywatch-bin</td>
</tr>
</tbody>
</table>
<p>aw-server</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">aw-server</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">aw-server</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;aw-server&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><p><code>aw-watcher-afk</code> has some problems with statup, so there is a wrapper script</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sleep <span style="color:#666">5</span>
</span></span><span style="display:flex;"><span>aw-watcher-afk
</span></span></code></pre></div><p>aw-watcher-afk</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">aw-watcher-afk</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">aw-watcher-afk</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:requires</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">aw-server</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;/home/pavel/bin/scripts/aw-watcher-afk-wrapper&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><p>aw-watcher-window</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">aw-watcher-window</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">aw-watcher-window</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:requires</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">aw-server</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;aw-watcher-window&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><h3 id="pulseeffects">PulseEffects</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">pulseeffects</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">pulseeffects</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;flatpak&#34;</span> <span style="color:#ba2121">&#34;run&#34;</span> <span style="color:#ba2121">&#34;com.github.wwmm.pulseeffects&#34;</span> <span style="color:#ba2121">&#34;--gapplication-service&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><h3 id="xsettingsd">xsettingsd</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">xsettingsd</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">xsettingsd</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;xsettingsd&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><h3 id="nm-applet">nm-applet</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">nm-applet</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">nm-applet</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;nm-applet&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><h3 id="discord-rich-presence">Discord rich presence</h3>
<p>References:</p>
<ul>
<li><a href="https://github.com/flathub/com.discordapp.Discord/wiki/Rich-Precense-(discord-rpc)">Rich Precense (discord rpc)</a></li>
</ul>
<!--listend-->
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">discord-rich-presence</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">discord-rich-presence</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:one-shot?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-system-constructor</span> <span style="color:#ba2121">&#34;ln -sf {app/com.discordapp.Discord,$XDG_RUNTIME_DIR}/discord-ipc-0&#34;</span>)))
</span></span></code></pre></div><h3 id="polkit-authentication-agent">Polkit Authentication agent</h3>
<p>Launch an authentication agent. Necessary for stuff like <code>pkexec</code>. I suspect I&rsquo;m not doing that the intended way, but it seems to work.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">polkit-gnome</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">polkit-gnome</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;/home/pavel/.guix-extra-profiles/desktop-misc/desktop-misc/libexec/polkit-gnome-authentication-agent-1&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><h3 id="xmodmap">Xmodmap</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">xmodmap</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">xmodmap</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:one-shot?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-system-constructor</span> <span style="color:#ba2121">&#34;xmodmap /home/pavel/.Xmodmap&#34;</span>)))
</span></span></code></pre></div><h3 id="vpn">VPN</h3>
<p>Run my <a href="/configs/guix/#vpn">OpenVPN setup</a>. Not lauching this automatially, as it requires an active connection.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">vpn</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">vpn</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;/home/pavel/bin/scripts/vpn-start&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><h3 id="davmail">Davmail</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">davmail</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">davmail</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;/home/pavel/bin/davmail&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><h3 id="sqrt-data">sqrt-data</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000;font-weight:bold">define </span><span style="color:#19177c">sqrt-data</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00f">make</span> <span style="color:#19177c">&lt;service&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:provides</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">sqrt-data</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:respawn?</span> <span style="color:#800">#t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:start</span> (<span style="color:#00f">make-forkexec-constructor</span> <span style="color:#666">&#39;</span>(<span style="color:#ba2121">&#34;sqrt_data&#34;</span> <span style="color:#ba2121">&#34;cron&#34;</span> <span style="color:#ba2121">&#34;run-client-cron&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#666">#</span><span style="color:#19177c">:stop</span> (<span style="color:#00f">make-kill-destructor</span>)))
</span></span></code></pre></div><h3 id="shepherd-config">Shepherd config</h3>
<p>Register services</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">register-services</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">mpd</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">mpd-watcher</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">mcron</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">aw-server</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">aw-watcher-afk</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">aw-watcher-window</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">pulseeffects</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">xsettingsd</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">discord-rich-presence</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">polkit-gnome</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">vpn</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">davmail</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">xmodmap</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">nm-applet</span>
</span></span><span style="display:flex;"><span> <span style="color:#19177c">sqrt-data</span>)
</span></span></code></pre></div><p>Daemonize shepherd</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">action</span> <span style="color:#19177c">&#39;shepherd</span> <span style="color:#19177c">&#39;daemonize</span>)
</span></span></code></pre></div><p>Run services</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#008000">for-each </span><span style="color:#19177c">start</span> <span style="color:#666">&#39;</span>(<span style="color:#19177c">mpd</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">mpd-watcher</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">mcron</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">aw-server</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">aw-watcher-afk</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">aw-watcher-window</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">pulseeffects</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">xsettingsd</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">discord-rich-presence</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">polkit-gnome</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">davmail</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">xmodmap</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">nm-applet</span>
</span></span><span style="display:flex;"><span>		  <span style="color:#19177c">sqrt-data</span>))
</span></span></code></pre></div><h3 id="sync">Sync</h3>
<table>
<thead>
<tr>
<th>Guix dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>megacmd-1.4</td>
</tr>
</tbody>
</table>
<h2 id="guix-settings">Guix settings</h2>
<p>Other desktop programs I use are listed below.</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Guix dependency</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>desktop-misc</td>
<td>xprop</td>
<td>Tool to display properties of X windows</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>arandr</td>
<td>GUI to xrandr</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>light</td>
<td>Control screen brightness</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>ponymix</td>
<td>Control PulseAudio CLI</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>pavucontrol</td>
<td>Control PulseAudio GUI</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>network-manager-applet</td>
<td>Applet to manage network connections</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>xmodmap</td>
<td>Program to modify keybindings on X server</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>fontconfig</td>
<td></td>
</tr>
<tr>
<td>desktop-misc</td>
<td>polkit-gnome</td>
<td>Polkit authentication agent</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>feh</td>
<td>Image viewer. Used to set background</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>copyq</td>
<td>Clipboard manager</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>thunar</td>
<td>My preferred GUI file manager</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>xdg-utils</td>
<td>gives xdg-open and stuff</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>gnome-font-viewer</td>
<td>view fonts</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>qbittorrent</td>
<td>torrent client</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>anydesk</td>
<td>Remote desktop software</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>gnome-disk-utility</td>
<td>Manage disks</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>gparted</td>
<td>Manage partitions</td>
</tr>
<tr>
<td>desktop-misc</td>
<td>xev</td>
<td>Test input</td>
</tr>
</tbody>
</table>
<p><a id="code-snippet--packages"></a></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#19177c">my/format-guix-dependencies</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#00f">specifications-&gt;manifest</span>
</span></span><span style="display:flex;"><span> <span style="color:#666">&#39;</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#19177c">&lt;&lt;packages</span>()<span style="color:#19177c">&gt;&gt;</span>))
</span></span></code></pre></div>
    </div>
    <div class="table-of-contents">
        <div class="table-of-contents-text">
            <b><a href="#">Table of Contents</a></b>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#global-customization">Global customization</a>
      <ul>
        <li><a href="#colors">Colors</a></li>
        <li><a href="#xresources">Xresources</a>
          <ul>
            <li><a href="#colors-in-xresources">Colors in Xresources</a></li>
            <li><a href="#fonts">Fonts</a></li>
          </ul>
        </li>
        <li><a href="#themes">Themes</a></li>
        <li><a href="#mime">MIME</a></li>
        <li><a href="#device-specific-settings">Device-specific settings</a></li>
      </ul>
    </li>
    <li><a href="#exwm">EXWM</a>
      <ul>
        <li><a href="#startup-and-ui">Startup &amp; UI</a>
          <ul>
            <li><a href="#xsession">Xsession</a></li>
            <li><a href="#startup-apps">Startup apps</a></li>
            <li><a href="#pinentry">Pinentry</a></li>
            <li><a href="#modeline">Modeline</a></li>
          </ul>
        </li>
        <li><a href="#windows">Windows</a>
          <ul>
            <li><a href="#moving-windows">Moving windows</a></li>
            <li><a href="#resizing-windows">Resizing windows</a></li>
            <li><a href="#improving-splitting-windows">Improving splitting windows</a></li>
          </ul>
        </li>
        <li><a href="#perspectives">Perspectives</a></li>
        <li><a href="#workspaces-and-multi-monitor-setup">Workspaces and multi-monitor setup</a>
          <ul>
            <li><a href="#tracking-recently-used-workspaces">Tracking recently used workspaces</a></li>
            <li><a href="#the-monitor-list">The monitor list</a></li>
            <li><a href="#switch-to-another-monitor">Switch to another monitor</a></li>
            <li><a href="#move-the-workspace-to-another-monitor">Move the workspace to another monitor</a></li>
            <li><a href="#windmove-between-monitors">Windmove between monitors</a></li>
          </ul>
        </li>
        <li><a href="#completions">Completions</a>
          <ul>
            <li><a href="#ivy-posframe">ivy-posframe</a></li>
            <li><a href="#linux-app">Linux app</a></li>
            <li><a href="#password-store-ivy">password-store-ivy</a></li>
            <li><a href="#emojis">emojis</a></li>
          </ul>
        </li>
        <li><a href="#keybindings">Keybindings</a>
          <ul>
            <li><a href="#exwm-keybindings">EXWM keybindings</a></li>
            <li><a href="#app-shortcuts">App shortcuts</a></li>
            <li><a href="#locking-up">Locking up</a></li>
          </ul>
        </li>
        <li><a href="#fixes">Fixes</a>
          <ul>
            <li><a href="#catch-and-report-all-errors-raised-when-invoking-command-hooks">Catch and report all errors raised when invoking command hooks</a></li>
            <li><a href="#improve-floating-windows-behavior">Improve floating windows behavior</a></li>
          </ul>
        </li>
        <li><a href="#exwm-config">EXWM config</a></li>
      </ul>
    </li>
    <li><a href="#i3wm">i3wm</a>
      <ul>
        <li><a href="#general-settings">General settings</a></li>
        <li><a href="#managing-windows">Managing windows</a></li>
        <li><a href="#workspaces">Workspaces</a></li>
        <li><a href="#rules">Rules</a></li>
        <li><a href="#scratchpad">Scratchpad</a>
          <ul>
            <li><a href="#launch-script">Launch script</a></li>
            <li><a href="#i3-config">i3 config</a></li>
          </ul>
        </li>
        <li><a href="#gaps-and-borders">Gaps &amp; borders</a>
          <ul>
            <li><a href="#keybindings-1">Keybindings</a></li>
          </ul>
        </li>
        <li><a href="#move-and-resize-windows">Move &amp; resize windows</a></li>
        <li><a href="#off--intergration-with-dmenu"><span class="org-todo done OFF">OFF</span> (OFF) Intergration with dmenu</a></li>
        <li><a href="#integration-with-rofi">Integration with rofi</a></li>
        <li><a href="#launching-apps-and-misc-keybindings">Launching apps &amp; misc keybindings</a>
          <ul>
            <li><a href="#apps">Apps</a></li>
            <li><a href="#media-controls-and-brightness">Media controls &amp; brightness</a></li>
            <li><a href="#screenshots">Screenshots</a></li>
          </ul>
        </li>
        <li><a href="#colors-1">Colors</a></li>
        <li><a href="#off--i3blocks"><span class="org-todo done OFF">OFF</span> (OFF) i3blocks</a></li>
        <li><a href="#keyboard-layout">Keyboard Layout</a></li>
        <li><a href="#autostart">Autostart</a></li>
      </ul>
    </li>
    <li><a href="#polybar">Polybar</a>
      <ul>
        <li><a href="#general-settings-1">General settings</a>
          <ul>
            <li><a href="#colors-2">Colors</a></li>
            <li><a href="#glyph-settings">Glyph settings</a></li>
            <li><a href="#defining-modules">Defining modules</a></li>
            <li><a href="#generating-glyphs">Generating glyphs</a></li>
            <li><a href="#generating-set-of-modules">Generating set of modules</a></li>
            <li><a href="#global-bar-config">Global bar config</a></li>
            <li><a href="#launch-script-1">Launch script</a></li>
          </ul>
        </li>
        <li><a href="#individual-modules">Individual modules</a>
          <ul>
            <li><a href="#pulseaudio">pulseaudio</a></li>
            <li><a href="#mpd">mpd</a></li>
            <li><a href="#cpu">cpu</a></li>
            <li><a href="#ram-memory">ram-memory</a></li>
            <li><a href="#swap-memory">swap-memory</a></li>
            <li><a href="#network">network</a></li>
            <li><a href="#bandwidth">bandwidth</a></li>
            <li><a href="#ipstack-vpn">ipstack-vpn</a></li>
            <li><a href="#openvpn">openvpn</a></li>
            <li><a href="#xkeyboard">xkeyboard</a></li>
            <li><a href="#battery">battery</a></li>
            <li><a href="#weather">weather</a></li>
            <li><a href="#sun">sun</a></li>
            <li><a href="#aw-afk">aw-afk</a></li>
            <li><a href="#date">date</a></li>
            <li><a href="#pomm">pomm</a></li>
            <li><a href="#sep">SEP</a></li>
            <li><a href="#tsep">TSEP</a></li>
            <li><a href="#i3">i3</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#rofi-1">Rofi</a>
      <ul>
        <li><a href="#theme">Theme</a></li>
        <li><a href="#scripts">Scripts</a>
          <ul>
            <li><a href="#buku-bookmarks">Buku bookmarks</a></li>
            <li><a href="#man-pages">Man pages</a></li>
            <li><a href="#emojis-1">Emojis</a></li>
            <li><a href="#pass">pass</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#flameshot">Flameshot</a></li>
    <li><a href="#dunst">dunst</a></li>
    <li><a href="#keynav">keynav</a>
      <ul>
        <li><a href="#config">Config</a></li>
        <li><a href="#using-with-picom">Using with picom</a></li>
      </ul>
    </li>
    <li><a href="#picom">Picom</a>
      <ul>
        <li><a href="#shadows">Shadows</a></li>
        <li><a href="#fading">Fading</a></li>
        <li><a href="#opacity">Opacity</a></li>
        <li><a href="#general-settings-2">General settings</a></li>
      </ul>
    </li>
    <li><a href="#zathura">Zathura</a></li>
    <li><a href="#various-software">Various software</a>
      <ul>
        <li><a href="#browsers">Browsers</a></li>
        <li><a href="#office-and-multimedia">Office &amp; Multimedia</a></li>
        <li><a href="#latex">LaTeX</a></li>
        <li><a href="#dev">Dev</a></li>
        <li><a href="#manifests">Manifests</a></li>
        <li><a href="#flatpak">Flatpak</a></li>
        <li><a href="#nix">Nix</a></li>
      </ul>
    </li>
    <li><a href="#services-1">Services</a>
      <ul>
        <li><a href="#music">Music</a></li>
        <li><a href="#gnu-mcron">GNU Mcron</a></li>
        <li><a href="#activitywatch">ActivityWatch</a></li>
        <li><a href="#pulseeffects">PulseEffects</a></li>
        <li><a href="#xsettingsd">xsettingsd</a></li>
        <li><a href="#nm-applet">nm-applet</a></li>
        <li><a href="#discord-rich-presence">Discord rich presence</a></li>
        <li><a href="#polkit-authentication-agent">Polkit Authentication agent</a></li>
        <li><a href="#xmodmap">Xmodmap</a></li>
        <li><a href="#vpn">VPN</a></li>
        <li><a href="#davmail">Davmail</a></li>
        <li><a href="#sqrt-data">sqrt-data</a></li>
        <li><a href="#shepherd-config">Shepherd config</a></li>
        <li><a href="#sync">Sync</a></li>
      </ul>
    </li>
    <li><a href="#guix-settings">Guix settings</a></li>
  </ul>
</nav>
        </div>
        <a id="unhide-all-button" class="hidden">&lt;Expand&gt;</a>
        <a id="hide-all-button" class="hidden">&lt;Collapse&gt;</a>
    </div>
</div>

        </div><div id="footer" class="mb-5">
    <hr>
    <div class="container text-center">
        
    </div>
    
    <div class="container text-center">
        <a href="https://sqrtminusone.xyz/" title="Pavel Korytov, 2022"><small>Pavel Korytov, 2022</small></a>
        
        <br>
        <a href="https://creativecommons.org/licenses/by/4.0/legalcode" title="Licensed under CC-BY 4.0"><small>Licensed under CC-BY 4.0</small></a>
        
    </div>
    
</div>
</body>
</html>
